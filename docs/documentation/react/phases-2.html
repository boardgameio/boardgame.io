<!DOCTYPE html>
<html>

<head>
<style>
body {
  padding: 20px;
}
.msg {
  position: absolute;
  bottom: 0;
  left: 20px;
  color: #aaa;
  font-size: 12px;
  margin-bottom: 20px;
}
.phases li {
  list-style: none;
  width: 200px;
  border: 1px solid #eee;
  border-top: none;
  padding: 5px;
  height: 30px;
  line-height: 30px;
  text-align: center;
}
</style>
</head>

<body>
  <div id="app"></div>

  <script type="text/babel">
function drawCard(G) {
  G.deck--;
  G.hand++;
}

function playCard(G) {
  G.deck++;
  G.hand--;
}

const game = {
  setup: () => ({ deck: 5, hand: 0 }),

  phases: {
    draw: {
      moves: { drawCard },
      endIf: G => (G.deck <= 0),
      start: true,
      next: 'play',
    },
    play: {
      moves: { playCard },
      endIf: G => (G.hand <= 0),
      next: 'draw',
    }
  },
};

class Board extends React.Component {
  drawCard = () => {
    if (this.props.ctx.phase != 'draw') return;
    this.props.moves.drawCard();
    this.props.events.endTurn();
  }

  playCard = () => {
    if (this.props.ctx.phase != 'play') return;
    this.props.moves.playCard();
    this.props.events.endTurn();
  }

  render() {
    return (
      <div className="phases">
        <li style={{ border: '2px solid #aaa' }}>{ this.props.ctx.phase } phase</li>
        <li>Deck: { this.props.G.deck }</li>
        <li>Hand: { this.props.G.hand }</li>
        <li><button id="draw" onClick={this.drawCard}>Draw Card</button></li>
        <li><button id="play" onClick={this.playCard}>Play Card</button></li>
      </div>
    );
  }
}

const Phases = BoardgameIO.ReactClient({
  game,
  numPlayers: 1,
  board: Board,
  debug: false,
});

ReactDOM.render(<Phases/>, document.getElementById('app'));
  </script>

  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="//unpkg.com/react@next/umd/react.development.js"></script>
  <script src="//unpkg.com/react-dom@next/umd/react-dom.development.js"></script>
  <script src="boardgameio.min.js"></script>
</body>

</html>
