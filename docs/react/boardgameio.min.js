!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.BoardgameIO=t(e.React)}(this,function(e){"use strict";function t(e,t){if("undefined"==typeof document)return t;e=e||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t}function n(e){if("object"!==(void 0===e?"undefined":He(e))||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function r(e,t,o){function i(){f===h&&(f=h.slice())}function a(){if(d)throw Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return p}function s(e){if("function"!=typeof e)throw Error("Expected the listener to be a function.");if(d)throw Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return i(),f.push(e),function(){if(t){if(d)throw Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,i();var n=f.indexOf(e);f.splice(n,1)}}}function c(e){if(!n(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw Error("Reducers may not dispatch actions.");try{d=!0,p=l(p,e)}finally{d=!1}for(var t=h=f,r=0;t.length>r;r++)(0,t[r])();return e}var u;if("function"==typeof t&&void 0===o&&(o=t,t=void 0),void 0!==o){if("function"!=typeof o)throw Error("Expected the enhancer to be a function.");return o(r)(e,t)}if("function"!=typeof e)throw Error("Expected the reducer to be a function.");var l=e,p=t,h=[],f=h,d=!1;return c({type:Ge.INIT}),u={dispatch:c,subscribe:s,getState:a,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");l=e,c({type:Ge.REPLACE})}},u[Ue]=function(){var e,t=s;return e={subscribe:function(e){function n(){e.next&&e.next(a())}if("object"!==(void 0===e?"undefined":He(e))||null===e)throw new TypeError("Expected the observer to be an object.");return n(),{unsubscribe:t(n)}}},e[Ue]=function(){return this},e},u}function o(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function i(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var a=e.apply(void 0,r),s=function(){throw Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},c={getState:a.getState,dispatch:function(){return s.apply(void 0,arguments)}},u=t.map(function(e){return e(c)});return s=o.apply(void 0,u)(a.dispatch),Xe({},a,{dispatch:s})}}}function a(e,t){return t={exports:{}},e(t,t.exports),t.exports}function s(e){if(100>=(e+="").length){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*vt;case"days":case"day":case"d":return n*yt;case"hours":case"hour":case"hrs":case"hr":case"h":return n*dt;case"minutes":case"minute":case"mins":case"min":case"m":return n*ft;case"seconds":case"second":case"secs":case"sec":case"s":return n*ht;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function c(e){return yt>e?dt>e?ft>e?ht>e?e+"ms":Math.round(e/ht)+"s":Math.round(e/ft)+"m":Math.round(e/dt)+"h":Math.round(e/yt)+"d"}function u(e){return l(e,yt,"day")||l(e,dt,"hour")||l(e,ft,"minute")||l(e,ht,"second")||e+" ms"}function l(e,t,n){if(e>=t)return 1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}function p(e,t){if(!e)return e;if(It(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Et(e)){for(var r=Array(e.length),o=0;e.length>o;o++)r[o]=p(e[o],t);return r}if("object"==typeof e&&!(e instanceof Date)){r={};for(var i in e)r[i]=p(e[i],t);return r}return e}function h(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Et(e))for(var n=0;e.length>n;n++)e[n]=h(e[n],t);else if("object"==typeof e)for(var r in e)e[r]=h(e[r],t);return e}function f(e){if(!e||"object"!=typeof e)return!1;if(Lt(e)){for(var t=0,n=e.length;n>t;t++)if(f(e[t]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||Ut&&e instanceof Blob||Gt&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return f(e.toJSON(),!0);for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&f(e[r]))return!0;return!1}function d(){}function y(e){for(var t=0;e.length>t;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function v(e,t){t=t||{};var n=new Jt;y(e);for(var r=0;e.length>r;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}function g(e,t){return y(e),new Blob(e,t||{})}function m(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}function b(e){var t="";do{t=an[e%sn]+t,e=Math.floor(e/sn)}while(e>0);return t}function C(){var e=b(+new Date);return e!==nn?(un=0,nn=e):e+"."+b(un++)}function w(e){var t=e&&e.forceBase64;vn&&!t||(this.supportsBinary=!1),tn.call(this,e)}function k(){}function x(e){if(yn.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,ct.location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!==ct.location.hostname||n!==e.port,this.xs=e.secure!==t}}function D(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function O(){for(var e in D.requests)D.requests.hasOwnProperty(e)&&D.requests[e].abort()}function E(){}function I(e){yn.call(this,e),this.query=this.query||{},Cn||(ct.___eio||(ct.___eio=[]),Cn=ct.___eio),this.index=Cn.length;var t=this;Cn.push(function(e){t.onData(e)}),this.query.j=this.index,ct.document&&ct.addEventListener&&ct.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=E)},!1)}function P(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=An&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(_n=Dn),tn.call(this,e)}function A(e,t){if(!(this instanceof A))return new A(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=pt(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=pt(t.host).host),this.secure=null!=t.secure?t.secure:ct.location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(ct.location?location.hostname:"localhost"),this.port=t.port||(ct.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=rn.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode;var n="object"==typeof ct&&ct;n.global===n&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function _(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function M(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&1>=e.jitter?e.jitter:0,this.attempts=0}function S(e,t){if(!(this instanceof S))return new S(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Hn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||jt;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}function F(e,t,n,r,o,i){n&&(Array.isArray(o)?T(e,t,n,r,o,i):j(e,t,n,r,o,i))}function T(e,t,n,r,o,i){for(var a=Math.min(o.length,i.length),s=0;a>s;s++)if(e.assigned[s]&&o[s]!==i[s]){var c=t.concat(s);n.push({op:"replace",path:c,value:i[s]}),r.push({op:"replace",path:c,value:o[s]})}if(i.length>a){for(var u=a;i.length>u;u++){var l=t.concat(u);n.push({op:"add",path:l,value:i[u]})}r.push({op:"replace",path:t.concat("length"),value:o.length})}else if(o.length>a){n.push({op:"replace",path:t.concat("length"),value:i.length});for(var p=a;o.length>p;p++){var h=t.concat(p);r.push({op:"add",path:h,value:o[p]})}}}function j(e,t,n,r,o,i){z(e.assigned,function(e,a){var s=o[e],c=i[e],u=a?e in o?"replace":"add":"remove";if(s!==o||"replace"!==u){var l=t.concat(e);n.push("remove"===u?{op:u,path:l}:{op:u,path:l,value:c}),r.push("add"===u?{op:"remove",path:l}:"remove"===u?{op:"add",path:l,value:s}:{op:"replace",path:l,value:s})}})}function R(){return pr}function N(e){return!!e&&!!e[cr]}function B(e){if(!e)return!1;if("object"!==(void 0===e?"undefined":ar(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function q(e){return lr&&Object.freeze(e),e}function L(e){if(Array.isArray(e))return e.slice();var t=void 0===e.__proto__?Object.create(null):{};return hr(t,e)}function z(e,t){if(Array.isArray(e))for(var n=0;e.length>n;n++)t(n,e[n]);else for(var r in e)t(r,e[r])}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function G(e,t,n,r){if(N(e)){var o=e[cr];if(!0===o.modified){if(!0===o.finalized)return o.copy;o.finalized=!0;var i=H(pr?o.copy:o.copy=L(e),o,t,n,r);return F(o,t,n,r,o.base,i),i}return o.base}return X(e),e}function H(e,t,n,r,o){var i=t.base;return z(e,function(a,s){if(s!==i[a]){var c=r&&!U(t.assigned,a);e[a]=G(s,c&&n.concat(a),c&&r,o)}}),q(e)}function X(e){B(e)&&(Object.isFrozen(e)||z(e,function(t,n){N(n)?e[t]=G(n):X(n)}))}function Y(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function W(e,t){return{modified:!1,assigned:{},finalized:!1,parent:e,base:t,copy:void 0,proxies:{}}}function K(e){return!0===e.modified?e.copy:e.base}function J(e){e.modified||(e.modified=!0,e.copy=L(e.base),Object.assign(e.copy,e.proxies),e.parent&&J(e.parent))}function V(e,t){if(N(t))throw Error("Immer bug. Plz report.");var n=W(e,t),r=Array.isArray(t)?Proxy.revocable([n],yr):Proxy.revocable(n,dr);return fr.push(r),r.proxy}function $(e,t,n){if(N(e)){var r=t.call(e,e);return void 0===r?e:r}var o=fr;fr=[];var i=n&&[],a=n&&[];try{var s=V(void 0,e),c=t.call(s,s),u=void 0;if(void 0!==c&&c!==s){if(s[cr].modified)throw Error(ur);u=G(c),i&&(i.push({op:"replace",path:[],value:u}),a.push({op:"replace",path:[],value:e}))}else u=G(s,[],i,a);return z(fr,function(e,t){return t.revoke()}),n&&n(i,a),u}finally{fr=o}}function Z(e,t,n){return{modified:!1,assigned:{},hasCopy:!1,parent:e,base:n,proxy:t,copy:void 0,finished:!1,finalizing:!1,finalized:!1}}function Q(e){return e.hasCopy?e.copy:e.base}function ee(e,t){ae(e);var n=Q(e)[t];return!e.finalizing&&n===e.base[t]&&B(n)?(re(e),e.copy[t]=oe(e,n)):n}function te(e,t,n){if(ae(e),e.assigned[t]=!0,!e.modified){if(Y(Q(e)[t],n))return;ne(e),re(e)}e.copy[t]=n}function ne(e){e.modified||(e.modified=!0,e.parent&&ne(e.parent))}function re(e){e.hasCopy||(e.hasCopy=!0,e.copy=L(e.base))}function oe(e,t){var n=L(t);z(t,function(e){Object.defineProperty(n,""+e,ie(""+e))});var r=Z(e,n,t);return fe(n,cr,r),gr.push(r),n}function ie(e){return vr[e]||(vr[e]={configurable:!0,enumerable:!0,get:function(){return ee(this[cr],e)},set:function(t){te(this[cr],e,t)}})}function ae(e){if(!0===e.finished)throw Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(e.copy||e.base))}function se(){for(var e=gr.length-1;e>=0;e--){var t=gr[e];!1===t.modified&&(Array.isArray(t.base)?pe(t)&&ne(t):le(t)&&ne(t))}}function ce(e){if(e&&"object"===(void 0===e?"undefined":ar(e))){var t=e[cr];if(t){var n=t.proxy,r=t.base;if(Array.isArray(e)){if(pe(t)){if(ne(t),t.assigned.length=!0,r.length>n.length)for(var o=n.length;r.length>o;o++)t.assigned[o]=!1;else for(var i=r.length;n.length>i;i++)t.assigned[i]=!0;z(n,function(e,n){t.assigned[e]||ce(n)})}}else{var a=ue(r,n),s=a.added,c=a.removed;(s.length>0||c.length>0)&&ne(t),z(s,function(e,n){t.assigned[n]=!0}),z(c,function(e,n){t.assigned[n]=!1}),z(n,function(e,n){t.assigned[e]||ce(n)})}}}}function ue(e,t){var n=Object.keys(e),r=Object.keys(t);return{added:r.filter(function(e){return-1===n.indexOf(e)}),removed:n.filter(function(e){return-1===r.indexOf(e)})}}function le(e){for(var t=e.base,n=e.proxy,r=Object.keys(n),o=r.length;0!==o;){var i=r[--o];if(void 0===t[i]&&!U(t,i))return!0}return r.length!==Object.keys(t).length}function pe(e){var t=e.proxy;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}function he(e,t,n){if(N(e)){var r=t.call(e,e);return void 0===r?e:r}var o=gr;gr=[];var i=n&&[],a=n&&[];try{var s=oe(void 0,e),c=t.call(s,s);z(gr,function(e,t){t.finalizing=!0});var u=void 0;if(void 0!==c&&c!==s){if(s[cr].modified)throw Error(ur);u=G(c),i&&(i.push({op:"replace",path:[],value:u}),a.push({op:"replace",path:[],value:e}))}else n&&ce(s),se(),u=G(s,[],i,a);return z(gr,function(e,t){t.finished=!0}),n&&n(i,a),u}finally{gr=o}}function fe(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0})}function de(e,t,n){if(1>arguments.length||arguments.length>3)throw Error("produce expects 1 to 3 arguments, got "+arguments.length);if("function"==typeof e&&"function"!=typeof t){var r=t,o=e;return function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return de(arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,function(e){return o.call.apply(o,[e,e].concat(t))})}}if("function"!=typeof t)throw Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==n&&"function"!=typeof n)throw Error("the third argument of a producer should not be set or a function");if(!B(e)){var i=t(e);return void 0===i?e:ye(i)}return ye(R()?$(e,t,n):he(e,t,n))}function ye(e){return e===sr?void 0:e}function ve(e){var t=this,n=me();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),0>t.s0&&(t.s0+=1),t.s1-=n(e),0>t.s1&&(t.s1+=1),t.s2-=n(e),0>t.s2&&(t.s2+=1),n=null}function ge(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function me(){var e=4022871197;return function(t){t=""+t;for(var n=0;t.length>n;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}function be(e,t){var n=new ve(e),r=t&&t.state,o=n.next;return o.quick=o,r&&("object"==(void 0===r?"undefined":Jn(r))&&ge(r,n),o.state=function(){return ge(n,{})}),o}function Ce(e){var t=e.game,n=e.numPlayers,r=e.multiplayer;n||(n=2);var o=t.flow.ctx(n),i=t.seed;void 0===i&&(i=wr.seed()),o._random={seed:i};var a=new Dr(o,t,o.currentPlayer),s=a.attachToContext(o),c={G:t.setup(s),ctx:o,_undo:[],_redo:[],_stateID:0,_initial:{}},u=t.flow.init({G:c.G,ctx:s});c.G=u.G,c._undo=u._undo,u=a.updateAndDetach(u,!0),c.ctx=u.ctx;return c._initial=function(e){return br(Cr(e))}(c),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,n=arguments[1];switch(n.type){case We:if(e=Qn({},e,{deltalog:[]}),r)return e;if(null!==n.payload.playerID&&void 0!==n.payload.playerID&&!t.flow.canPlayerCallEvent(e.G,e.ctx,n.payload.playerID))return e;var o=new Dr(e.ctx,t,n.payload.playerID);e.ctx=o.attachToContext(e.ctx);var i=t.flow.processGameEvent(e,n);return i=o.updateAndDetach(i,!0),Qn({},i,{_stateID:e._stateID+1});case Ye:if(e=Qn({},e,{deltalog:[]}),!t.moveNames.includes(n.payload.type))return e;if(!t.flow.canMakeMove(e.G,e.ctx,n.payload.type))return e;if(null!==n.payload.playerID&&void 0!==n.payload.playerID&&!t.flow.canPlayerMakeMove(e.G,e.ctx,n.payload.playerID))return e;var a=new Dr(e.ctx,t,n.payload.playerID),s=a.attachToContext(e.ctx),u=t.processMove(e.G,n.payload,s);if(void 0===u)return e;var l=a.updateAndDetach(Qn({},e,{deltalog:[{action:n,_stateID:e._stateID}]}),!1),p=l.ctx;return r&&!t.flow.optimisticUpdate(u,p,n.payload)&&(u=e.G),e=Qn({},l,{G:u,ctx:p,_stateID:e._stateID+1}),r?e:(s=a.attachToContext(e.ctx),e=t.flow.processMove(Qn({},e,{ctx:s}),n.payload),e=a.updateAndDetach(e,!0));case Ze:case Ve:return n.state;case Je:return c;case $e:var h=e,f=h._undo,d=h._redo;if(2>f.length)return e;var y=f[f.length-1],v=f[f.length-2];return t.flow.canUndoMove(e.G,e.ctx,y.moveType)?Qn({},e,{G:v.G,ctx:v.ctx,_undo:f.slice(0,f.length-1),_redo:[y].concat(rr(d))}):e;case Ke:var g=e,m=g._undo,b=g._redo;if(0==b.length)return e;var C=b[0];return Qn({},e,{G:C.G,ctx:C.ctx,_undo:[].concat(rr(m),[C]),_redo:b.slice(1)});default:return e}}}function we(e){Or("ERROR: "+e)}function ke(e){var t={},n=function(e){var n=e.type,r=e.playerID,o=e.args,i=t[r];void 0!==i&&i.apply(null,[n].concat(rr(o)))},r=new Er(e,new ir,{send:n,sendAll:function(e){for(var r in t){var o=e(r);n({type:o.type,playerID:r,args:o.args})}}});return r.connect=function(e,n,r){t[n]=r},r}function xe(e,t,n,r,o,i){return t.reduce(function(t,a){return t[a]=function(){var t=r;i||null!==r&&void 0!==r||(t=n.getState().ctx.currentPlayer);for(var s=arguments.length,c=Array(s),u=0;s>u;u++)c[u]=arguments[u];n.dispatch(st[e](a,c,t,o))},t},{})}function De(e){var t=e.game,n=e.multiplayer;return n&&(1==n&&(n={server:""}),1==n.local&&(n.master_=ke(t))),Qn({},e,{multiplayer:n})}function Oe(e){return new _r(e)}function Ee(e){return function(){return e}}function Ie(e,t,n){var r={},o={};for(var i in e)o[i]=i;for(var a in t)o[a]=a;for(var s={},c=0;n.length>c;c++)s[n[c]]=!0;var u=s,l=!0;for(var p in o){var h=p[0];if(u[h]){l=!1;break}u[h]=!0,r[p]=h}if(l)return r;u=s;var f=97;r={};for(var d in o){for(var y=String.fromCharCode(f);u[y];)f++,y=String.fromCharCode(f);u[y]=!0,r[d]=y}return r}function Pe(e){var t={};for(var n in e)n.startsWith("_")||(t[n]=e[n]);return t}function Ae(e,t){return Qn({},e,{ctx:_e(e.ctx,t)})}function _e(e,t){var n=[];return t.value&&(n=t.value),t.all&&(n=[].concat(rr(e.playOrder))),t.others&&(n=[].concat(rr(e.playOrder)).filter(function(t){return t!==e.currentPlayer})),Array.isArray(t)&&(n=t),Qn({},e,{actionPlayers:n,_actionPlayersOnce:t.once,_actionPlayersOthers:t.others})}function Me(e,t){return e[t]+""}function Se(e,t,n){var r=[].concat(rr(Array(t.numPlayers))).map(function(e,t){return t+""});void 0!==n.playOrder&&(r=n.playOrder(e,t));var o=n.first(e,t),i=Me(r,o);return t=void 0!==n.actionPlayers?_e(t,n.actionPlayers):Qn({},t,{actionPlayers:[i]}),Qn({},t,{currentPlayer:i,playOrderPos:o,playOrder:r})}function Fe(e,t,n,r){var o=t.playOrderPos,i=t.currentPlayer,a=t.actionPlayers,s=!1;if(r&&!0!==r)t.playOrder.includes(r.next)?(o=t.playOrder.indexOf(r.next),a=[i=r.next]):we("invalid argument to endTurn: "+r);else{var c=n.next(e,t);void 0===c?s=!0:(o=c,i=Me(t.playOrder,o),void 0===n.actionPlayers&&(a=[i]))}return t=Qn({},t,{playOrderPos:o,currentPlayer:i,actionPlayers:a}),{endPhase:s,ctx:t}}function Te(e){var t=e.ctx,n=e.events,r=e.enabledEvents,o=e.init,i=e.processMove,a=e.optimisticUpdate,s=e.canMakeMove,c=e.canUndoMove;t||(t=function(){return{}}),n||(n={}),r||(r={}),o||(o=function(e){return e}),i||(i=function(e){return e}),s||(s=function(){return!0}),c||(c=function(){return!0}),void 0===a&&(a=function(){return!0});var u=function e(t,r){var o=r.payload;if(n.hasOwnProperty(o.type)){var i={playerID:o.playerID,dispatch:e},a={action:r,_stateID:t._stateID},s=[].concat(rr(t.deltalog||[]),[a]),c=[t=Qn({},t,{deltalog:s})].concat(o.args);return n[o.type].apply(i,c)}return t};return{ctx:t,init:o,canUndoMove:c,eventNames:Object.getOwnPropertyNames(n),enabledEventNames:Object.getOwnPropertyNames(r),processMove:function(e,t){return i(e,t,u)},processGameEvent:function(e,t){return u(e,t)},optimisticUpdate:a,canPlayerCallEvent:function(e,t,n){return t.currentPlayer==n&&t.actionPlayers.includes(n)},canPlayerMakeMove:function(e,t,n){return(t.actionPlayers||[]).includes(n)},canMakeMove:function(e,t,n){return void 0===t.gameover&&s(e,t,n)}}}function je(e){function t(e,t,n){var r=(e.ctx.stats[t].numMoves[n]||0)+1,o=Qn({},e.ctx.stats[t].numMoves,Zn({},n,r)),i=Qn({},e.ctx.stats[t],{numMoves:o});Object.keys(o).length==e.ctx.numPlayers&&(i.allPlayed=!0);var a=Qn({},e.ctx.stats,Zn({},t,i)),s=Qn({},e.ctx,{stats:a});return Qn({},e,{ctx:s})}var n=e.phases,r=e.startingPhase,o=e.movesPerTurn,i=e.endTurnIf,a=e.endGameIf,s=e.onTurnBegin,c=e.onTurnEnd,u=e.onMove,l=e.turnOrder,p=e.endTurn,h=e.endPhase,f=e.endGame,d=e.setActionPlayers,y=e.undoableMoves,v=e.allowedMoves,g=e.optimisticUpdate;void 0===h&&n&&(h=!0),void 0===p&&(p=!0),void 0===f&&(f=!1),void 0===d&&(d=!1),void 0===g&&(g=function(){return!0}),n||(n={}),r||(r="default"),i||(i=function(){return!1}),a||(a=function(){}),s||(s=function(e){return e}),c||(c=function(e){return e}),u||(u=function(e){return e}),l||(l=$r.DEFAULT),void 0===v&&(v=null),void 0===y&&(y=null);var m=n;"default"in m&&we('cannot specify phase with name "default"'),m.default={};for(var b in m){var C=m[b];void 0===C.endPhaseIf&&(C.endPhaseIf=function(){}),void 0===C.onPhaseBegin&&(C.onPhaseBegin=function(e){return e}),void 0===C.onPhaseEnd&&(C.onPhaseEnd=function(e){return e}),void 0===C.movesPerTurn&&(C.movesPerTurn=o),void 0===C.endTurnIf&&(C.endTurnIf=i),void 0===C.endGameIf&&(C.endGameIf=a),void 0===C.onTurnBegin&&(C.onTurnBegin=s),void 0===C.onTurnEnd&&(C.onTurnEnd=c),void 0===C.onMove&&(C.onMove=u),void 0===C.turnOrder&&(C.turnOrder=l),void 0===C.undoableMoves&&(C.undoableMoves=y),void 0===C.allowedMoves&&(C.allowedMoves=v),"function"!=typeof C.allowedMoves&&function(){var e=C.allowedMoves;C.allowedMoves=function(){return e}}()}var w=function(e){var t=e.G,n=e.ctx;return m[n.phase].endPhaseIf(t,n)},k=function(e){var t=e.G,n=e.ctx,r=m[n.phase],o=n.stats.turn.numMoves[n.currentPlayer]||0;return!(!r.movesPerTurn||r.movesPerTurn>o)||r.endTurnIf(t,n)},x=function(e,t){var n=t.onPhaseBegin(e.G,e.ctx),r=Se(e.G,e.ctx,t.turnOrder);r.stats=Qn({},r.stats,{phase:Qn({},r.stats.phase,{numMoves:{},allPlayed:!1})});var o=t.allowedMoves(n,r);return Qn({},e,{G:n,ctx:Qn({},r,{allowedMoves:o})})},D=function(e,t){var n=t.onTurnBegin(e.G,e.ctx),r=[{G:n,ctx:Dr.detachAllFromContext(e.ctx)}],o=Qn({},e.ctx);return o.allowedMoves=t.allowedMoves(n,o),o.stats=Qn({},o.stats,{turn:Qn({},o.stats.turn,{numMoves:{},allPlayed:!1})}),Qn({},e,{G:n,ctx:o,_undo:r,_redo:[]})},O=function(e){if(!(e.ctx.phase in m))return we("invalid startingPhase: "+e.ctx.phase),e;var t=m[e.ctx.phase];return e=x(e,t),e=D(e,t)},E={endTurn:function(e,t){var n=e,r=n.G,o=n.ctx,i=m[o.phase],a=o.stats.turn.numMoves[o.currentPlayer]||0;if(i.movesPerTurn&&i.movesPerTurn>a)return e;r=i.onTurnEnd(r,o);var s=i.endGameIf(r,o);if(void 0!==s)return Qn({},e,{G:r,ctx:Qn({},o,{gameover:s})});var c=!1,u=Fe(r,o,i.turnOrder,t);c=u.endPhase,o=Qn({},o=u.ctx,{turn:o.turn+1}),e=Qn({},e,{G:r,ctx:o});var l=w(e);return l&&(c=!0),c?this.dispatch(e,tt("endPhase",[l],this.playerID)):D(e,i)},endPhase:function(e,t,n){var r=e.G,o=e.ctx,i=m[o.phase];r=i.onPhaseEnd(r,o);var a=i.endGameIf(r,o);if(void 0!==a)return Qn({},e,{G:r,ctx:Qn({},o,{gameover:a})});var s=o.phase;t&&!0!==t?t.next in m?o=Qn({},o,{phase:t.next,prevPhase:s}):we("invalid argument to endPhase: "+t):o=void 0!==i.next?Qn({},o,{phase:i.next,prevPhase:s}):Qn({},o,{phase:o.prevPhase,prevPhase:s});var c=(e=x(Qn({},e,{G:r,ctx:o}),m[o.phase])).ctx.turn;if(n||(n={}),o.phase in n)e=this.dispatch(e,tt("endPhase",[{next:"default"},n],this.playerID));else{n[o.phase]=!0;var u=w(e);u&&(e=this.dispatch(e,tt("endPhase",[u,n],this.playerID)))}var l=k(e);return l&&e.ctx.turn==c&&(e=this.dispatch(e,tt("endTurn",[l],this.playerID))),e},endGame:function(e,t){return void 0===t&&(t=!0),Qn({},e,{ctx:Qn({},e.ctx,{gameover:t})})},setActionPlayers:Ae},I={};return p&&(I.endTurn=!0),h&&(I.endPhase=!0),f&&(I.endGame=!0),d&&(I.setActionPlayers=!0),Te({ctx:function(e){return{numPlayers:e,turn:0,currentPlayer:"0",actionPlayers:["0"],currentPlayerMoves:0,playOrder:[].concat(rr(Array(e))).map(function(e,t){return t+""}),playOrderPos:0,stats:{turn:{numMoves:{}},phase:{numMoves:{}}},allPlayed:!1,phase:r,prevPhase:"default"}},init:function(e){return O(e)},optimisticUpdate:function(e,t,n){return(void 0===t._random||void 0===t._random.prngstate)&&g(e,t,n)},events:E,enabledEvents:I,processMove:function(e,n,r){var o=m[e.ctx.phase],i=(e=t(e=t(e,"turn",n.playerID),"phase",n.playerID)).ctx.actionPlayers,a=!1;if(e.ctx._actionPlayersOnce){var s=n.playerID;0==(i=i.filter(function(e){return e!==s})).length&&o.turnOrder.endPhaseOnceDone&&(a=!0)}e=Qn({},e,{ctx:Qn({},e.ctx,{actionPlayers:i})});var c=o.onMove(e.G,e.ctx,n),u=(e=Qn({},e,{G:c})).ctx.turn,l=o.endGameIf(e.G,e.ctx),p=w(e)||a;(p||void 0!==l)&&(e=r(e,tt("endPhase",[p],n.playerID)),o=m[e.ctx.phase]);var h=k(e);if(e.ctx.turn!=u||!h&&void 0===l||(e=r(e,tt("endTurn",[h],n.playerID))),void 0!==l)return Qn({},e,{ctx:Qn({},e.ctx,{gameover:l})});var f=o.allowedMoves(e.G,e.ctx);if(e=Qn({},e,{ctx:Qn({},e.ctx,{allowedMoves:f})}),!h){var d=e._undo||[],y=n.type,v=Dr.detachAllFromContext(e.ctx);e=Qn({},e,{_undo:[].concat(rr(d),[{G:e.G,ctx:v,moveType:y}]),_redo:[]})}return e},canMakeMove:function(e,t,n){var r=m[t.phase].allowedMoves(e,t);return!r||r.includes(n)},canUndoMove:function(e,t,n){var r=m[t.phase];return!r.undoableMoves||r.undoableMoves.includes(n)}})}function Re(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Ne(){}function Be(e,t,n,r){return function(o){var i=o.isActive,a=o.events;return ze.createElement("div",Qn({className:t.join(" "),style:Qn({},e.style,n,{opacity:i?0:1,pointerEvents:i?"none":"all"}),onClick:r},a),e.isFaceUp?e.front:e.back)}}function qe(e,t,n,r){return function(o){var i=o.x,a=o.y,s=o.isOverAccepted,c=o.currentlyHoveredDroppableId,u=[].concat(rr(t)),l=e.back;return r(s),e.isFaceUp&&(l=e.front),null!==c&&u.push(s?"accept":"reject"),ze.createElement("div",{className:u.join(" "),ref:n,style:{cursor:"pointer",borderWidth:2,pointerEvents:"none",position:"fixed",zIndex:2e9,boxShadow:"5px 5px 5px #eee",left:i-50,top:a-70}},l)}}var Le,ze="default"in e?e.default:e,Ue=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}(Le="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),Ge={INIT:"@@redux/INIT"+Math.random().toString(36).substring(7).split("").join("."),REPLACE:"@@redux/REPLACE"+Math.random().toString(36).substring(7).split("").join(".")},He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ye="MAKE_MOVE",We="GAME_EVENT",Ke="REDO",Je="RESET",Ve="SYNC",$e="UNDO",Ze="UPDATE",Qe=function(e,t,n,r){return{type:Ye,payload:{type:e,args:t,playerID:n,credentials:r}}},et=function(e,t,n,r){return{type:We,payload:{type:e,args:t,playerID:n,credentials:r}}},tt=function(e,t,n,r){return{type:We,payload:{type:e,args:t,playerID:n,credentials:r},automatic:!0}},nt=function(e,t){return{type:Ve,state:e,log:t,clientOnly:!0}},rt=function(e,t){return{type:Ze,state:e,deltalog:t,clientOnly:!0}},ot=function(){return{type:Je,clientOnly:!0}},it=function(){return{type:$e}},at=function(){return{type:Ke}},st=Object.freeze({makeMove:Qe,gameEvent:et,automaticGameEvent:tt,sync:nt,update:rt,reset:ot,undo:it,redo:at}),ct="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ut=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,lt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],pt=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=ut.exec(e||""),i={},a=14;a--;)i[lt[a]]=o[a]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i},ht=1e3,ft=60*ht,dt=60*ft,yt=24*dt,vt=365.25*yt,gt=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return s(e);if("number"===n&&!1===isNaN(e))return t.long?u(e):c(e);throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},mt=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,o=n-(i||n);e.diff=o,e.prev=i,e.curr=n,i=n;for(var a=Array(arguments.length),s=0;a.length>s;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}var i;return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;o>n;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")));for(n=0;t.instances.length>n;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gt,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),bt=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=mt).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),Ct=bt("socket.io-client:url"),wt=function(e,t){var n=e;t=t||ct.location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(Ct("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),Ct("parse %s",e),n=pt(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n},kt=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,o=n-(i||n);e.diff=o,e.prev=i,e.curr=n,i=n;for(var a=Array(arguments.length),s=0;a.length>s;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}var i;return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;o>n;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")));for(n=0;t.instances.length>n;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gt,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),xt=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=kt).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),Dt=a(function(e){function t(e){if(e)return n(e)}function n(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;n.length>o;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;o>r;++r)n[r].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),Ot={}.toString,Et=Array.isArray||function(e){return"[object Array]"==Ot.call(e)},It=function(e){return Pt&&ct.Buffer.isBuffer(e)||At&&(e instanceof ct.ArrayBuffer||_t(e))},Pt="function"==typeof ct.Buffer&&"function"==typeof ct.Buffer.isBuffer,At="function"==typeof ct.ArrayBuffer,_t=At&&"function"==typeof ct.ArrayBuffer.isView?ct.ArrayBuffer.isView:function(e){return e.buffer instanceof ct.ArrayBuffer},Mt=Object.prototype.toString,St="function"==typeof ct.Blob||"[object BlobConstructor]"===Mt.call(ct.Blob),Ft="function"==typeof ct.File||"[object FileConstructor]"===Mt.call(ct.File),Tt={deconstructPacket:function(e){var t=[],n=e.data,r=e;return r.data=p(n,t),r.attachments=t.length,{packet:r,buffers:t}},reconstructPacket:function(e,t){return e.data=h(e.data,t),e.attachments=void 0,e},removeBlobs:function(e,t){function n(e,i,a){if(!e)return e;if(St&&e instanceof Blob||Ft&&e instanceof File){r++;var s=new FileReader;s.onload=function(){a?a[i]=this.result:o=this.result,--r||t(o)},s.readAsArrayBuffer(e)}else if(Et(e))for(var c=0;e.length>c;c++)n(e[c],c,e);else if("object"==typeof e&&!It(e))for(var u in e)n(e[u],u,e)}var r=0,o=e;n(o),r||t(o)}},jt=a(function(e,t){function n(){}function r(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var r=o(e.data);if(!1===r)return h;n+=r}return p("encoded %j as %s",e,n),n}function o(e){try{return JSON.stringify(e)}catch(e){return!1}}function i(e,t){Tt.removeBlobs(e,function(e){var n=Tt.deconstructPacket(e),o=r(n.packet),i=n.buffers;i.unshift(o),t(i)})}function a(){this.reconstructor=null}function s(e){var n=0,r={type:+e.charAt(0)};if(null==t.types[r.type])return l("unknown packet type "+r.type);if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=+o||"-"!==e.charAt(n))throw Error("Illegal attachments");r.attachments=+o}if("/"===e.charAt(n+1))for(r.nsp="";++n&&","!==(a=e.charAt(n))&&(r.nsp+=a,n!==e.length););else r.nsp="/";var i=e.charAt(n+1);if(""!==i&&+i==i){for(r.id="";++n;){var a=e.charAt(n);if(null==a||+a!=a){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=+r.id}if(e.charAt(++n)){var s=c(e.substr(n));if(!(!1!==s&&(r.type===t.ERROR||Et(s))))return l("invalid payload");r.data=s}return p("decoded %s as %j",e,r),r}function c(e){try{return JSON.parse(e)}catch(e){return!1}}function u(e){this.reconPack=e,this.buffers=[]}function l(e){return{type:t.ERROR,data:"parser error: "+e}}var p=xt("socket.io-parser");t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=a;var h=t.ERROR+'"encode error"';n.prototype.encode=function(e,n){p("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?i(e,n):n([r(e)])},Dt(a.prototype),a.prototype.add=function(e){var n;if("string"==typeof e)n=s(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new u(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!It(e)&&!e.base64)throw Error("Unknown type: "+e);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Tt.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}}),Rt=a(function(e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}}),Nt=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Rt))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(ct[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}},Bt=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},qt={}.toString,Lt=Array.isArray||function(e){return"[object Array]"==qt.call(e)},zt=Object.prototype.toString,Ut="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===zt.call(Blob),Gt="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===zt.call(File),Ht=f,Xt=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(0>t&&(t+=r),0>n&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;n>a;a++,s++)i[s]=o[a];return i.buffer},Yt=function(e,t,n){function r(e,i){if(0>=r.count)throw Error("after called too many times");--r.count,e?(o=!0,t(e),t=n):0!==r.count||o||t(null,i)}var o=!1;return n=n||d,r.count=e,0===e?t():r},Wt=a(function(e,t){!function(n){function r(e){for(var t,n,r=[],o=0,i=e.length;i>o;)55296>(t=e.charCodeAt(o++))||t>56319||o>=i?r.push(t):56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--);return r}function o(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=v((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=v(t);return o}function i(e,t){if(e>=55296&&57343>=e){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(e,t){return v(e>>t&63|128)}function s(e,t){if(0==(4294967168&e))return v(e);var n="";return 0==(4294965248&e)?n=v(e>>6&31|192):0==(4294901760&e)?(i(e,t)||(e=65533),n=v(e>>12&15|224),n+=a(e,6)):0==(4292870144&e)&&(n=v(e>>18&7|240),n+=a(e,12),n+=a(e,6)),n+=v(63&e|128)}function c(){if(y>=d)throw Error("Invalid byte index");var e=255&f[y];if(y++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var t,n,r,o,a;if(y>d)throw Error("Invalid byte index");if(y==d)return!1;if(t=255&f[y],y++,0==(128&t))return t;if(192==(224&t)){if(n=c(),128>(a=(31&t)<<6|n))throw Error("Invalid continuation byte");return a}if(224==(240&t)){if(n=c(),r=c(),2048>(a=(15&t)<<12|n<<6|r))throw Error("Invalid continuation byte");return i(a,e)?a:65533}if(240==(248&t)&&(n=c(),r=c(),o=c(),(a=(7&t)<<18|n<<12|r<<6|o)>=65536&&1114111>=a))return a;throw Error("Invalid UTF-8 detected")}var l=t,p=e&&e.exports==l&&e,h="object"==typeof ct&&ct;h.global!==h&&h.window!==h||(n=h);var f,d,y,v=String.fromCharCode,g={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,o=r(e),i=o.length,a=-1,c="";++a<i;)c+=s(o[a],n);return c},decode:function(e,t){var n=!1!==(t=t||{}).strict;f=r(e),d=f.length,y=0;for(var i,a=[];!1!==(i=u(n));)a.push(i);return o(a)}};if(l&&!l.nodeType)if(p)p.exports=g;else{var m={}.hasOwnProperty;for(var b in g)m.call(g,b)&&(l[b]=g[b])}else n.utf8=g}(ct)}),Kt=a(function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;64>r;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;o>n;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),p=new Uint8Array(l);for(t=0;c>t;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],p[u++]=r<<2|o>>4,p[u++]=(15&o)<<4|i>>2,p[u++]=(3&i)<<6|63&a;return l}}()}),Jt=ct.BlobBuilder||ct.WebKitBlobBuilder||ct.MSBlobBuilder||ct.MozBlobBuilder,Vt=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),$t=Vt&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),Zt=Jt&&Jt.prototype.append&&Jt.prototype.getBlob,Qt=Vt?$t?ct.Blob:g:Zt?v:void 0,en=a(function(e,t){function n(e,n){return n("b"+t.packets[e.type]+e.data.data)}function r(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=h[e.type];for(var s=0;i.length>s;s++)a[s+1]=i[s];return r(a.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,t.encodePacket(e,n,!0,r)},o.readAsArrayBuffer(e.data)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(p)return o(e,n,r);var i=new Uint8Array(1);return i[0]=h[e.type],r(new Qt([i.buffer,e.data]))}function a(e){try{e=Wt.decode(e,{strict:!1})}catch(e){return!1}return e}function s(e,t,n){for(var r=Array(e.length),o=Yt(e.length,n),i=0;e.length>i;i++)!function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})}(i,e[i],o)}var c;ct&&ct.ArrayBuffer&&(c=Kt);var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),p=u||l;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=Bt(h),d={type:"error",data:"parser error"};t.encodePacket=function(e,t,o,a){"function"==typeof t&&(a=t,t=!1),"function"==typeof o&&(a=o,o=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if(ct.ArrayBuffer&&s instanceof ArrayBuffer)return r(e,t,a);if(Qt&&s instanceof ct.Blob)return i(e,t,a);if(s&&s.base64)return n(e,a);var c=h[e.type];return void 0!==e.data&&(c+=o?Wt.encode(e.data+"",{strict:!1}):e.data+""),a(""+c)},t.encodeBase64Packet=function(e,n){var r="b"+t.packets[e.type];if(Qt&&e.data instanceof ct.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(r+e)},o.readAsDataURL(e.data)}var i;try{i=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=Array(a.length),c=0;a.length>c;c++)s[c]=a[c];i=String.fromCharCode.apply(null,s)}return r+=ct.btoa(i),n(r)},t.decodePacket=function(e,n,r){if(void 0===e)return d;if("string"==typeof e)return"b"===e.charAt(0)?t.decodeBase64Packet(e.substr(1),n):r&&!1===(e=a(e))?d:+(o=e.charAt(0))==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:d;var o=new Uint8Array(e)[0],i=Xt(e,1);return Qt&&"blob"===n&&(i=new Qt([i])),{type:f[o],data:i}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!c)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=c.decode(e.substr(1));return"blob"===t&&Qt&&(r=new Qt([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){function o(e){return e.length+":"+e}"function"==typeof n&&(r=n,n=null);var i=Ht(e);return n&&i?Qt&&!p?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void s(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,o(e))})},function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var o;if(""===e)return r(d,0,1);for(var i,a,s="",c=0,u=e.length;u>c;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(i=+s))return r(d,0,1);if(a=e.substr(c+1,i),s!=a.length)return r(d,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),d.type===o.type&&d.data===o.data)return r(d,0,1);if(!1===r(o,c+i,u))return}c+=i,s=""}else s+=l}return""!==s?r(d,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));s(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+(""+n).length+n+2},0),o=new Uint8Array(r),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;e.length>a;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;for(var s=""+n.byteLength,a=0;s.length>a;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(var r=new Uint8Array(n),a=0;r.length>a;a++)o[i++]=r[a]}),n(o.buffer)})},t.encodePayloadAsBlob=function(e,n){s(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;e.length>o;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}for(var i=""+(e instanceof ArrayBuffer?e.byteLength:e.size),a=new Uint8Array(i.length+1),o=0;i.length>o;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,Qt){var s=new Qt([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new Qt(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var a=new Uint8Array(o),s=0===a[0],c="",u=1;255!==a[u];u++){if(c.length>310)return r(d,0,1);c+=a[u]}o=Xt(o,2+c.length);var l=Xt(o,0,c=parseInt(c));if(s)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var p=new Uint8Array(l);l="";for(u=0;p.length>u;u++)l+=String.fromCharCode(p[u])}i.push(l),o=Xt(o,c)}var h=i.length;i.forEach(function(e,o){r(t.decodePacket(e,n,!0),o,h)})}}),tn=m;Dt(m.prototype),m.prototype.onError=function(e,t){var n=Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},m.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},m.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},m.prototype.send=function(e){if("open"!==this.readyState)throw Error("Transport not open");this.write(e)},m.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},m.prototype.onData=function(e){var t=en.decodePacket(e,this.socket.binaryType);this.onPacket(t)},m.prototype.onPacket=function(e){this.emit("packet",e)},m.prototype.onClose=function(){this.readyState="closed",this.emit("close")};for(var nn,rn={encode:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},decode:function(e){for(var t={},n=e.split("&"),r=0,o=n.length;o>r;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},on=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},an="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),sn=64,cn={},un=0,ln=0;sn>ln;ln++)cn[an[ln]]=ln;C.encode=b,C.decode=function(e){var t=0;for(ln=0;e.length>ln;ln++)t=t*sn+cn[e.charAt(ln)];return t};var pn=C,hn=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,o=n-(i||n);e.diff=o,e.prev=i,e.curr=n,i=n;for(var a=Array(arguments.length),s=0;a.length>s;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}var i;return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;o>n;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")));for(n=0;t.instances.length>n;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gt,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),fn=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=hn).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),dn=fn("engine.io-client:polling"),yn=w,vn=null!=new Nt({xdomain:!1}).responseType;on(w,tn),w.prototype.name="polling",w.prototype.doOpen=function(){this.poll()},w.prototype.pause=function(e){function t(){dn("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(dn("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){dn("pre-pause polling complete"),--r||t()})),this.writable||(dn("we are currently writing - waiting to pause"),r++,this.once("drain",function(){dn("pre-pause writing complete"),--r||t()}))}else t()},w.prototype.poll=function(){dn("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},w.prototype.onData=function(e){var t=this;dn("polling got data %s",e);en.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():dn('ignoring poll - transport state "%s"',this.readyState))},w.prototype.doClose=function(){function e(){dn("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(dn("transport open - closing"),e()):(dn("transport not open - deferring close"),this.once("open",e))},w.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};en.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},w.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=pn()),this.supportsBinary||e.sid||(e.b64=1),e=rn.encode(e),this.port&&("https"===t&&443!=+this.port||"http"===t&&80!=+this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var gn=fn("engine.io-client:polling-xhr"),mn=x,bn=D;on(x,yn),x.prototype.supportsBinary=!0,x.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new D(e)},x.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},x.prototype.doPoll=function(){gn("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},Dt(D.prototype),D.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new Nt(e),n=this;try{gn("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var r in this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},gn("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}ct.document&&(this.index=D.requestsCount++,D.requests[this.index]=this)},D.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},D.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},D.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},D.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=k:this.xhr.onreadystatechange=k,e)try{this.xhr.abort()}catch(e){}ct.document&&delete D.requests[this.index],this.xhr=null}},D.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},D.prototype.hasXDR=function(){return void 0!==ct.XDomainRequest&&!this.xs&&this.enablesXDR},D.prototype.abort=function(){this.cleanup()},D.requestsCount=0,D.requests={},ct.document&&(ct.attachEvent?ct.attachEvent("onunload",O):ct.addEventListener&&ct.addEventListener("beforeunload",O,!1)),mn.Request=bn;var Cn,wn=I,kn=/\n/g,xn=/\\n/g;on(I,yn),I.prototype.supportsBinary=!1,I.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),yn.prototype.doClose.call(this)},I.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},I.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,a=document.createElement("form"),s=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=c,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(xn,"\\\n"),this.area.value=e.replace(kn,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n};var Dn,On={},En=Object.freeze({default:On}),In=En&&On||En,Pn=fn("engine.io-client:websocket"),An=ct.WebSocket||ct.MozWebSocket;if("undefined"==typeof window)try{Dn=In}catch(e){}var _n=An;_n||"undefined"!=typeof window||(_n=Dn);var Mn=P;on(P,tn),P.prototype.name="websocket",P.prototype.supportsBinary=!0,P.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new _n(e,t):new _n(e):new _n(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},P.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},P.prototype.write=function(e){function t(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var r=e.length,o=0,i=r;i>o;o++)!function(e){en.encodePacket(e,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),n.perMessageDeflate){var a="string"==typeof o?ct.Buffer.byteLength(o):o.length;n.perMessageDeflate.threshold>a&&(i.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,i)}catch(e){Pn("websocket closed before onclose event")}--r||t()})}(e[o])},P.prototype.onClose=function(){tn.prototype.onClose.call(this)},P.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},P.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!=+this.port||"ws"===t&&80!=+this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=pn()),this.supportsBinary||(e.b64=1),(e=rn.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},P.prototype.check=function(){return!(!_n||"__initialize"in _n&&this.name===P.prototype.name)};var Sn={polling:function(e){var t=!1,n=!1,r=!1!==e.jsonp;if(ct.location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,n=e.secure!==o}if(e.xdomain=t,e.xscheme=n,"open"in new Nt(e)&&!e.forceJSONP)return new mn(e);if(!r)throw Error("JSONP disabled");return new wn(e)},websocket:Mn},Fn=[].indexOf,Tn=function(e,t){if(Fn)return e.indexOf(t);for(var n=0;e.length>n;++n)if(e[n]===t)return n;return-1},jn=fn("engine.io-client:socket"),Rn=A;A.priorWebsocketSuccess=!1,Dt(A.prototype),A.protocol=en.protocol,A.Socket=A,A.Transport=tn,A.transports=Sn,A.parser=en,A.prototype.createTransport=function(e){jn('creating transport "%s"',e);var t=_(this.query);t.EIO=en.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new Sn[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},A.prototype.open=function(){var e;if(this.rememberUpgrade&&A.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},A.prototype.setTransport=function(e){jn("setting transport %s",e.name);var t=this;this.transport&&(jn("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},A.prototype.probe=function(e){function t(){if(l.onlyBinaryUpgrades){var t=!this.supportsBinary&&l.transport.supportsBinary;u=u||t}u||(jn('probe transport "%s" opened',e),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){if(!u)if("pong"===t.type&&"probe"===t.data){if(jn('probe transport "%s" pong',e),l.upgrading=!0,l.emit("upgrading",c),!c)return;A.priorWebsocketSuccess="websocket"===c.name,jn('pausing current transport "%s"',l.transport.name),l.transport.pause(function(){u||"closed"!==l.readyState&&(jn("changing transport and sending upgrade packet"),s(),l.setTransport(c),c.send([{type:"upgrade"}]),l.emit("upgrade",c),c=null,l.upgrading=!1,l.flush())})}else{jn('probe transport "%s" failed',e);var n=Error("probe error");n.transport=c.name,l.emit("upgradeError",n)}}))}function n(){u||(u=!0,s(),c.close(),c=null)}function r(t){var r=Error("probe error: "+t);r.transport=c.name,n(),jn('probe transport "%s" failed because of error: %s',e,t),l.emit("upgradeError",r)}function o(){r("transport closed")}function i(){r("socket closed")}function a(e){c&&e.name!==c.name&&(jn('"%s" works - aborting "%s"',e.name,c.name),n())}function s(){c.removeListener("open",t),c.removeListener("error",r),c.removeListener("close",o),l.removeListener("close",i),l.removeListener("upgrading",a)}jn('probing transport "%s"',e);var c=this.createTransport(e,{probe:1}),u=!1,l=this;A.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",r),c.once("close",o),this.once("close",i),this.once("upgrading",a),c.open()},A.prototype.onOpen=function(){if(jn("socket open"),this.readyState="open",A.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){jn("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},A.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(jn('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else jn('packet received with socket readyState "%s"',this.readyState)},A.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},A.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},A.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){jn("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},A.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},A.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},A.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(jn("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},A.prototype.write=A.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},A.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},A.prototype.close=function(){function e(){r.onClose("forced close"),jn("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},A.prototype.onError=function(e){jn("socket error %j",e),A.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},A.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){jn('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},A.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;r>n;n++)~Tn(this.transports,e[n])&&t.push(e[n]);return t};var Nn=Rn,Bn=en;Nn.parser=Bn;var qn=function(e,t){for(var n=[],r=(t=t||0)||0;e.length>r;r++)n[r-t]=e[r];return n},Ln=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}},zn=[].slice,Un=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw Error("bind() requires a function");var n=zn.call(arguments,2);return function(){return t.apply(e,n.concat(zn.call(arguments)))}},Gn=a(function(e,t){function n(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var r=bt("socket.io-client:socket");e.exports=n;var o={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},i=Dt.prototype.emit;Dt(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[Ln(e,"open",Un(this,"onopen")),Ln(e,"packet",Un(this,"onpacket")),Ln(e,"close",Un(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var e=qn(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(o.hasOwnProperty(e))return i.apply(this,arguments),this;var t=qn(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:Ht(t))?jt.BINARY_EVENT:jt.EVENT,data:t};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(r("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if(r("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?rn.encode(this.query):this.query;r("sending connect packet with query %s",e),this.packet({type:jt.CONNECT,query:e})}else this.packet({type:jt.CONNECT})},n.prototype.onclose=function(e){r("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===jt.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case jt.CONNECT:this.onconnect();break;case jt.EVENT:case jt.BINARY_EVENT:this.onevent(e);break;case jt.ACK:case jt.BINARY_ACK:this.onack(e);break;case jt.DISCONNECT:this.ondisconnect();break;case jt.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];r("emitting event %j",t),null!=e.id&&(r("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?i.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=qn(arguments);r("sending ack %j",o),t.packet({type:Ht(o)?jt.BINARY_ACK:jt.ACK,id:e,data:o})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(r("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):r("bad ack %s",e.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;this.receiveBuffer.length>e;e++)i.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;this.sendBuffer.length>e;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){r("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;this.subs.length>e;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:jt.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags.compress=e,this},n.prototype.binary=function(e){return this.flags.binary=e,this}}),Hn=M;M.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},M.prototype.reset=function(){this.attempts=0},M.prototype.setMin=function(e){this.ms=e},M.prototype.setMax=function(e){this.max=e},M.prototype.setJitter=function(e){this.jitter=e};var Xn=bt("socket.io-client:manager"),Yn=Object.prototype.hasOwnProperty,Wn=S;S.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)Yn.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},S.prototype.updateSocketIds=function(){for(var e in this.nsps)Yn.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},S.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},Dt(S.prototype),S.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},S.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},S.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},S.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},S.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},S.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},S.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},S.prototype.open=S.prototype.connect=function(e,t){if(Xn("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;Xn("opening %s",this.uri),this.engine=Nn(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=Ln(n,"open",function(){r.onopen(),e&&e()}),i=Ln(n,"error",function(t){if(Xn("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;Xn("connect attempt will timeout after %d",a);var s=setTimeout(function(){Xn("connect attempt timed out after %d",a),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(o),this.subs.push(i),this},S.prototype.onopen=function(){Xn("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(Ln(e,"data",Un(this,"ondata"))),this.subs.push(Ln(e,"ping",Un(this,"onping"))),this.subs.push(Ln(e,"pong",Un(this,"onpong"))),this.subs.push(Ln(e,"error",Un(this,"onerror"))),this.subs.push(Ln(e,"close",Un(this,"onclose"))),this.subs.push(Ln(this.decoder,"decoded",Un(this,"ondecoded")))},S.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},S.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},S.prototype.ondata=function(e){this.decoder.add(e)},S.prototype.ondecoded=function(e){this.emit("packet",e)},S.prototype.onerror=function(e){Xn("error",e),this.emitAll("error",e)},S.prototype.socket=function(e,t){function n(){~Tn(o.connecting,r)||o.connecting.push(r)}var r=this.nsps[e];if(!r){r=new Gn(this,e,t),this.nsps[e]=r;var o=this;r.on("connecting",n),r.on("connect",function(){r.id=o.generateId(e)}),this.autoConnect&&n()}return r},S.prototype.destroy=function(e){var t=Tn(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},S.prototype.packet=function(e){Xn("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;n.length>r;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},S.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},S.prototype.cleanup=function(){Xn("cleanup");for(var e=this.subs.length,t=0;e>t;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},S.prototype.close=S.prototype.disconnect=function(){Xn("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},S.prototype.onclose=function(e){Xn("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},S.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts<this._reconnectionAttempts){var t=this.backoff.duration();Xn("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(Xn("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(Xn("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(Xn("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}else Xn("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1},S.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var Kn=a(function(e,t){function n(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=wt(e),a=i.source,s=i.id,c=i.path,u=o[s]&&c in o[s].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(r("ignoring socket cache for %s",a),n=Wn(a,t)):(o[s]||(r("new io instance for %s",a),o[s]=Wn(a,t)),n=o[s]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}var r=bt("socket.io-client");e.exports=t=n;var o=t.managers={};t.protocol=jt.protocol,t.connect=n,t.Manager=Wn,t.Socket=Gn}),Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn=(function(){function e(e){this.value=e}function t(t){function n(o,i){try{var a=t[o](i),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(a.done?"return":"normal",a.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,t){return new Promise(function(r,a){var s={key:e,arg:t,resolve:r,reject:a,next:null};i?i=i.next=s:(o=i=s,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),$n=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Zn=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Qn=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},er=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},tr=function(e,t){var n={};for(var r in e)0>t.indexOf(r)&&Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},nr=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},rr=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return Array.from(e)},or=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.socket,r=t.socketOpts,o=t.store,i=t.gameID,a=t.playerID,s=t.gameName,c=t.numPlayers,u=t.server;Vn(this,e),this.server=u,this.socket=n,this.store=o,this.socketOpts=r,this.gameName=s||"default",this.gameID=i||"default",this.playerID=a||null,this.numPlayers=c||2,this.gameID=this.gameName+":"+this.gameID,this.isConnected=!1,this.callback=function(){}}return $n(e,[{key:"onAction",value:function(e,t){this.socket.emit("update",t,e._stateID,this.gameID,this.playerID)}},{key:"connect",value:function(){var e=this;if(!this.socket)if(this.server){var t=this.server;-1==t.search(/^https?:\/\//)&&(t="http://"+this.server),this.socket=Kn(t+"/"+this.gameName,this.socketOpts)}else this.socket=Kn("/"+this.gameName,this.socketOpts);this.socket.on("update",function(t,n,r){var o=e.store.getState();if(t==e.gameID&&n._stateID>=o._stateID){var i=rt(n,r);e.store.dispatch(i)}}),this.socket.on("sync",function(t,n,r){if(t==e.gameID){var o=nt(n,r);e.store.dispatch(o)}}),this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers),this.socket.on("connect",function(){e.isConnected=!0,e.callback()}),this.socket.on("disconnect",function(){e.isConnected=!1,e.callback()})}},{key:"subscribe",value:function(e){this.callback=e}},{key:"updateGameID",value:function(e){this.gameID=this.gameName+":"+e;var t=ot();this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}},{key:"updatePlayerID",value:function(e){this.playerID=e;var t=ot();this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}}]),e}(),ir=function(){function e(){Vn(this,e),this.games=new Map}return $n(e,[{key:"connect",value:async function(){}},{key:"set",value:async function(e,t){return await this.games.set(e,t)}},{key:"get",value:async function(e){return await this.games.get(e)}},{key:"has",value:async function(e){return await this.games.has(e)}},{key:"remove",value:async function(e){await this.games.has(e)&&this.games.delete(e)}},{key:"list",value:async function(){return[].concat(rr(await this.games.keys()))}}]),e}(),ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sr="undefined"!=typeof Symbol?Symbol():function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},"immer-nothing",!0),cr="undefined"!=typeof Symbol?Symbol():"__$immer_state",ur="An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",lr=!("undefined"!=typeof process&&!0||"verifyMinified"!==function(){}.name),pr="undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,hr=Object.assign||function(e,t){for(var n in t)U(t,n)&&(e[n]=t[n]);return e},fr=null,dr={get:function(e,t){if(t===cr)return e;if(e.modified){var n=e.copy[t];return n===e.base[t]&&B(n)?e.copy[t]=V(e,n):n}if(U(e.proxies,t))return e.proxies[t];var r=e.base[t];return!N(r)&&B(r)?e.proxies[t]=V(e,r):r},has:function(e,t){return t in K(e)},ownKeys:function(e){return Reflect.ownKeys(K(e))},set:function(e,t,n){if(e.assigned[t]=!0,!e.modified){if(t in e.base&&Y(e.base[t],n)||U(e.proxies,t)&&e.proxies[t]===n)return!0;J(e)}return e.copy[t]=n,!0},deleteProperty:function(e,t){return e.assigned[t]=!1,J(e),delete e.copy[t],!0},getOwnPropertyDescriptor:function(e,t){var n=e.modified?e.copy:U(e.proxies,t)?e.proxies:e.base,r=Reflect.getOwnPropertyDescriptor(n,t);return!r||Array.isArray(n)&&"length"===t||(r.configurable=!0),r},defineProperty:function(){throw Error("Immer does not support defining properties on draft objects.")},setPrototypeOf:function(){throw Error("Immer does not support `setPrototypeOf()`.")}},yr={};z(dr,function(e,t){yr[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),yr.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw Error("Immer does not support deleting properties from arrays: "+t);return dr.deleteProperty.call(this,e[0],t)},yr.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw Error("Immer does not support setting non-numeric properties on arrays: "+t);return dr.set.call(this,e[0],t,n)};var vr={},gr=null,mr=(de(function(e,t){for(var n=0;t.length>n;n++){var r=t[n],o=r.path;if(0===o.length&&"replace"===r.op)e=r.value;else{for(var i=e,a=0;o.length-1>a;a++)if(!(i=i[o[a]])||"object"!==(void 0===i?"undefined":ar(i)))throw Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var s=o[o.length-1];switch(r.op){case"replace":case"add":i[s]=r.value;break;case"remove":if(Array.isArray(i)){if(s!==i.length-1)throw Error("Remove can only remove the last key of an array, index: "+s+", length: "+i.length);i.length-=1}else delete i[s];break;default:throw Error("Unsupported patch operation: "+r.op)}}}return e}),function(e,t){function n(t,r,o){return Object.keys(o).reduce(function(o,i){var a=o[i];if(a instanceof e){var s=t[a];"object"!=typeof s||r.has(s)?o[i]=s:(r.add(s),o[i]=n(t,r,s))}return o},o)}function r(t,n,r){var o=e(n.push(r)-1);return t.set(r,o),o}function o(t){return t instanceof e?e(t):t}function i(n,r){return typeof r===t?new e(r):r}return{parse:function(e){var t=JSON.parse(e,i).map(o),r=t[0];return"object"==typeof r&&r?n(t,new Set,r):r},stringify:function(e){for(var n,o=new Map,i=[],a=[],s=+r(o,i,e),c=function(e,a){if(n)return n=!n,a;switch(typeof a){case"object":if(null===a)return a;case t:return o.get(a)||r(o,i,a)}return a};i.length>s;s++)n=!0,a[s]=JSON.stringify(i[s],c);return"["+a.join(",")+"]"}}}(String,"string"));const br=mr.parse,Cr=mr.stringify;var wr=function(){function e(t){Vn(this,e),this.state=t._random||{seed:"0"}}return $n(e,[{key:"update",value:function(e){var t=Qn({},e.ctx,{_random:this.state});return Qn({},e,{ctx:t})}},{key:"attach",value:function(e){return Qn({},e,{random:this._api()})}},{key:"_random",value:function(){var e=this.state,t=void 0,n=(t=void 0===e.prngstate?new be(e.seed,{state:!0}):new be("",{state:e.prngstate}))();return this.state=Qn({},e,{prngstate:t.state()}),n}},{key:"_api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={};for(var r in t)!function(r){var o=t[r];n[r]=function(t){return void 0===t?Math.floor(e()*o)+1:[].concat(rr(Array(t).keys())).map(function(){return Math.floor(e()*o)+1})}}(r);return Qn({},n,{Die:function(t,n){return void 0===t&&(t=6),void 0===n?Math.floor(e()*t)+1:[].concat(rr(Array(n).keys())).map(function(){return Math.floor(e()*t)+1})},Number:function(){return e()},Shuffle:function(t){for(var n=t.slice(0),r=t.length,o=0,i=Array(r);r;){var a=r*e()|0;i[o++]=n[a],n[a]=n[--r]}return i}})}}]),e}();wr.detach=function(e){return tr(e,["random"])},wr.seed=function(){return(+new Date).toString(36).slice(-10)};var kr=function(){function e(t,n){Vn(this,e),this.flow=t,this.playerID=n,this.dispatch=[]}return $n(e,[{key:"attach",value:function(e){var t=this,n={},r=!0,o=!1,i=void 0;try{for(var a,s=function(){var e=a.value;n[e]=function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];t.dispatch.push({key:e,args:r})}},c=this.flow.eventNames[Symbol.iterator]();!(r=(a=c.next()).done);r=!0)s()}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return Qn({},e,{events:n})}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.dispatch[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=tt(a.key,a.args,this.playerID);e=Qn({},e,this.flow.processGameEvent(e,s))}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e}}]),e}();kr.detach=function(e){return tr(e,["events"])};var xr=function(){function e(){Vn(this,e),this._payload=void 0}return $n(e,[{key:"_api",value:function(){var e=this;return{setPayload:function(t){e._payload=t}}}},{key:"attach",value:function(e){return Qn({},e,{log:this._api()})}},{key:"update",value:function(e){if(void 0===this._payload)return e;var t=e.deltalog;return t[t.length-1]=Qn({},t[t.length-1],{payload:this._payload}),this._payload=void 0,Qn({},e,{deltalog:t})}}],[{key:"detach",value:function(e){return tr(e,["log"])}}]),e}(),Dr=function(){function e(t,n,r){Vn(this,e),this.random=new wr(t),this.events=new kr(n.flow,r),this.log=new xr}return $n(e,[{key:"attachToContext",value:function(e){var t=this.random.attach(e);return t=this.events.attach(t),t=this.log.attach(t)}},{key:"update",value:function(e,t){var n=t?this.events.update(e):e;return n=this.random.update(n),n=this.log.update(n)}},{key:"updateAndDetach",value:function(t,n){var r=this.update(t,n);return r.ctx=e.detachAllFromContext(r.ctx),r}}],[{key:"detachAllFromContext",value:function(e){var t=wr.detach(e);return t=kr.detach(t),t=xr.detach(t)}}]),e}(),Or=function(){},Er=function(){function e(t,n,r,o){Vn(this,e),this.game=t,this.storageAPI=n,this.transportAPI=r,this.isActionFromAuthenticPlayer=function(){return!0},void 0!==o&&(this.isActionFromAuthenticPlayer=o)}return $n(e,[{key:"onUpdate",value:async function(e,t,n,o){var i=this,a=await this.storageAPI.get(n);if(void 0===a)return we("game not found, gameID=["+n+"]"),{error:"game not found"};var s=r(Ce({game:this.game,numPlayers:a.ctx.numPlayers}),a);if(!await this.isActionFromAuthenticPlayer({action:e,db:this.storageAPI,gameID:n,playerID:o}))return{error:"unauthorized action"};if(e.type!=Ye||this.game.flow.canPlayerMakeMove(a.G,a.ctx,o))if(e.type!=We||this.game.flow.canPlayerCallEvent(a.G,a.ctx,o))if(a._stateID===t){var c=s.getState().log||[];s.dispatch(e),a=s.getState(),this.transportAPI.sendAll(function(e){var t=Qn({},a,{G:i.game.playerView(a.G,a.ctx,e),ctx:Qn({},a.ctx,{_random:void 0}),log:void 0,deltalog:void 0});return{type:"update",args:[n,t,a.deltalog]}}),c=[].concat(rr(c),rr(a.deltalog));var u=Qn({},a,{log:c});await this.storageAPI.set(n,u)}else we("invalid stateID, was=["+t+"], expected=["+a._stateID+"]");else we("event not processed - invalid playerID=["+o+"]");else we("move not processed - canPlayerMakeMove=false, playerID=["+o+"]")}},{key:"onSync",value:async function(e,t,n){var o=Ce({game:this.game,numPlayers:n}),i=await this.storageAPI.get(e);void 0===i&&(i=r(o).getState(),await this.storageAPI.set(e,i));var a=Qn({},i,{G:this.game.playerView(i.G,i.ctx,t),ctx:Qn({},i.ctx,{_random:void 0}),log:void 0,deltalog:void 0});this.transportAPI.send({playerID:t,type:"sync",args:[e,a,i.log]})}}]),e}(),Ir=function(){function e(t){var n=t.master,r=t.store,o=t.gameID,i=t.playerID,a=t.gameName,s=t.numPlayers;Vn(this,e),this.master=n,this.store=r,this.gameName=a||"default",this.gameID=o||"default",this.playerID=i||null,this.numPlayers=s||2,this.gameID=this.gameName+":"+this.gameID,this.isConnected=!0}return $n(e,[{key:"onUpdate",value:function(e,t,n){var r=this.store.getState();if(e==this.gameID&&t._stateID>=r._stateID){var o=rt(t,n);this.store.dispatch(o)}}},{key:"onSync",value:function(e,t,n){if(e==this.gameID){var r=nt(t,n);this.store.dispatch(r)}}},{key:"onAction",value:async function(e,t){await this.master.onUpdate(t,e._stateID,this.gameID,this.playerID)}},{key:"connect",value:async function(){var e=this;this.master.connect(this.gameID,this.playerID,function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];"sync"==t&&e.onSync.apply(e,r),"update"==t&&e.onUpdate.apply(e,r)}),await this.master.onSync(this.gameID,this.playerID,this.numPlayers)}},{key:"subscribe",value:function(){}},{key:"updateGameID",value:async function(e){this.gameID=this.gameName+":"+e;var t=ot();this.store.dispatch(t),await this.master.onSync(this.gameID,this.playerID,this.numPlayers)}},{key:"updatePlayerID",value:async function(e){this.playerID=e;var t=ot();this.store.dispatch(t),await this.master.onSync(this.gameID,this.playerID,this.numPlayers)}}]),e}(),Pr=xe.bind(null,"gameEvent"),Ar=xe.bind(null,"makeMove"),_r=function(){function e(t){var n=this,a=t.game,s=t.ai,c=t.numPlayers,u=t.multiplayer,l=t.socketOpts,p=t.gameID,h=t.playerID,f=t.credentials,d=t.enhancer;if(Vn(this,e),this.game=a,this.playerID=h,this.gameID=p,this.credentials=f,this.multiplayer=u,this.subscribeCallback=function(){},this.reducer=Ce({game:a,numPlayers:c,multiplayer:u}),void 0!==s&&void 0===u){var y=new s.bot({game:a,enumerate:s.enumerate});this.step=function(){var e=n.store.getState(),t=e.ctx.actionPlayers[0],r=y.play(e,t),o=r.action,i=r.metadata;return o&&(o.payload.metadata=i,n.store.dispatch(o)),o}}this.reset=function(){n.store.dispatch(ot())},this.undo=function(){n.store.dispatch(it())},this.redo=function(){n.store.dispatch(at())},this.store=null,this.log=[];var v=function(e){return function(t){return function(r){var o=t(r),i=e.getState();switch(r.type){case Ye:case We:var a=i.deltalog;n.log=[].concat(rr(n.log),rr(a));break;case Je:n.log=[];break;case Ze:var s=-1;n.log.length>0&&(s=n.log[n.log.length-1]._stateID);var c=r.deltalog||[];c=c.filter(function(e){return e._stateID>s}),n.log=[].concat(rr(n.log),rr(c));break;case Ve:n.log=r.log||[]}return n.subscribeCallback(),o}}},g=function(e){return function(t){return function(r){var o=e.getState(),i=t(r);return 1!=r.clientOnly&&n.transport.onAction(o,r),i}}};d=void 0!==d?o(i(v,g),d):i(v,g),this.store=r(this.reducer,d),this.transport=u&&void 0!==u.master_?new Ir({master:u.master_,store:this.store,gameID:p,playerID:h,gameName:a.name,numPlayers:c}):u&&void 0!==u.server?new or({store:this.store,gameID:p,playerID:h,gameName:a.name,numPlayers:c,server:u.server,socketOpts:l}):u&&void 0!==u.transport?u.transport:{isConnected:!0,onAction:function(){},subscribe:function(){},connect:function(){},updateGameID:function(){},updatePlayerID:function(){}},this.createDispatchers()}return $n(e,[{key:"subscribe",value:function(e){var t=this,n=function(){return e(t.getState())};this.transport.subscribe(n),this.subscribeCallback=n}},{key:"getState",value:function(){var e=this.store.getState(),t=!0,n=this.game.flow.canPlayerMakeMove(e.G,e.ctx,this.playerID);this.multiplayer&&!n&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||n||(t=!1),void 0!==e.ctx.gameover&&(t=!1);var r=this.game.playerView(e.G,e.ctx,this.playerID),o=Qn({},e,{isActive:t,G:r,log:this.log});return o=Qn({},o,{isConnected:this.transport.isConnected})}},{key:"connect",value:function(){this.transport.connect()}},{key:"createDispatchers",value:function(){this.moves=Ar(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Pr(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e)}},{key:"updateGameID",value:function(e){this.gameID=e,this.createDispatchers(),this.transport.updateGameID(e)}},{key:"updateCredentials",value:function(e){this.credentials=e,this.createDispatchers()}}]),e}(),Mr=function(){};Mr.thatReturns=Ee,Mr.thatReturnsFalse=Ee(!1),Mr.thatReturnsTrue=Ee(!0),Mr.thatReturnsNull=Ee(null),Mr.thatReturnsThis=function(){return this},Mr.thatReturnsArgument=function(e){return e};var Sr=Mr,Fr=function(e,t,n,r,o,i,a,s){if(!e){var c;if(void 0===t)c=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,i,a,s],l=0;(c=Error(t.replace(/%s/g,function(){return u[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},Tr="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",jr=function(){function e(e,t,n,r,o,i){i!==Tr&&Fr(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return n.checkPropTypes=Sr,n.PropTypes=n,n},Rr=a(function(e){e.exports=jr()}),Nr=a(function(e){!function(t,n,r){function o(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return m[e.which]?m[e.which]:b[e.which]?b[e.which]:String.fromCharCode(e.which).toLowerCase()}function a(e,t){return e.sort().join(",")===t.sort().join(",")}function s(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function c(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function u(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function l(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function p(){if(!g){g={};for(var e in m)e>95&&112>e||m.hasOwnProperty(e)&&(g[m[e]]=e)}return g}function h(e,t,n){return n||(n=p()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function f(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}function d(e,t){var n,r,o,i=[];for(n=f(e),o=0;n.length>o;++o)w[r=n[o]]&&(r=w[r]),t&&"keypress"!=t&&C[r]&&(r=C[r],i.push("shift")),l(r)&&i.push(r);return t=h(r,i,t),{key:r,modifiers:i,action:t}}function y(e,t){return null!==e&&e!==n&&(e===t||y(e.parentNode,t))}function v(e){function t(e){e=e||{};var t,n=!1;for(t in C)e[t]?n=!0:C[t]=0;n||(x=!1)}function r(e,t,n,r,o,i){var s,c,u=[],p=n.type;if(!m._callbacks[e])return[];for("keyup"==p&&l(e)&&(t=[e]),s=0;m._callbacks[e].length>s;++s)if(c=m._callbacks[e][s],(r||!c.seq||C[c.seq]==c.level)&&p==c.action&&("keypress"==p&&!n.metaKey&&!n.ctrlKey||a(t,c.modifiers))){var h=!r&&c.combo==o,f=r&&c.seq==r&&c.level==i;(h||f)&&m._callbacks[e].splice(s,1),u.push(c)}return u}function p(e,t,n,r){m.stopCallback(t,t.target||t.srcElement,n,r)||!1===e(t,n)&&(c(t),u(t))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"!=e.type||w!==t?m.handleKey(t,s(e),e):w=!1)}function f(){clearTimeout(b),b=setTimeout(t,1e3)}function y(e,n,r,o){C[e]=0;for(var a=0;n.length>a;++a){var s=a+1===n.length?function(n){p(r,n,e),"keyup"!==o&&(w=i(n)),setTimeout(t,10)}:function(t){return function(){x=t,++C[e],f()}}(o||d(n[a+1]).action);g(n[a],s,o,e,a)}}function g(e,t,n,o,i){m._directMap[e+":"+n]=t;var a,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?y(e,s,t,n):(a=d(e,n),m._callbacks[a.key]=m._callbacks[a.key]||[],r(a.key,a.modifiers,{type:a.action},o,e,i),m._callbacks[a.key][o?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:o,level:i,combo:e}))}var m=this;if(e=e||n,!(m instanceof v))return new v(e);m.target=e,m._callbacks={},m._directMap={};var b,C={},w=!1,k=!1,x=!1;m._handleKey=function(e,n,o){var i,a=r(e,n,o),s={},c=0,u=!1;for(i=0;a.length>i;++i)a[i].seq&&(c=Math.max(c,a[i].level));for(i=0;a.length>i;++i)if(a[i].seq){if(a[i].level!=c)continue;u=!0,s[a[i].seq]=1,p(a[i].callback,o,a[i].combo,a[i].seq)}else u||p(a[i].callback,o,a[i].combo);var h="keypress"==o.type&&k;o.type!=x||l(e)||h||t(s),k=u&&"keydown"==o.type},m._bindMultiple=function(e,t,n){for(var r=0;e.length>r;++r)g(e[r],t,n)},o(e,"keypress",h),o(e,"keydown",h),o(e,"keyup",h)}if(t){for(var g,m={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},b={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},C={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},w={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},k=1;20>k;++k)m[111+k]="f"+k;for(k=0;9>=k;++k)m[k+96]=""+k;v.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},v.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},v.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},v.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},v.prototype.stopCallback=function(e,t){var n=this;return-1>=(" "+t.className+" ").indexOf(" mousetrap ")&&(!y(t,n.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},v.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},v.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(m[t]=e[t]);g=null},v.init=function(){var e=v(n);for(var t in e)"_"!==t.charAt(0)&&(v[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},v.init(),t.Mousetrap=v,e.exports&&(e.exports=v)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)}),Br=function(e){return ze.createElement("div",{className:"gameinfo-item"},ze.createElement("strong",null,e.name," "),ze.createElement("div",null,JSON.stringify(e.value)))};Br.propTypes={name:Rr.string.isRequired,value:Rr.any};var qr=function(e){return ze.createElement("section",{className:"gameinfo"},ze.createElement(Br,{name:"gameID",value:e.gameID}),ze.createElement(Br,{name:"playerID",value:e.playerID}),ze.createElement(Br,{name:"isActive",value:e.isActive}),e.isMultiplayer&&ze.createElement("span",null,ze.createElement(Br,{name:"isConnected",value:e.isConnected}),ze.createElement(Br,{name:"isMultiplayer",value:e.isMultiplayer})))};qr.propTypes={gameID:Rr.string,playerID:Rr.string,isActive:Rr.bool,isConnected:Rr.bool,isMultiplayer:Rr.bool},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.debug-ui {\n  text-align: left;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  background: #fefefe;\n  border-left: 1px solid #ddd;\n  box-shadow: -1px 0 10px #aaa;\n  position: absolute;\n  width: 300px;\n  right: 0;\n  top: 0;\n  height: 100%;\n  font-family: monospace;\n  font-size: 14px;\n}\n\n#debug-controls.docktop {\n  position: fixed;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  align-items: center;\n  padding-left: 10px;\n  padding-right: 10px;\n  min-width: 500px;\n  top: 0;\n  right: 300px;\n  height: 50px;\n  background: #fff;\n  box-shadow: -3px 3px 3px #ccc;\n}\n\n@media only screen and (max-device-width: 750px) {\n  .debug-ui {\n    display: none;\n  }\n}\n\n.debug-ui .gameinfo {\n  background: #ddd;\n  position: fixed;\n  bottom: 0;\n  box-sizing: border-box;\n  width: 285px;\n  margin-left: -20px;\n  margin-bottom: 0;\n  padding: 10px;\n}\n\n.debug-ui .gameinfo-item div {\n  float: right;\n  text-align: right;\n}\n\n.debug-ui .ai-visualization {\n  position: fixed;\n  opacity: 100%;\n  right: 300px;\n  height: 100%;\n  width: 100%;\n  max-width: 3000px;\n  background: #fafafa;\n  border-right: 1px solid #ddd;\n}\n\n.debug-ui .pane {\n  float: left;\n  padding: 20px;\n  box-sizing: border-box;\n  min-width: 300px;\n  max-width: 400px;\n  opacity: 0.8;\n}\n\n.debug-ui section {\n  margin-bottom: 20px;\n}\n\n.debug-ui textarea {\n  resize: none;\n}\n\n.debug-ui .move {\n  cursor: pointer;\n  margin-bottom: 10px;\n  color: #666;\n}\n\n.debug-ui .move:hover {\n  color: #333;\n}\n\n.debug-ui .move.active {\n  color: #111;\n  font-weight: bold;\n}\n\n.debug-ui .move-error {\n  color: #a00;\n  font-weight: bold;\n}\n\n.debug-ui .arg-field {\n  outline: none;\n  font-family: monospace;\n}\n\n.debug-ui .key {\n  margin-bottom: 5px;\n}\n\n.debug-ui .key-box {\n  display: inline-block;\n  cursor: pointer;\n  min-width: 10px;\n  padding-left: 5px;\n  padding-right: 5px;\n  height: 20px;\n  line-height: 20px;\n  text-align: center;\n  border: 1px solid #ccc;\n  box-shadow: 1px 1px 1px #888;\n  background: #eee;\n  color: #444;\n}\n\n.debug-ui .key-box:hover {\n  background: #ddd;\n}\n\n.debug-ui .key.active .key-box {\n  background: #ddd;\n  border: 1px solid #999;\n  box-shadow: none;\n}\n\n.debug-ui .key-child {\n  display: inline-block;\n  height: 20px;\n  margin-left: 10px;\n}\n\n.debug-ui .menu {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n.debug-ui .menu .item {\n  cursor: pointer;\n  margin-top: -10px;\n  margin-bottom: 20px;\n  margin-right: 10px;\n  padding: 5px;\n  min-width: 50px;\n  text-align: center;\n}\n\n.debug-ui .menu .item.active {\n  font-weight: bold;\n  border-bottom: 3px solid #ccc;\n}\n\n.debug-ui .player-box {\n  display: flex;\n  flex-direction: row;\n}\n\n.debug-ui .player {\n  cursor: pointer;\n  text-align: center;\n  width: 30px;\n  height: 30px;\n  line-height: 30px;\n  background: #eee;\n  border: 3px solid #fff;\n  box-sizing: content-box;\n}\n\n.debug-ui .player.current {\n  background: #555;\n  color: #eee;\n  font-weight: bold;\n}\n\n.debug-ui .player.active {\n  border: 3px solid #ff7f50;\n}\n",void 0);var Lr=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={active:!1},r.deactivate=function(){r.setState({active:!1})},r.activate=function(){r.setState({active:!0}),r.props.onPress&&(r.props.onPress(),r.setState({active:!1}))},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"componentDidMount",value:function(){var e=this;Nr.bind(this.props.value,function(t){t.preventDefault(),e.activate()})}},{key:"componentWillUnmount",value:function(){Nr.unbind(this.props.value)}},{key:"render",value:function(){var e=this.props.children;Jn(this.props.children)===Jn(this)&&(e=ze.cloneElement(this.props.children,{active:this.state.active,deactivate:this.deactivate,activate:this.activate}));var t="key";return this.state.active&&(t+=" active"),ze.createElement("div",{className:t},ze.createElement("div",{className:"key-box",onClick:this.activate},this.props.value),ze.createElement("div",{className:"key-child"},e))}}]),t}();Lr.propTypes={value:Rr.string.isRequired,children:Rr.any,onPress:Rr.func};var zr=function(e){var t=null;e.step&&(t=[ze.createElement(Lr,{key:"4",value:"4",onPress:e.step},"step"),ze.createElement(Lr,{key:"5",value:"5",onPress:e.simulate},"simulate")]);var n="controls";e.dockTop&&(n+=" docktop"),e.help&&(n+=" help");var r=e.help&&!e.dockTop?"block":"none";return ze.createElement("section",{id:"debug-controls",style:null,className:n},ze.createElement(Lr,{value:"1",onPress:e.reset},"reset"),ze.createElement(Lr,{value:"2",onPress:e.save},"save"),ze.createElement(Lr,{value:"3",onPress:e.restore},"restore"),t,e.dockTop||ze.createElement(Lr,{value:"?",onPress:e.toggleHelp},"show more"),ze.createElement("div",{className:"key",style:{display:r}},ze.createElement("div",{className:"key-box"},"d")," show/hide this pane"),ze.createElement("div",{className:"key",style:{display:r}},ze.createElement("div",{className:"key-box"},"l")," show/hide log"),ze.createElement("div",{className:"key",style:{display:r}},ze.createElement("div",{className:"key-box"},"i")," show/hide game info tab"),ze.createElement("div",{className:"key",style:{display:r}},ze.createElement("div",{className:"key-box"},"t")," dock controls"))};zr.propTypes={help:Rr.bool,toggleHelp:Rr.func,step:Rr.func,simulate:Rr.func,reset:Rr.func,save:Rr.func,restore:Rr.func,dockTop:Rr.bool};var Ur=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.onClick=function(e){var t=e==r.props.playerID?null:e;r.props.onClick(t)},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"render",value:function(){for(var e=this,t=[],n=0;this.props.ctx.numPlayers>n;n++)!function(n){var r=n+"",o="player";r===e.props.ctx.currentPlayer&&(o+=" current"),r===e.props.playerID&&(o+=" active"),t.push(ze.createElement("div",{className:o,key:n,onClick:function(){return e.onClick(r)}},r))}(n);return ze.createElement("div",{className:"player-box"},t)}}]),t}();Ur.propTypes={ctx:Rr.any.isRequired,playerID:Rr.any,onClick:Rr.func};var Gr=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={error:""},r.onSubmit=function(e){var t="";try{var n=Function("return ["+e+"]")();r.props.fn.apply(r,n)}catch(e){t=""+e}r.setState({error:t,focus:!1,enterArg:!1})},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"render",value:function(){return ze.createElement("div",null,ze.createElement(Lr,{value:this.props.shortcut},ze.createElement(Hr,{name:this.props.name,onSubmit:this.onSubmit})),this.state.error?ze.createElement("span",{className:"move-error"},this.state.error):null)}}]),t}();Gr.propTypes={name:Rr.string.isRequired,shortcut:Rr.string.isRequired,fn:Rr.func.isRequired};var Hr=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.onKeyDown=function(e){if("Enter"==e.key){e.preventDefault();var t=r.span.innerText;r.props.onSubmit(t),r.span.innerText="",r.props.deactivate()}"Escape"==e.key&&(e.preventDefault(),r.props.deactivate())},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"componentDidUpdate",value:function(){this.props.active?this.span.focus():this.span.blur()}},{key:"render",value:function(){var e=this,t="move";return this.props.active&&(t+=" active"),ze.createElement("div",{className:t,onClick:this.props.activate},this.props.name,"(",ze.createElement("span",{ref:function(t){e.span=t},className:"arg-field",onBlur:this.props.deactivate,onKeyDown:this.onKeyDown,contentEditable:!0}),")")}}]),t}();Hr.propTypes={name:Rr.string.isRequired,onSubmit:Rr.func.isRequired,active:Rr.bool,activate:Rr.func,deactivate:Rr.func},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.gamelog {\n  display: grid;\n  grid-template-columns: 30px 1fr 30px;\n  grid-auto-rows: auto;\n  grid-auto-flow: column;\n}\n\n.gamelog .turn-marker {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  grid-column: 1;\n  background: #555;\n  color: #eee;\n  text-align: center;\n  font-weight: bold;\n  border: 1px solid #888;\n}\n\n.gamelog .log-event {\n  grid-column: 2;\n  cursor: pointer;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background: #fff;\n  border: 1px dotted #ccc;\n  border-left: 5px solid #ccc;\n  padding: 5px;\n  text-align: center;\n  color: #888;\n  font-size: 14px;\n  min-height: 25px;\n  line-height: 25px;\n}\n\n.gamelog .phase-marker {\n  grid-column: 3;\n  background: #555;\n  border: 1px solid #888;\n  color: #eee;\n  text-align: center;\n  font-weight: bold;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  text-orientation: sideways;\n  writing-mode: vertical-rl;\n  line-height: 30px;\n  width: 100%;\n}\n\n.gamelog.pinned .log-event {\n  opacity: 0.2;\n}\n\n.gamelog .log-event:hover {\n  border-style: solid;\n  background: #eee;\n}\n\n.gamelog .log-event.pinned {\n  border-style: solid;\n  background: #eee;\n  opacity: 1;\n}\n\n.gamelog div.player0 {\n  border-left-color: #ff851b;\n}\n\n.gamelog div.player1 {\n  border-left-color: #7fdbff;\n}\n\n.gamelog div.player2 {\n  border-left-color: #0074d9;\n}\n\n.gamelog div.player3 {\n  border-left-color: #39cccc;\n}\n\n.gamelog div.player4 {\n  border-left-color: #3d9970;\n}\n\n.gamelog div.player5 {\n  border-left-color: #2ecc40;\n}\n\n.gamelog div.player6 {\n  border-left-color: #01ff70;\n}\n\n.gamelog div.player7 {\n  border-left-color: #ffdc00;\n}\n\n.gamelog div.player8 {\n  border-left-color: #001f3f;\n}\n\n.gamelog div.player9 {\n  border-left-color: #ff4136;\n}\n\n.gamelog div.player10 {\n  border-left-color: #85144b;\n}\n\n.gamelog div.player11 {\n  border-left-color: #f012be;\n}\n\n.gamelog div.player12 {\n  border-left-color: #b10dc9;\n}\n\n.gamelog div.player13 {\n  border-left-color: #111111;\n}\n\n.gamelog div.player14 {\n  border-left-color: #aaaaaa;\n}\n\n.gamelog div.player15 {\n  border-left-color: #dddddd;\n}\n",void 0);var Xr=function(e){var t=void 0!==e.payload?JSON.stringify(e.payload,null,4):"";return ze.createElement("div",null,t)};Xr.propTypes={payload:Rr.any};var Yr=function(e){var t=e.action,n=t.payload.args||[],r="log-event player"+t.payload.playerID;e.pinned&&(r+=" pinned");var o=void 0!==e.payloadComponent?ze.createElement(e.payloadComponent,{payload:e.payload}):ze.createElement(Xr,{payload:e.payload});return ze.createElement("div",{className:r,onClick:function(){return e.onLogClick(e.logIndex)},onMouseEnter:function(){return e.onMouseEnter(e.logIndex)},onMouseLeave:function(){return e.onMouseLeave()}},ze.createElement("div",null,t.payload.type,"(",n.join(","),")"),o)};Yr.propTypes={action:Rr.any.isRequired,logIndex:Rr.number.isRequired,onLogClick:Rr.func.isRequired,onMouseEnter:Rr.func.isRequired,onMouseLeave:Rr.func.isRequired,pinned:Rr.bool,payload:Rr.object,payloadComponent:Rr.oneOfType([Rr.element,Rr.func])};var Wr=function(e){return ze.createElement("div",{className:"turn-marker",style:{gridRow:"span "+e.numEvents}},e.turn)};Wr.propTypes={turn:Rr.number.isRequired,numEvents:Rr.number.isRequired};var Kr=function(e){return ze.createElement("div",{className:"phase-marker",style:{gridRow:"span "+e.numEvents}},e.phase)};Kr.propTypes={phase:Rr.string.isRequired,numEvents:Rr.number.isRequired};var Jr=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={pinned:null},r.rewind=function(e){for(var t=r.props.initialState,n=0;e>=n;n++){var o=r.props.log[n].action;o.automatic||(t=r.props.reducer(t,o))}return{G:t.G,ctx:t.ctx}},r.onLogClick=function(e){r.setState(function(t){var n=r.rewind(e),o=r.props.log[e].action.payload.metadata;return t.pinned===e?(r.props.onHover({logIndex:e,state:n,metadata:void 0}),{pinned:null}):(r.props.onHover({logIndex:e,state:n,metadata:o}),{pinned:e})})},r.onMouseEnter=function(e){if(null===r.state.pinned){var t=r.rewind(e);r.props.onHover({logIndex:e,state:t})}},r.onMouseLeave=function(){null===r.state.pinned&&r.props.onHover({state:null})},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"render",value:function(){for(var e=[],t=[],n=[],r=0,o=0,i=this.props.initialState,a=0,s=0;this.props.log.length>s;s++)(l=this.props.log[s].action).type!=Ye&&l.automatic||(a=s);for(var c=0;this.props.log.length>c;c++){var u=this.props.log[c],l=u.action,p=u.payload,h=i.ctx.turn,f=i.ctx.phase;l.type==Ye&&(e.push(ze.createElement(Yr,{key:c,pinned:c===this.state.pinned,logIndex:c,onLogClick:this.onLogClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,action:l,payload:p,payloadComponent:this.props.payloadComponent})),o++,r++),l.automatic||((i=this.props.reducer(i,l)).ctx.turn==h&&void 0===i.ctx.gameover&&c!=a||(t.push(ze.createElement(Wr,{key:t.length,turn:h,numEvents:o})),o=0),i.ctx.phase==f&&void 0===i.ctx.gameover&&c!=a||(n.push(ze.createElement(Kr,{key:n.length,phase:f,numEvents:r})),r=0))}var d="gamelog";return null!==this.state.pinned&&(d+=" pinned"),ze.createElement("div",{className:d},t,e,n)}}]),t}();Jr.propTypes={onHover:Rr.func,reducer:Rr.func,initialState:Rr.any.isRequired,log:Rr.array.isRequired,payloadComponent:Rr.oneOfType([Rr.element,Rr.func])},Jr.defaultProps={onHover:function(){}};var Vr=function(e){function t(e){Vn(this,t);var n=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.saveState=function(){var e=Cr(n.props.gamestate);window.localStorage.setItem("gamestate",e)},n.restoreState=function(){var e=window.localStorage.getItem("gamestate");if(null!==e){var t=br(e);n.props.store.dispatch(nt(t))}},n.onClickMain=function(){n.setState({showLog:!1})},n.onClickLog=function(){n.setState({showLog:!0})},n.toggleHelp=function(){n.setState(function(e){return{help:!e.help}})},n.onLogHover=function(e){var t=e.state,r=e.metadata;n.setState({AIMetadata:r}),n.props.overrideGameState(t)},n.simulate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;!function r(){n.props.step()&&e>1&&(e--,setTimeout(r,t))}()},n.shortcuts=Ie(e.moves,e.events,"dlit"),n.state={showDebugUI:!0,showLog:!1,showGameInfo:e.showGameInfo,dockControls:e.dockControls,help:!1,AIMetadata:null},n}return er(t,ze.Component),$n(t,[{key:"componentDidMount",value:function(){var e=this;Nr.bind("d",function(t){t.preventDefault(),e.setState(function(e){return{showDebugUI:!e.showDebugUI}})}),Nr.bind("l",function(t){t.preventDefault(),e.setState(function(e){return{showLog:!e.showLog}})}),Nr.bind("i",function(t){t.preventDefault(),e.setState(function(e){return{showGameInfo:!e.showGameInfo}})}),Nr.bind("t",function(t){t.preventDefault(),e.setState(function(e){return{dockControls:!e.dockControls}})})}},{key:"componentWillUnmount",value:function(){Nr.unbind("d"),Nr.unbind("l")}},{key:"render",value:function(){if(!this.state.showDebugUI)return null;var e=[];for(var t in this.props.moves){var n=this.props.moves[t],r=this.shortcuts[t];e.push(ze.createElement(Gr,{key:t,name:t,fn:n,shortcut:r}))}var o=[];for(var i in this.props.events){var a=this.props.events[i],s=this.shortcuts[i];o.push(ze.createElement(Gr,{key:i,name:i,fn:a,shortcut:s}))}var c=this.state.AIMetadata&&this.props.visualizeAI,u="debug-ui";return this.state.dockControls&&(u+=" docktop"),ze.createElement("div",{className:u},c&&ze.createElement("div",{className:"ai-visualization"},this.props.visualizeAI(this.state.AIMetadata)),ze.createElement("div",{className:"pane"},ze.createElement("div",{className:"menu"},ze.createElement("div",{className:this.state.showLog?"item":"item active",onClick:this.onClickMain},"Main"),ze.createElement("div",{className:this.state.showLog?"item active":"item",onClick:this.onClickLog},"Log")),this.state.showLog||ze.createElement("span",null,this.state.showGameInfo&&ze.createElement(qr,{gameID:this.props.gameID,playerID:this.props.playerID,isActive:this.props.gamestate.isActive,isConnected:this.props.gamestate.isConnected,isMultiplayer:this.props.isMultiplayer}),ze.createElement(zr,{dockTop:this.state.dockControls,help:this.state.help,toggleHelp:this.toggleHelp,step:this.props.step,simulate:this.simulate,reset:this.props.reset,save:this.saveState,restore:this.restoreState}),ze.createElement("h3",null,"Players"),ze.createElement(Ur,{ctx:this.props.gamestate.ctx,playerID:this.props.playerID,onClick:this.props.updatePlayerID}),ze.createElement("h3",null,"Moves"),ze.createElement("section",null,e),ze.createElement("h3",null,"Events"),ze.createElement("section",null,o),ze.createElement("section",null,ze.createElement("pre",{className:"json"},ze.createElement("strong",null,"G"),":"," ",JSON.stringify(this.props.gamestate.G,null,2))),ze.createElement("section",null,ze.createElement("pre",{className:"json"},ze.createElement("strong",null,"ctx"),":"," ",JSON.stringify(Pe(this.props.gamestate.ctx),null,2)))),this.state.showLog&&ze.createElement("section",null,ze.createElement(Jr,{onHover:this.onLogHover,reducer:this.props.reducer,log:this.props.gamestate.log,initialState:this.props.gamestate._initial}))))}}]),t}();Vr.propTypes={gamestate:Rr.shape({G:Rr.any.isRequired,ctx:Rr.any.isRequired,log:Rr.array.isRequired,isActive:Rr.bool,isConnected:Rr.bool,_initial:Rr.any.isRequired}),gameID:Rr.string.isRequired,playerID:Rr.string,isMultiplayer:Rr.bool,moves:Rr.any,events:Rr.any,restore:Rr.func,showLog:Rr.bool,store:Rr.any,step:Rr.func,reset:Rr.func,reducer:Rr.func,overrideGameState:Rr.func,visualizeAI:Rr.func,updateGameID:Rr.func,updatePlayerID:Rr.func,updateCredentials:Rr.func,showGameInfo:Rr.bool,dockControls:Rr.bool},Vr.defaultProps={showGameInfo:!0,dockControls:!1};var $r={DEFAULT:{first:function(e,t){return t.playOrderPos},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},ONCE:{first:function(){return 0},next:function(e,t){if(t.playOrder.length-1>t.playOrderPos)return t.playOrderPos+1}},ANY:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{all:!0}},ANY_ONCE:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{all:!0,once:!0},endPhaseOnceDone:!0},OTHERS:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{others:!0}},OTHERS_ONCE:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{others:!0,once:!0},endPhaseOnceDone:!0},CUSTOM:function(e){return{playOrder:function(){return e},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},CUSTOM_FROM:function(e){return{playOrder:function(t){return t[e]},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},SKIP:{first:function(e,t){return t.playOrderPos},next:function(e,t){if(!e.allPassed)for(var n=t.playOrderPos,r=0;t.playOrder.length>r;r++)if(n=(n+1)%t.playOrder.length,!e.passOrder.includes(t.playOrder[n]+""))return n}}},Zr=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),Qr.call(r),o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"_getCellColor",value:function(e,t){var n=e+","+t,r="white";return n in this.props.colorMap&&(r=this.props.colorMap[n]),r}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var e=[],t=0;this.props.cols>t;t++)for(var n=0;this.props.rows>n;n++)e.push(ze.createElement(eo,{key:this.props.cols*n+t,style:{fill:this._getCellColor(t,n)},x:t,y:n,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}));return e}},{key:"render",value:function(){var e=this,t=ze.Children.map(this.props.children,function(t){return ze.cloneElement(t,{template:eo,onClick:e.onClick,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut})});return ze.createElement("svg",{viewBox:"0 0 "+this.props.cols+" "+this.props.rows,style:this.props.style},ze.createElement("g",null,this._getGrid()),t)}}]),t}();Zr.propTypes={rows:Rr.number.isRequired,cols:Rr.number.isRequired,outline:Rr.bool,style:Rr.object,colorMap:Rr.object,cellSize:Rr.number,onClick:Rr.func,onMouseOver:Rr.func,onMouseOut:Rr.func,children:Rr.oneOfType([Rr.arrayOf(Rr.element),Rr.element])},Zr.defaultProps={colorMap:{},outline:!0,cellSize:1};var Qr=function(){var e=this;this.onClick=function(t){e.props.onClick&&e.props.onClick(t)},this.onMouseOver=function(t){e.props.onMouseOver&&e.props.onMouseOver(t)},this.onMouseOut=function(t){e.props.onMouseOut&&e.props.onMouseOut(t)}},eo=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.onClick=function(){r.props.onClick({x:r.props.x,y:r.props.y})},r.onMouseOver=function(){r.props.onMouseOver({x:r.props.x,y:r.props.y})},r.onMouseOut=function(){r.props.onMouseOut({x:r.props.x,y:r.props.y})},o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"render",value:function(){var e=this.props.x*this.props.size,t=this.props.y*this.props.size;return this.props.children?ze.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+e+", "+t+")"},this.props.children):ze.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+e+", "+t+")"},ze.createElement("rect",{style:this.props.style,width:this.props.size,height:this.props.size,x:0,y:0}))}}]),t}();eo.propTypes={x:Rr.number.isRequired,y:Rr.number.isRequired,size:Rr.number,style:Rr.any,onClick:Rr.func,onMouseOver:Rr.func,onMouseOut:Rr.func,children:Rr.element},eo.defaultProps={size:1,x:0,y:0,style:{fill:"#fff"}};var to=function(e){function t(){return Vn(this,t),nr(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return er(t,ze.Component),$n(t,[{key:"componentWillMount",value:function(){this.setState(this.getCoords())}},{key:"componentWillReceiveProps",value:function(e){var t=this.getCoords(),n=this.getCoords(e);t.x==n.x&&t.y==n.y||(this.setState(Qn({},this.state,{originTime:Date.now(),originX:t.x,originY:t.y,originZ:t.z})),requestAnimationFrame(this._animate(Date.now())))}},{key:"_animate",value:function(e){var t=this;return function(){var n=e-t.state.originTime,r=t.getCoords();if(t.props.animationDuration>n&&t.props.animate){var o=t._easeInOutCubic(n,0,1,t.props.animationDuration);t.setState(Qn({},t.state,{x:(r.x-t.state.originX)*o+t.state.originX,y:(r.y-t.state.originY)*o+t.state.originY,z:(r.z-t.state.originZ)*o+t.state.originZ})),requestAnimationFrame(t._animate(Date.now()))}else t.setState(Qn({},t.state,{x:r.x,y:r.y,z:r.z}))}.bind(this)}},{key:"getCoords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{x:e.x,y:e.y,z:e.z}}},{key:"_easeInOutCubic",value:function(e,t,n,r){return 1>(e/=r/2)?n/2*e*e*e+t:(e-=2,n/2*(e*e*e+2)+t)}},{key:"render",value:function(){var e=this.props.template;return ze.createElement(e,{x:this.state.x,y:this.state.y,z:this.state.z,style:this.props.style,onClick:this.props.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut},this.props.children)}}]),t}();to.propTypes={x:Rr.number,y:Rr.number,z:Rr.number,template:Rr.any,style:Rr.any,animate:Rr.bool,onClick:Rr.func,onMouseOver:Rr.func,onMouseOut:Rr.func,children:Rr.element,animationDuration:Rr.number},to.defaultProps={animationDuration:750,template:eo};var no=function(e){var t=e.width,n=e.height;return ze.createElement("svg",{width:t||128,height:n||128,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128"},ze.createElement("path",{d:"M64,120.37,15.27,92.28V35.91L64,7.82l48.73,28.09V92.28Z",fill:"#373748"}),ze.createElement("path",{fill:"#000",d:"M64,124,12,94V34L64,4l52,30V94ZM18.33,90.37,64,116.74l45.67-26.37V37.63L64,11.26,18.33,37.63Z"}),ze.createElement("path",{d:"M81.77,43.17c5.92,0,10.51,1.72,13.57,5.16,3.25,3.44,4.77,8.41,4.77,14.71q0,10.32-5.15,16.06c-3.44,3.82-8.22,5.73-14.53,5.73-5.92,0-10.51-1.72-13.56-5.35-3.25-3.63-4.78-8.6-4.78-15.29s1.72-12,5.16-15.67S75.46,43.17,81.77,43.17Zm-.57,5.16c-4.4,0-7.45,1.15-9.56,3.63s-3,6.31-3,11.66c0,5.73,1,9.74,3,12.42,2.11,2.48,5.16,3.82,9.56,3.82s7.64-1.34,9.74-3.82,3.25-6.5,3.25-11.85c0-5.54-1.15-9.55-3.25-12C88.65,49.48,85.59,48.33,81.2,48.33Z",fill:"#fff"}),ze.createElement("path",{d:"M39.35,71.45l.19,12.8H33.43L33.62,72l-.19-28.48h6.11l-.19,27.9Z",fill:"#fff"}))};no.propTypes={width:Rr.string,height:Rr.string};var ro=ze.createContext(),oo=Object.getOwnPropertySymbols,io=Object.prototype.hasOwnProperty,ao=Object.prototype.propertyIsEnumerable,so=(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;10>n;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}(),"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"),co=function(){function e(e,t,n,r,o,i){if(i!==so){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=Ne,n.PropTypes=n,n},uo=a(function(e){e.exports=co()}),lo=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},po=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ho=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},fo=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},yo={x:0,y:0,isDragging:!1,startingX:0,startingY:0,currentlyDraggingId:null,currentlyHoveredDroppableId:null,currentlyHoveredDroppableAccepts:null,data:null,type:null},vo=new(function(){function e(){lo(this,e),this._state=yo,this._callbacks=[]}return e.prototype.update=function(e){this._state=po({},this._state,e),this._callbacks.forEach(function(e){return e()})},e.prototype.reset=function(){this.update(yo)},e.prototype.subscribe=function(e){var t=this;return this._callbacks=[].concat(this._callbacks,[e]),function(){t._callbacks=t._callbacks.filter(function(t){return t!==e})}},e.prototype.getState=function(){return this._state},e}()),go=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;5>n;n++)e+=t.charAt(Math.floor(62*Math.random()));return e},mo=function(){},bo=function(e){function t(){var n,r,o;lo(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=fo(this,e.call.apply(e,[this].concat(a))),r.state=vo.getState(),r.shouldComponentUpdate=function(e,t){if(e!==r.props)return!0;if(e.subscribeTo){for(var n=!1,o=0;e.subscribeTo.length-1>o;)r.state[e.subscribeTo[o]]!==t[e.subscribeTo[o]]?(n=!0,o=e.length):o++;return n}return t!==r.state},o=n,fo(r,o)}return ho(t,e),t.prototype.componentDidMount=function(){var e=this;this.unsubscribe=vo.subscribe(function(){e.setState(vo.getState())})},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){var e=this.state,t=e.currentlyHoveredDroppableAccepts,n="string"==typeof e.currentlyHoveredDroppableId;return(this.props.alwaysRender||e.isDragging&&e.currentlyDraggingId===this.props.for)&&this.props.children(po({},e,{isOverAccepted:!!n&&(null===t||(Array.isArray(t)?t.includes(e.type):e.type===t))}))},t}(e.Component);bo.defaultProps={for:"",alwaysRender:!1,subscribeTo:null},bo.propTypes={children:uo.func.isRequired,for:uo.oneOfType([uo.string,uo.number]).isRequired,alwaysRender:uo.bool,subscribeTo:uo.array};var Co=function(e){function t(){var n,r,o;lo(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=fo(this,e.call.apply(e,[this].concat(a))),r.state={startCoordinate:null,storeState:po({},vo.getState(),{isActive:!1})},r.startDragDelay=function(e){var t=void 0,n=void 0;"ontouchstart"in window&&e.touches?(t=e.touches[0].clientX,n=e.touches[0].clientY):(e.preventDefault(),t=e.clientX,n=e.clientY),vo.update({startingX:t,startingY:n}),r.setState({startCoordinate:{x:t,y:n}}),document.addEventListener("mouseup",r.endDragDelay),document.addEventListener("mousemove",r.checkDragDelay),document.addEventListener("touchend",r.endDragDelay),document.addEventListener("touchmove",r.checkDragDelay)},r.checkDragDelay=function(e){var t=void 0,n=void 0;"ontouchstart"in window&&e.touches?(t=e.touches[0].clientX,n=e.touches[0].clientY):(e.preventDefault(),t=e.clientX,n=e.clientY);var o=Math.abs(r.state.startCoordinate.x-t),i=Math.abs(r.state.startCoordinate.y-n),a=Math.round(Math.sqrt(Math.pow(o,2)+Math.pow(i,2)));r.props.delay>a||(r.endDragDelay(),"ontouchstart"in window&&e.touches?r.startMobileDrag(e):r.startDrag(e))},r.endDragDelay=function(){document.removeEventListener("mouseup",r.endDragDelay),document.removeEventListener("mousemove",r.checkDragDelay),document.removeEventListener("touchend",r.endDragDelay),document.removeEventListener("touchmove",r.checkDragDelay),r.setState({startCoordinate:null})},r.startDrag=function(e){vo.update({isDragging:!0,startingX:e.clientX,startingY:e.clientY,x:e.clientX,y:e.clientY,currentlyDraggingId:r.props.id,data:r.props.data,type:r.props.type}),r.props.onDragStart(vo.getState().data),window.addEventListener("mouseup",r.stopDrag),window.addEventListener("mousemove",r.updateCoordinates)},r.startMobileDrag=function(e){r.props.onDragStart(vo.getState().data);var t=e.touches[0];vo.update({isDragging:!0,startingX:t.clientX,startingY:t.clientY,x:t.clientX,y:t.clientY,currentlyDraggingId:r.props.id,data:r.props.data,type:r.props.type}),window.addEventListener("touchend",r.stopDrag),window.addEventListener("touchmove",r.updateMobileCoordinates)},r.stopDrag=function(e){r.props.onDragEnd(vo.getState().data),vo.reset(),window.removeEventListener("mouseup",r.stopDrag),window.removeEventListener("mousemove",r.updateCoordinates),window.removeEventListener("touchend",r.stopDrag),window.removeEventListener("touchmove",r.updateMobileCoordinates)},r.updateCoordinates=function(e){vo.update({x:e.clientX,y:e.clientY}),r.props.onDrag()},r.updateMobileCoordinates=function(e){var t=e.touches[0];vo.update({x:t.clientX,y:t.clientY}),r.props.onDrag()},r.shouldComponentUpdate=function(e,t){if(e!==r.props)return!0;if(e.subscribeTo){for(var n=!1,o=0;e.subscribeTo.length-1>o;)r.state[e.subscribeTo[o]]!==t[e.subscribeTo[o]]?(n=!0,o=e.length):o++;return n}return t!==r.state},o=n,fo(r,o)}return ho(t,e),t.prototype.componentDidMount=function(){var e=this;this.unsubscribe=vo.subscribe(function(){var t=vo.getState();e.setState({storeState:po({},t,{isActive:t.currentlyDraggingId===e.props.id})})})},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){var e=this.state.storeState;return this.props.children(po({},e,{events:{onMouseDown:this.startDragDelay,onTouchStart:this.startDragDelay}}))},t}(e.Component);Co.defaultProps={id:go(),data:null,type:null,delay:8,onDragStart:mo,onDrag:mo,onDragEnd:mo,subscribeTo:null},Co.propTypes={children:uo.func.isRequired,delay:uo.number,id:uo.oneOfType([uo.number,uo.string]).isRequired,type:uo.oneOfType([uo.number,uo.string]),onDragStart:uo.func,onDrag:uo.func,onDragEnd:uo.func,subscribeTo:uo.array};var wo=function(e){function t(){var n,r,o;lo(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=fo(this,e.call.apply(e,[this].concat(a))),r.state=po({},vo.getState(),{isOver:!1}),r.setOver=function(){vo.getState().isDragging&&(vo.update({currentlyHoveredDroppableId:r.props.id,currentlyHoveredDroppableAccepts:r.props.accepts}),r.props.onDragEnter())},r.setOut=function(){vo.getState().isDragging&&(vo.update({currentlyHoveredDroppableId:null,currentlyHoveredDroppableAccepts:null}),r.props.onDragLeave())},r.onDrop=function(){var e=vo.getState(),t=e.data,n=e.type;e.isDragging&&(Array.isArray(r.props.accepts)?r.props.accepts.includes(n)&&r.props.onDrop(t):n===r.props.accepts&&r.props.onDrop(t))},r.shouldComponentUpdate=function(e,t){if(e!==r.props)return!0;if(e.subscribeTo){for(var n=!1,o=0;e.subscribeTo.length-1>o;)r.state[e.subscribeTo[o]]!==t[e.subscribeTo[o]]?(n=!0,o=e.length):o++;return n}return t!==r.state},o=n,fo(r,o)}return ho(t,e),t.prototype.componentDidMount=function(){var e=this;this.unsubscribe=vo.subscribe(function(){var t=vo.getState();e.setState(po({},t,{isOver:t.currentlyHoveredDroppableId===e.props.id,willAccept:Array.isArray(e.props.accepts)?e.props.accepts.includes(t.type):e.props.accepts===t.type}))})},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){var e=this.state;return this.props.children(po({},e,{events:{onMouseEnter:this.setOver,onMouseLeave:this.setOut,onMouseUp:this.onDrop}}))},t}(e.Component);wo.defaultProps={id:go(),accepts:null,onDragEnter:mo,onDragLeave:mo,onDrop:mo,subscribeTo:null},wo.propTypes={id:uo.oneOfType([uo.string,uo.array]),children:uo.func.isRequired,accepts:uo.oneOfType([uo.string,uo.array]),onDrop:uo.func,onDragEnter:uo.func,onDragLeave:uo.func,subscribeTo:uo.array};var ko=function(e){function t(){var n,r,o;lo(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=fo(this,e.call.apply(e,[this].concat(a))),r.state=vo.getState(),r.shouldComponentUpdate=function(e,t){if(e!==r.props)return!0;if(e.subscribeTo){for(var n=!1,o=0;e.subscribeTo.length-1>o;)r.state[e.subscribeTo[o]]!==t[e.subscribeTo[o]]?(n=!0,o=e.length):o++;return n}return t!==r.state},o=n,fo(r,o)}return ho(t,e),t.prototype.componentDidMount=function(){var e=this;this.unsubscribe=vo.subscribe(function(){e.setState(vo.getState())})},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){return(0,this.props.children)(po({},this.state))},t}(e.Component);ko.defaultProps={subscribeTo:null},ko.propTypes={children:uo.func.isRequired,subscribeTo:uo.array},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.bgio-card {\n  display: flex;\n  user-select: none;\n  font-family: monospace;\n  font-weight: bold;\n  font-size: 18px;\n  color: #ababab;\n  text-align: center;\n  flex-direction: column;\n  justify-content: center;\n  cursor: pointer;\n  background: #fff;\n  border-radius: 6px;\n  border: 1px solid #cdcdcd;\n  width: 100px;\n  height: 140px;\n  overflow: hidden;\n  transition: transform 0.1s;\n}\n\n.bgio-card.placeholder {\n  cursor: default;\n  opacity: 0;\n  pointer-events: none;\n}\n\n.bgio-card.accept {\n  transform: rotate(10deg);\n  box-shadow: 5px 5px 5px #ddd;\n}\n\n.bgio-card.reject {\n}\n\n.bgio-card__front,\n.bgio-card__back {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n}\n\n.bgio-card__back {\n  background-image: url(\"data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 16c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zm33.414-6l5.95-5.95L45.95.636 40 6.586 34.05.636 32.636 2.05 38.586 8l-5.95 5.95 1.414 1.414L40 9.414l5.95 5.95 1.414-1.414L41.414 8zM40 48c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zM9.414 40l5.95-5.95-1.414-1.414L8 38.586l-5.95-5.95L.636 34.05 6.586 40l-5.95 5.95 1.414 1.414L8 41.414l5.95 5.95 1.414-1.414L9.414 40z' fill='%23ababab' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E\");\n  background-position: 2px 2px;\n  outline: 8px solid #eee;\n  outline-offset: -20px;\n}\n",void 0);var xo=function(e){function t(e){Vn(this,t);var n=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(){n.props.onClick(n.props.data)},n.id=e.context.genID(),n.dragComponentRef=ze.createRef(),n.isOverAccepted=!1,n}return er(t,ze.Component),$n(t,[{key:"render",value:function(){var e=this,t=["bgio-card"];this.props.className&&t.push(this.props.className);var n={};return this.props.inDeck&&(n={position:"absolute",zIndex:this.props.deckPosition}),ze.createElement("div",null,ze.createElement(Co,{id:this.id,type:this.props.dragZone,data:this.props.data},Be(this.props,t,n,this.onClick)),ze.createElement(bo,{for:this.id},qe(this.props,t,this.dragComponentRef,function(t){return e.isOverAccepted=t})))}}]),t}();xo.propTypes={isFaceUp:Rr.bool,front:Rr.node,back:Rr.node,className:Rr.string,dragZone:Rr.string,style:Rr.any,onClick:Rr.func,context:Rr.any.isRequired,inDeck:Rr.bool,data:Rr.any,deckPosition:Rr.number},xo.defaultProps={onClick:function(){},isFaceUp:!1,dragZone:"bgio-card",front:ze.createElement("div",{className:"bgio-card__front"},"Card"),back:ze.createElement("div",{className:"bgio-card__back"},ze.createElement(no,{width:"48"}))};var Do=function(e){function t(){var e,n,r,o;Vn(this,t);for(var i=arguments.length,a=Array(i),s=0;i>s;s++)a[s]=arguments[s];return n=r=nr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),Oo.call(r),o=n,nr(r,o)}return er(t,ze.Component),$n(t,[{key:"_getCellColor",value:function(e,t,n){var r=e+","+t+","+n,o="white";return r in this.props.colorMap&&(o=this.props.colorMap[r]),o}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var e=[],t=this.props.levels,n=-t;t>=n;n++)for(var r=-t;t>=r;r++){var o=-n-r;Math.abs(o)>t||e.push(ze.createElement(Eo,{key:n+":"+r+":"+o,style:{fill:this._getCellColor(n,r,o)},x:n,y:r,z:o,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}))}return e}},{key:"render",value:function(){var e=this,t=ze.Children.map(this.props.children,function(t){return ze.cloneElement(t,{template:Eo,onClick:e.onClick,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut})}),n=this.props.cellSize*this.props.levels*2;return ze.createElement("svg",{viewBox:-n+" "+-n+" "+2*n+" "+2*n,style:this.props.style},ze.createElement("g",null,this._getGrid()),t)}}]),t}();Do.propTypes={levels:Rr.number.isRequired,outline:Rr.bool,style:Rr.object,colorMap:Rr.object,cellSize:Rr.number,onClick:Rr.func,onMouseOver:Rr.func,onMouseOut:Rr.func,children:Rr.oneOfType([Rr.arrayOf(Rr.element),Rr.element])},Do.defaultProps={levels:5,colorMap:{},outline:!0,cellSize:1};var Oo=function(){var e=this;this.onClick=function(t){e.props.onClick&&e.props.onClick(t)},this.onMouseOver=function(t){e.props.onMouseOver&&e.props.onMouseOver(t)},this.onMouseOut=function(t){e.props.onMouseOut&&e.props.onMouseOut(t)}},Eo=function(e){function t(e){Vn(this,t);var n=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(){n.props.onClick({x:n.props.x,y:n.props.y,z:n.props.z})},n.onMouseOver=function(){n.props.onMouseOver({x:n.props.x,y:n.props.y,z:n.props.z})},n.onMouseOut=function(){n.props.onMouseOut({x:n.props.x,y:n.props.y,z:n.props.z})},n}return er(t,ze.Component),$n(t,[{key:"render",value:function(){var e=this.center.x,t=this.center.y;return this.props.children?ze.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+e+", "+t+")"},this.props.children):ze.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+e+", "+t+")"},ze.createElement("polygon",{style:this.props.style,points:this.points,stroke:"#aaa",strokeWidth:.01}))}},{key:"width",get:function(){return 2*this.props.size}},{key:"height",get:function(){return(Math.sqrt(3)/2*this.width).toFixed(3)}},{key:"center",get:function(){var e=this.props.x,t=this.props.z;return{x:3*this.props.size*e/2,y:this.props.size*Math.sqrt(3)*(t+e/2)}}},{key:"points",get:function(){var e=this.props.size,t=this.height,n=-e/2,r=+e/2,o=t/2,i=-t/2;return[-e+",0",n+","+o,r+","+o,+e+",0",r+","+i,n+","+i].join(" ")}}]),t}();Eo.propTypes={x:Rr.number,y:Rr.number,z:Rr.number,size:Rr.number,style:Rr.any,onClick:Rr.func,onMouseOver:Rr.func,onMouseOut:Rr.func,children:Rr.element},Eo.defaultProps={size:1,x:0,y:0,z:0,style:{fill:"#fff"}};var Io=function(){function e(t){var n=this,r=t.enumerate,o=t.seed;Vn(this,e),this.enumerate=function(e,t,r){return n.enumerateFn(e,t,r).map(function(e){return void 0!==e.payload?e:void 0!==e.move?Qe(e.move,e.args,r):void 0!==e.event?et(e.event,e.args,r):void 0})},this.enumerateFn=r,this.seed=o}return $n(e,[{key:"random",value:function(e){var t=void 0;if(void 0!==this.seed){var n=null;t=(n=this.prngstate?new be("",{state:this.prngstate}):new be(this.seed,{state:!0}))(),this.prngstate=n.state()}else t=Math.random();return e?e.length?e[Math.floor(t*e.length)]:Math.floor(t*e):t}}]),e}(),Po=function(e){function t(){return Vn(this,t),nr(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return er(t,Io),$n(t,[{key:"play",value:function(e,t){var n=e.G,r=e.ctx,o=this.enumerate(n,r,t);return{action:this.random(o)}}}]),t}(),Ao=function(e){function t(e){var n=e.enumerate,r=e.seed,o=e.objectives,i=e.game,a=e.iterations,s=e.playoutDepth;Vn(this,t);var c=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{enumerate:n,seed:r}));return void 0===o&&(o=function(){return{}}),c.objectives=o,c.reducer=Ce({game:i}),c.iterations=a||1e3,c.playoutDepth=s||50,c}return er(t,Io),$n(t,[{key:"createNode",value:function(e){var t=e.state,n=e.parentAction,r=e.parent,o=e.playerID,i=t.G,a=t.ctx,s=[],c=[];if(void 0!==o)s=this.enumerate(i,a,o),c=this.objectives(i,a,o);else{var u=!0,l=!1,p=void 0;try{for(var h,f=a.actionPlayers[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;s=s.concat(this.enumerate(i,a,d)),c=c.concat(this.objectives(i,a,d))}}catch(e){l=!0,p=e}finally{try{!u&&f.return&&f.return()}finally{if(l)throw p}}}return{state:t,parent:r,parentAction:n,actions:s,objectives:c,children:[],visits:0,value:0}}},{key:"select",value:function(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;var t=null,n=0,r=!0,o=!1,i=void 0;try{for(var a,s=e.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value,u=c.visits+Number.EPSILON,l=c.value/u+Math.sqrt(2*Math.log(e.visits)/u);(null==t||l>n)&&(n=l,t=c)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return this.select(t)}},{key:"expand",value:function(e){var t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;var n=this.random(t.length),r=t[n];e.actions.splice(n,1);var o=this.reducer(e.state,r),i=this.createNode({state:o,parentAction:r,parent:e});return e.children.push(i),i}},{key:"playout",value:function(e){for(var t=this,n=e.state,r=0;this.playoutDepth>r&&void 0===n.ctx.gameover;r++){var o=function(e){var r=n,o=r.G,i=r.ctx,a=t.enumerate(o,i,i.actionPlayers[0]),s=t.objectives(o,i),c=Object.keys(s).reduce(function(e,t){var n=s[t];return n.checker(o,i)?e+n.weight:e},0);if(c>0)return{v:{score:c}};if(!a||0==a.length)return{v:void 0};var u=t.random(a.length),l=t.reducer(n,a[u]);n=l}();if("object"===(void 0===o?"undefined":Jn(o)))return o.v}return n.ctx.gameover}},{key:"backpropagate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}},{key:"play",value:function(e,t){for(var n=this.createNode({state:e,playerID:t}),r=0;this.iterations>r;r++){var o=this.select(n),i=this.expand(o),a=this.playout(i);this.backpropagate(i,a)}var s=null,c=!0,u=!1,l=void 0;try{for(var p,h=n.children[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var f=p.value;(null==s||f.visits>s.visits)&&(s=f)}}catch(e){u=!0,l=e}finally{try{!c&&h.return&&h.return()}finally{if(u)throw l}}return{action:s&&s.parentAction,metadata:n}}}]),t}();return{Client:Oe,ReactClient:function(e){var t,n,r=De(e),o=r.game,i=r.numPlayers,a=r.board,s=r.multiplayer,c=r.ai,u=r.debug,l=r.enhancer;return n=t=function(e){function t(e){Vn(this,t);var n=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={gameStateOverride:null},n.updateGameID=function(e){n.client.updateGameID(e),n.gameID=e,n.forceUpdate()},n.updatePlayerID=function(e){n.client.updatePlayerID(e),n.playerID=e,n.forceUpdate()},n.updateCredentials=function(e){n.client.updateCredentials(e),n.credentials=e,n.forceUpdate()},n.overrideGameState=function(e){n.setState({gameStateOverride:e})},n.client=Oe({game:o,ai:c,numPlayers:i,multiplayer:s,gameID:e.gameID,playerID:e.playerID,credentials:e.credentials,enhancer:l}),n.gameID=e.gameID,n.playerID=e.playerID,n.credentials=e.credentials,n.client.subscribe(function(){return n.forceUpdate()}),n}return er(t,ze.Component),$n(t,[{key:"componentDidUpdate",value:function(e){this.props.gameID!=e.gameID&&this.updateGameID(this.props.gameID),this.props.playerID!=e.playerID&&this.updatePlayerID(this.props.playerID),this.props.credentials!=e.credentials&&this.updateCredentials(this.props.credentials)}},{key:"componentDidMount",value:function(){this.client.connect()}},{key:"render",value:function(){var e=null,t=null,n=this.client.getState(),r=this.props,o=r.debug,i=tr(r,["debug"]);if(this.state.gameStateOverride&&(n=Qn({},n,this.state.gameStateOverride)),a&&(e=ze.createElement(a,Qn({},n,i,{isMultiplayer:void 0!==s,moves:this.client.moves,events:this.client.events,gameID:this.gameID,playerID:this.playerID,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo}))),!1!==u&&o){var l="object"===(void 0===u?"undefined":Jn(u))&&u.showGameInfo,p="object"===(void 0===u?"undefined":Jn(u))&&u.dockControls;t=ze.createElement(Vr,{gamestate:n,reducer:this.client.reducer,store:this.client.store,isMultiplayer:void 0!==s,moves:this.client.moves,events:this.client.events,gameID:this.gameID,playerID:this.playerID,credentials:this.credentials,step:this.client.step,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,visualizeAI:c&&c.visualize,overrideGameState:this.overrideGameState,updateGameID:this.updateGameID,updatePlayerID:this.updatePlayerID,updateCredentials:this.updateCredentials,showGameInfo:l,dockControls:p})}return ze.createElement("div",{className:"client"},ze.createElement("span",null,t,e))}}]),t}(),t.propTypes={gameID:Rr.string,playerID:Rr.string,credentials:Rr.string,debug:Rr.any},t.defaultProps={gameID:"default",playerID:null,credentials:null,debug:!0},n},ReactNativeClient:function(e){var t,n,r=De(e),o=r.game,i=r.numPlayers,a=r.board,s=r.multiplayer,c=r.enhancer;return n=t=function(e){function t(e){Vn(this,t);var n=nr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.client=Oe({game:o,numPlayers:i,multiplayer:s,gameID:e.gameID,playerID:e.playerID,credentials:e.credentials,socketOpts:{transports:["websocket"]},enhancer:c}),n.client.subscribe(function(){return n.forceUpdate()}),n}return er(t,ze.Component),$n(t,[{key:"componentWillReceiveProps",value:function(e){e.gameID!=this.props.gameID&&this.client.updateGameID(e.gameID),e.playerID!=this.props.playerID&&this.client.updatePlayerID(e.playerID),e.credentials!=this.props.credentials&&this.client.updateCredentials(e.credentials)}},{key:"componentWillMount",value:function(){this.client.connect()}},{key:"render",value:function(){var e=null,t=this.client.getState(),n=this.props,r=n.gameID,o=n.playerID,i=tr(n,["gameID","playerID"]);return a&&(e=ze.createElement(a,Qn({},t,i,{gameID:r,playerID:o,isMultiplayer:void 0!==s,moves:this.client.moves,events:this.client.events,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo}))),e}}]),t}(),t.propTypes={gameID:Rr.string,playerID:Rr.string,credentials:Rr.string},t.defaultProps={gameID:"default",playerID:null,credentials:null},n},Game:function(e){var t=e.name,n=e.setup,r=e.moves,o=e.playerView,i=e.flow,a=e.seed;return void 0===t&&(t="default"),void 0===n&&(n=function(){return{}}),void 0===r&&(r={}),void 0===o&&(o=function(e){return e}),i&&void 0!==i.processGameEvent||(i=je(i||{})),{name:t,setup:n,playerView:o,flow:i,seed:a,moveNames:Object.getOwnPropertyNames(r),processMove:function(e,t,n){if(r.hasOwnProperty(t.type)){var o=[e,Qn({},n,{playerID:t.playerID})].concat(t.args);return de(r[t.type]).apply(void 0,rr(o))}return e}}},Flow:Te,FlowWithPhases:je,TurnOrder:$r,Pass:function(e,t){var n=[];void 0!==e.passOrder&&(n=e.passOrder);var r=t.playerID;return n=[].concat(rr(n),[r]),e=Qn({},e,{passOrder:n}),t.numPlayers>n.length||(e=Qn({},e,{allPassed:!0})),e},Card:function(e){return ze.createElement(ro.Consumer,null,function(t){return ze.createElement(xo,Qn({},e,{context:t}))})},Token:to,Grid:Zr,HexGrid:Do,AI:function(e){var t=e.bot,n=e.enumerate,r=e.visualize;return t||(t=Ao),{bot:t,enumerate:n,visualize:r}},RandomBot:Po,MCTSBot:Ao}});
