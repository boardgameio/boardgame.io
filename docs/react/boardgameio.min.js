!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.BoardgameIO=t(e.React)}(this,function(e){"use strict";function t(e,t){if("undefined"==typeof document)return t;e=e||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t}function n(e){var t=Q.call(e,te),n=e[te];try{e[te]=void 0;var r=!0}catch(e){}var o=ee.call(e);return r&&(t?e[te]=n:delete e[te]),o}function r(e){return ne.call(e)}function o(e){return null==e?void 0===e?oe:re:ie&&ie in Object(e)?n(e):r(e)}function i(e){return null!=e&&"object"==typeof e}function s(e){if(!i(e)||o(e)!=ae)return!1;var t=se(e);if(null===t)return!0;var n=le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&pe.call(n)==he}function a(e,t){return t={exports:{}},e(t,t.exports),t.exports}function c(e,t,n){function r(){f===h&&(f=h.slice())}function o(){return l}function i(e){if("function"!=typeof e)throw Error("Expected listener to be a function.");var t=!0;return r(),f.push(e),function(){if(t){t=!1,r();var n=f.indexOf(e);f.splice(n,1)}}}function a(e){if(!s(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw Error("Reducers may not dispatch actions.");try{d=!0,l=p(l,e)}finally{d=!1}for(var t=h=f,n=0;t.length>n;n++)(0,t[n])();return e}var u;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw Error("Expected the enhancer to be a function.");return n(c)(e,t)}if("function"!=typeof e)throw Error("Expected the reducer to be a function.");var p=e,l=t,h=[],f=h,d=!1;return a({type:ve.INIT}),u={dispatch:a,subscribe:i,getState:o,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");p=e,a({type:ve.INIT})}},u[ye]=function(){var e,t=i;return e={subscribe:function(e){function n(){e.next&&e.next(o())}if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");return n(),{unsubscribe:t(n)}}},e[ye]=function(){return this},e},u}function u(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function p(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return function(n,r,o){var i=e(n,r,o),s=i.dispatch,a=[],c={getState:i.getState,dispatch:function(e){return s(e)}};return a=t.map(function(e){return e(c)}),s=u.apply(void 0,a)(i.dispatch),me({},i,{dispatch:s})}}}function l(e){if(100>=(e+="").length){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*Se;case"days":case"day":case"d":return n*De;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Me;case"minutes":case"minute":case"mins":case"min":case"m":return n*Pe;case"seconds":case"second":case"secs":case"sec":case"s":return n*Ae;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function h(e){return De>e?Me>e?Pe>e?Ae>e?e+"ms":Math.round(e/Ae)+"s":Math.round(e/Pe)+"m":Math.round(e/Me)+"h":Math.round(e/De)+"d"}function f(e){return d(e,De,"day")||d(e,Me,"hour")||d(e,Pe,"minute")||d(e,Ae,"second")||e+" ms"}function d(e,t,n){if(e>=t)return 1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}function y(e){if(!e||"object"!=typeof e)return!1;if(Ue(e)){for(var t=0,n=e.length;n>t;t++)if(y(e[t]))return!0;return!1}if("function"==typeof fe.Buffer&&fe.Buffer.isBuffer&&fe.Buffer.isBuffer(e)||"function"==typeof fe.ArrayBuffer&&e instanceof ArrayBuffer||He&&e instanceof Blob||Fe&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return y(e.toJSON(),!0);for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&y(e[r]))return!0;return!1}function v(e,t){if(!e)return e;if(We(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Je(e)){for(var r=Array(e.length),o=0;e.length>o;o++)r[o]=v(e[o],t);return r}if("object"==typeof e&&!(e instanceof Date)){r={};for(var i in e)r[i]=v(e[i],t);return r}return e}function m(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Je(e))for(var n=0;e.length>n;n++)e[n]=m(e[n],t);else if("object"==typeof e)for(var r in e)e[r]=m(e[r],t);return e}function g(){}function b(e){for(var t=0;e.length>t;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function k(e,t){t=t||{};var n=new at;b(e);for(var r=0;e.length>r;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}function w(e,t){return b(e),new Blob(e,t||{})}function x(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}function E(e){var t="";do{t=mt[e%gt]+t,e=Math.floor(e/gt)}while(e>0);return t}function O(){var e=E(+new Date);return e!==dt?(kt=0,dt=e):e+"."+E(kt++)}function C(e){var t=e&&e.forceBase64;At&&!t||(this.supportsBinary=!1),ft.call(this,e)}function _(){}function A(e){if(_t.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,fe.location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!==fe.location.hostname||n!==e.port,this.xs=e.secure!==t}}function P(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function M(){for(var e in P.requests)P.requests.hasOwnProperty(e)&&P.requests[e].abort()}function D(){}function S(e){_t.call(this,e),this.query=this.query||{},St||(fe.___eio||(fe.___eio=[]),St=fe.___eio),this.index=St.length;var t=this;St.push(function(e){t.onData(e)}),this.query.j=this.index,fe.document&&fe.addEventListener&&fe.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=D)},!1)}function I(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=Lt&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(Ut=Nt),ft.call(this,e)}function T(e,t){if(!(this instanceof T))return new T(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=_e(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=_e(t.host).host),this.secure=null!=t.secure?t.secure:fe.location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(fe.location?location.hostname:"localhost"),this.port=t.port||(fe.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=yt.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode;var n="object"==typeof fe&&fe;n.global===n&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function B(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function N(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&1>=e.jitter?e.jitter:0,this.attempts=0}function j(e,t){if(!(this instanceof j))return new j(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new nn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||Qe;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}function R(e){var t=this,n=z();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),0>t.s0&&(t.s0+=1),t.s1-=n(e),0>t.s1&&(t.s1+=1),t.s2-=n(e),0>t.s2&&(t.s2+=1),n=null}function q(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function z(){var e=4022871197;return function(t){t=""+t;for(var n=0;t.length>n;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}function L(e,t){var n=new R(e),r=t&&t.state,o=n.next;return o.quick=o,r&&("object"==(void 0===r?"undefined":cn(r))&&q(r,n),o.state=function(){return q(n,{})}),o}function U(e){var t=e.game,n=e.numPlayers,r=e.multiplayer;n||(n=2);var o=t.flow.ctx(n);o._random={seed:t.seed};var i=new gn(o),s=i.attach(o),a={G:t.setup(s),ctx:o,log:[],_undo:[],_redo:[],_stateID:0,_initial:{}};a.ctx=i.update(a.ctx);var c=t.flow.init({G:a.G,ctx:a.ctx});a.G=c.G,a.ctx=c.ctx,a._undo=c._undo;return a._initial=function(e){return JSON.parse(JSON.stringify(e))}(a),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments[1];switch(n.type){case be:if(r)return e;var o=new gn(e.ctx),i=new bn(t.flow,n.payload.playerID);e=ln({},e,{ctx:o.attach(e.ctx)}),e=ln({},e,{ctx:i.attach(e.ctx)});var s=t.flow.processGameEvent(e,n.payload);s=i.update(s);var c=o.update(s.ctx);return c=gn.detach(c),c=bn.detach(c),ln({},s,{ctx:c,_stateID:e._stateID+1});case ge:if(!t.moveNames.includes(n.payload.type))return e;if(!t.flow.canMakeMove(e.G,e.ctx,n.payload))return e;var u=new gn(e.ctx),p=new bn(t.flow,n.payload.playerID),l=u.attach(e.ctx);l=p.attach(l);var h=t.processMove(e.G,n.payload,l);if(void 0===h)return e;var f=u.update(e.ctx);f=gn.detach(f),f=bn.detach(f),r&&!t.flow.optimisticUpdate(h,f,n.payload)&&(h=e.G);var d=[].concat(yn(e.log),[n]);return e=ln({},e,{G:h,ctx:f,log:d,_stateID:e._stateID+1}),r?e:(e=ln({},e,{ctx:u.attach(e.ctx)}),e=ln({},e,{ctx:p.attach(e.ctx)}),e=t.flow.processMove(e,n),e=ln({},e,{ctx:gn.detach(e.ctx)}),e=ln({},e,{ctx:bn.detach(e.ctx)}),e=ln({},e,{ctx:u.update(e.ctx)}),e=p.update(e));case ke:return n.state;default:return e}}}function G(e,t,n){var r={},o=!0,i=!1,s=void 0;try{for(var a,c=function(){var e=a.value;r[e]=function(){for(var r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];t.dispatch(xe(e,o,n))}},u=e[Symbol.iterator]();!(o=(a=u.next()).done);o=!0)c()}catch(e){i=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}return r}function H(e,t,n){var r={},o=!0,i=!1,s=void 0;try{for(var a,c=function(){var e=a.value;r[e]=function(){for(var r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];t.dispatch(we(e,o,n))}},u=e[Symbol.iterator]();!(o=(a=u.next()).done);o=!0)c()}catch(e){i=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}return r}function F(e){return new kn(e)}function X(e){return function(){return e}}function K(e,t,n){var r=(n||{}).playerID;if(null===r)return!0;if(void 0===r)return!0;var o=t.actionPlayers||[];return o.includes(r)||o.includes("any")}function J(e){var t=e.ctx,n=e.events,r=e.init,o=e.processMove,i=e.optimisticUpdate,s=e.canMakeMove;t||(t=function(){return{}}),n||(n={}),r||(r=function(e){return e}),o||(o=function(e){return e}),s||(s=K),void 0===i&&(i=function(){return!0});var a=function(e,t){if(n.hasOwnProperty(t.type)){var r={playerID:t.playerID},o=[e].concat(t.args),i=e.log||[],s=[].concat(yn(i),[t]),a=n[t.type].apply(r,o);return ln({},a,{log:s})}return e};return{ctx:t,init:r,eventNames:Object.getOwnPropertyNames(n),processMove:function(e,t){return o(e,t,a)},processGameEvent:function(e,t){return a(e,t)},optimisticUpdate:i,canMakeMove:function(e,t,n){return void 0===t.gameover&&s(e,t,n)}}}function W(e){function t(e,r,o){var i=e.G,s=e.ctx,a=v[s.phase];i=a.onPhaseEnd(i,s);var c=a.endGameIf(i,s);if(void 0!==c)return ln({},e,{G:i,ctx:ln({},s,{gameover:c})});if(r in v)s=ln({},s,{phase:r});else{var u=y.indexOf(s.phase);s=ln({},s,{phase:n[u=(u+1)%n.length].name})}if(e=C(ln({},e,{G:i,ctx:s}),v[s.phase]),o||(o=0),n.length-1>o){var p=(a=v[e.ctx.phase]).endPhaseIf(e.G,e.ctx);p&&(e=t(e,p,o+1))}return e}var n=e.phases,r=e.movesPerTurn,o=e.endTurnIf,i=e.endGameIf,s=e.onTurnBegin,a=e.onTurnEnd,c=e.onMove,u=e.turnOrder,p=e.endTurn,l=e.endPhase,h=e.undoableMoves,f=e.optimisticUpdate,d=e.canMakeMove;void 0===l&&n&&(l=!0),void 0===p&&(p=!0),void 0===f&&(f=function(){return!0}),n||(n=[{name:"default"}]),o||(o=function(){return!1}),i||(i=function(){}),s||(s=function(e){return e}),a||(a=function(e){return e}),c||(c=function(e){return e}),u||(u=Tn.DEFAULT);var y=[],v={},m=!0,g=!1,b=void 0;try{for(var k,w=n[Symbol.iterator]();!(m=(k=w.next()).done);m=!0){var x=k.value;y.push(x.name),v[x.name]=x,void 0===x.endPhaseIf&&(x.endPhaseIf=function(){return!1}),void 0===x.onPhaseBegin&&(x.onPhaseBegin=function(e){return e}),void 0===x.onPhaseEnd&&(x.onPhaseEnd=function(e){return e}),void 0===x.movesPerTurn&&(x.movesPerTurn=r),void 0===x.endTurnIf&&(x.endTurnIf=o),void 0===x.endGameIf&&(x.endGameIf=i),void 0===x.onTurnBegin&&(x.onTurnBegin=s),void 0===x.onTurnEnd&&(x.onTurnEnd=a),void 0===x.onMove&&(x.onMove=c),void 0===x.turnOrder&&(x.turnOrder=u)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}var E=function(e,t){var n=v[t.phase];return!(!n.movesPerTurn||n.movesPerTurn>t.currentPlayerMoves)||n.endTurnIf(e,t)},O=function(e,t){return void 0===t?"any":e[t]+""},C=function(e,t){var n=ln({},e.ctx),r=t.onPhaseBegin(e.G,n);return n.playOrderPos=t.turnOrder.first(r,n),n.currentPlayer=O(n.playOrder,n.playOrderPos),n.actionPlayers=[n.currentPlayer],ln({},e,{G:r,ctx:n})},_=function(e,t){var n=ln({},e.ctx),r=t.onTurnBegin(e.G,n);return n=gn.detach(n),n=bn.detach(n),ln({},e,{G:r,ctx:n,_undo:[{G:r,ctx:n}],_redo:[]})},A=function(e,t){return e=C(e,t),e=_(e,t)},P={};return(void 0===h||h.length>0)&&(P.undo=function(e){var t=e._undo,n=e._redo;if(2>t.length)return e;var r=t[t.length-1],o=t[t.length-2];return h&&!h.includes(r.moveType)?e:ln({},e,{G:o.G,ctx:o.ctx,_undo:t.slice(0,t.length-1),_redo:[r].concat(yn(n))})},P.redo=function(e){var t=e._undo,n=e._redo;if(0==n.length)return e;var r=n[0];return ln({},e,{G:r.G,ctx:r.ctx,_undo:[].concat(yn(t),[r]),_redo:n.slice(1)})}),p&&(P.endTurn=function(e){var n=e.G,r=e.ctx,o=v[r.phase];if(o.movesPerTurn&&o.movesPerTurn>r.currentPlayerMoves)return e;n=o.onTurnEnd(n,r);var i=o.endGameIf(n,r);if(void 0!==i)return ln({},e,{G:n,ctx:ln({},r,{gameover:i})});var s=o.turnOrder.next(n,r),a=O(r.playOrder,s);r=ln({},r,{playOrderPos:s,currentPlayer:a,actionPlayers:[a],turn:r.turn+1,currentPlayerMoves:0});var c=o.endPhaseIf(n,r);return c?t(ln({},e,{G:n,ctx:r}),c):_(ln({},e,{G:n,ctx:r}),o)}),l&&(P.endPhase=t),J({ctx:function(e){return{numPlayers:e,turn:0,currentPlayer:"0",currentPlayerMoves:0,playOrder:Array.from(Array(e),function(e,t){return t}),playOrderPos:0,phase:n[0].name}},init:function(e){return A(e,n[0])},optimisticUpdate:function(e,t,n){return(void 0===t._random||void 0===t._random.prngstate)&&f(e,t,n)},events:P,processMove:function(e,t,n){var r=v[e.ctx.phase],o=e.ctx.currentPlayerMoves+1;e=ln({},e,{ctx:ln({},e.ctx,{currentPlayerMoves:o})});var i=r.onMove(e.G,e.ctx,t);e=ln({},e,{G:i});var s=r.endGameIf(e.G,e.ctx),a=E(e.G,e.ctx);(a||void 0!==s)&&(e=n(e,{type:"endTurn",playerID:t.playerID}));var c=r.endPhaseIf(e.G,e.ctx);if((c||void 0!==s)&&(e=n(e,{type:"endPhase",args:[c],playerID:t.playerID})),void 0!==s)return ln({},e,{ctx:ln({},e.ctx,{gameover:s})});if(!a){var u=e._undo||[],p=t.payload.type;e=ln({},e,{_undo:[].concat(yn(u),[{G:e.G,ctx:e.ctx,moveType:p}]),_redo:[]})}return e},canMakeMove:function(e,t,n){var r=v[t.phase]||{};return!(r.allowedMoves&&!new Set(r.allowedMoves).has(n.type))&&!(void 0!==d&&!d(e,t,n))&&K(e,t,n)}})}e=e&&e.hasOwnProperty("default")?e.default:e;var V="object"==typeof global&&global&&global.Object===Object&&global,Y="object"==typeof self&&self&&self.Object===Object&&self,$=(V||Y||Function("return this")()).Symbol,Z=Object.prototype,Q=Z.hasOwnProperty,ee=Z.toString,te=$?$.toStringTag:void 0,ne=Object.prototype.toString,re="[object Null]",oe="[object Undefined]",ie=$?$.toStringTag:void 0,se=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),ae="[object Object]",ce=Function.prototype,ue=Object.prototype,pe=ce.toString,le=ue.hasOwnProperty,he=pe.call(Object),fe="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},de=a(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}}),ye=a(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(e){return e&&e.__esModule?e:{default:e}}(de);n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==fe?fe:e;var o=(0,r.default)(n);t.default=o}),ve={INIT:"@@redux/INIT"},me=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ge="MAKE_MOVE",be="GAME_EVENT",ke="RESTORE",we=function(e,t,n){return{type:ge,payload:{type:e,args:t,playerID:n}}},xe=function(e,t,n){return{type:be,payload:{type:e,args:t,playerID:n}}},Ee=function(e){return{type:ke,state:e}},Oe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ce=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],_e=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=Oe.exec(e||""),i={},s=14;s--;)i[Ce[s]]=o[s]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i},Ae=1e3,Pe=60*Ae,Me=60*Pe,De=24*Me,Se=365.25*De,Ie=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return l(e);if("number"===n&&!1===isNaN(e))return t.long?f(e):h(e);throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},Te=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,i=n-(o||n);e.diff=i,e.prev=o,e.curr=n,o=n;for(var s=Array(arguments.length),a=0;s.length>a;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=s[c];n=o.call(e,i),s.splice(c,1),c--}return n}),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,o=0;r>o;o++)n[o]&&("-"===(e=n[o].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Ie,t.names=[],t.skips=[],t.formatters={};var o}),Be=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=Te).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),Ne=Be("socket.io-client:url"),je=function(e,t){var n=e;t=t||fe.location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(Ne("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),Ne("parse %s",e),n=_e(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n},Re=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,i=n-(o||n);e.diff=i,e.prev=o,e.curr=n,o=n;for(var s=Array(arguments.length),a=0;s.length>a;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=s[c];n=o.call(e,i),s.splice(c,1),c--}return n}),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,o=0;r>o;o++)n[o]&&("-"===(e=n[o].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Ie,t.names=[],t.skips=[],t.formatters={};var o}),qe=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=Re).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),ze=a(function(e){function t(e){if(e)return n(e)}function n(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;n.length>o;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;o>r;++r)n[r].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),Le={}.toString,Ue=Array.isArray||function(e){return"[object Array]"==Le.call(e)},Ge=Object.prototype.toString,He="function"==typeof fe.Blob||"[object BlobConstructor]"===Ge.call(fe.Blob),Fe="function"==typeof fe.File||"[object FileConstructor]"===Ge.call(fe.File),Xe=y,Ke={}.toString,Je=Array.isArray||function(e){return"[object Array]"==Ke.call(e)},We=function(e){return fe.Buffer&&fe.Buffer.isBuffer(e)||fe.ArrayBuffer&&e instanceof ArrayBuffer},Ve=Object.prototype.toString,Ye="function"==typeof fe.Blob||"[object BlobConstructor]"===Ve.call(fe.Blob),$e="function"==typeof fe.File||"[object FileConstructor]"===Ve.call(fe.File),Ze={deconstructPacket:function(e){var t=[],n=e.data,r=e;return r.data=v(n,t),r.attachments=t.length,{packet:r,buffers:t}},reconstructPacket:function(e,t){return e.data=m(e.data,t),e.attachments=void 0,e},removeBlobs:function(e,t){function n(e,i,s){if(!e)return e;if(Ye&&e instanceof Blob||$e&&e instanceof File){r++;var a=new FileReader;a.onload=function(){s?s[i]=this.result:o=this.result,--r||t(o)},a.readAsArrayBuffer(e)}else if(Je(e))for(var c=0;e.length>c;c++)n(e[c],c,e);else if("object"==typeof e&&!We(e))for(var u in e)n(e[u],u,e)}var r=0,o=e;n(o),r||t(o)}},Qe=a(function(e,t){function n(){}function r(e){var n=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data&&(n+=JSON.stringify(e.data)),p("encoded %j as %s",e,n),n}function o(e,t){Ze.removeBlobs(e,function(e){var n=Ze.deconstructPacket(e),o=r(n.packet),i=n.buffers;i.unshift(o),t(i)})}function i(){this.reconstructor=null}function s(e){var n=0,r={type:+e.charAt(0)};if(null==t.types[r.type])return u();if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=+o||"-"!==e.charAt(n))throw Error("Illegal attachments");r.attachments=+o}if("/"===e.charAt(n+1))for(r.nsp="";++n&&","!==(s=e.charAt(n))&&(r.nsp+=s,n!==e.length););else r.nsp="/";var i=e.charAt(n+1);if(""!==i&&+i==i){for(r.id="";++n;){var s=e.charAt(n);if(null==s||+s!=s){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=+r.id}return e.charAt(++n)&&(r=a(r,e.substr(n))),p("decoded %s as %j",e,r),r}function a(e,t){try{e.data=JSON.parse(t)}catch(e){return u()}return e}function c(e){this.reconPack=e,this.buffers=[]}function u(){return{type:t.ERROR,data:"parser error"}}var p=qe("socket.io-parser");t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=i,n.prototype.encode=function(e,n){e.type!==t.EVENT&&e.type!==t.ACK||!Xe(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),p("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?o(e,n):n([r(e)])},ze(i.prototype),i.prototype.add=function(e){var n;if("string"==typeof e)n=s(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new c(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!We(e)&&!e.base64)throw Error("Unknown type: "+e);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},i.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Ze.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}}),et=a(function(e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}}),tt=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||et))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(fe[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}},nt=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},rt=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(0>t&&(t+=r),0>n&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;n>s;s++,a++)i[a]=o[s];return i.buffer},ot=function(e,t,n){function r(e,i){if(0>=r.count)throw Error("after called too many times");--r.count,e?(o=!0,t(e),t=n):0!==r.count||o||t(null,i)}var o=!1;return n=n||g,r.count=e,0===e?t():r},it=a(function(e,t){!function(n){function r(e){for(var t,n,r=[],o=0,i=e.length;i>o;)55296>(t=e.charCodeAt(o++))||t>56319||o>=i?r.push(t):56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--);return r}function o(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=v((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=v(t);return o}function i(e,t){if(e>=55296&&57343>=e){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(e,t){return v(e>>t&63|128)}function a(e,t){if(0==(4294967168&e))return v(e);var n="";return 0==(4294965248&e)?n=v(e>>6&31|192):0==(4294901760&e)?(i(e,t)||(e=65533),n=v(e>>12&15|224),n+=s(e,6)):0==(4292870144&e)&&(n=v(e>>18&7|240),n+=s(e,12),n+=s(e,6)),n+=v(63&e|128)}function c(){if(y>=d)throw Error("Invalid byte index");var e=255&f[y];if(y++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var t,n,r,o,s;if(y>d)throw Error("Invalid byte index");if(y==d)return!1;if(t=255&f[y],y++,0==(128&t))return t;if(192==(224&t)){if(n=c(),128>(s=(31&t)<<6|n))throw Error("Invalid continuation byte");return s}if(224==(240&t)){if(n=c(),r=c(),2048>(s=(15&t)<<12|n<<6|r))throw Error("Invalid continuation byte");return i(s,e)?s:65533}if(240==(248&t)&&(n=c(),r=c(),o=c(),(s=(7&t)<<18|n<<12|r<<6|o)>=65536&&1114111>=s))return s;throw Error("Invalid UTF-8 detected")}var p=t,l=e&&e.exports==p&&e,h="object"==typeof fe&&fe;h.global!==h&&h.window!==h||(n=h);var f,d,y,v=String.fromCharCode,m={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,o=r(e),i=o.length,s=-1,c="";++s<i;)c+=a(o[s],n);return c},decode:function(e,t){var n=!1!==(t=t||{}).strict;f=r(e),d=f.length,y=0;for(var i,s=[];!1!==(i=u(n));)s.push(i);return o(s)}};if(p&&!p.nodeType)if(l)l.exports=m;else{var g={}.hasOwnProperty;for(var b in m)g.call(m,b)&&(p[b]=m[b])}else n.utf8=m}(fe)}),st=a(function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;64>r;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;o>n;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,s,a=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var p=new ArrayBuffer(a),l=new Uint8Array(p);for(t=0;c>t;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],l[u++]=r<<2|o>>4,l[u++]=(15&o)<<4|i>>2,l[u++]=(3&i)<<6|63&s;return p}}()}),at=fe.BlobBuilder||fe.WebKitBlobBuilder||fe.MSBlobBuilder||fe.MozBlobBuilder,ct=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),ut=ct&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),pt=at&&at.prototype.append&&at.prototype.getBlob,lt=ct?ut?fe.Blob:w:pt?k:void 0,ht=a(function(e,t){function n(e,n){return n("b"+t.packets[e.type]+e.data.data)}function r(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=h[e.type];for(var a=0;i.length>a;a++)s[a+1]=i[a];return r(s.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,t.encodePacket(e,n,!0,r)},o.readAsArrayBuffer(e.data)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return o(e,n,r);var i=new Uint8Array(1);return i[0]=h[e.type],r(new lt([i.buffer,e.data]))}function s(e){try{e=it.decode(e,{strict:!1})}catch(e){return!1}return e}function a(e,t,n){for(var r=Array(e.length),o=ot(e.length,n),i=0;e.length>i;i++)!function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})}(i,e[i],o)}var c;fe&&fe.ArrayBuffer&&(c=st);var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||p;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=nt(h),d={type:"error",data:"parser error"};t.encodePacket=function(e,t,o,s){"function"==typeof t&&(s=t,t=!1),"function"==typeof o&&(s=o,o=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if(fe.ArrayBuffer&&a instanceof ArrayBuffer)return r(e,t,s);if(lt&&a instanceof fe.Blob)return i(e,t,s);if(a&&a.base64)return n(e,s);var c=h[e.type];return void 0!==e.data&&(c+=o?it.encode(e.data+"",{strict:!1}):e.data+""),s(""+c)},t.encodeBase64Packet=function(e,n){var r="b"+t.packets[e.type];if(lt&&e.data instanceof fe.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(r+e)},o.readAsDataURL(e.data)}var i;try{i=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=Array(s.length),c=0;s.length>c;c++)a[c]=s[c];i=String.fromCharCode.apply(null,a)}return r+=fe.btoa(i),n(r)},t.decodePacket=function(e,n,r){if(void 0===e)return d;if("string"==typeof e)return"b"===e.charAt(0)?t.decodeBase64Packet(e.substr(1),n):r&&!1===(e=s(e))?d:+(o=e.charAt(0))==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:d;var o=new Uint8Array(e)[0],i=rt(e,1);return lt&&"blob"===n&&(i=new lt([i])),{type:f[o],data:i}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!c)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=c.decode(e.substr(1));return"blob"===t&&lt&&(r=new lt([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){function o(e){return e.length+":"+e}"function"==typeof n&&(r=n,n=null);var i=Xe(e);return n&&i?lt&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void a(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,o(e))})},function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var o;if(""===e)return r(d,0,1);for(var i,s,a="",c=0,u=e.length;u>c;c++){var p=e.charAt(c);if(":"===p){if(""===a||a!=(i=+a))return r(d,0,1);if(s=e.substr(c+1,i),a!=s.length)return r(d,0,1);if(s.length){if(o=t.decodePacket(s,n,!1),d.type===o.type&&d.data===o.data)return r(d,0,1);if(!1===r(o,c+i,u))return}c+=i,a=""}else a+=p}return""!==a?r(d,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));a(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+(""+n).length+n+2},0),o=new Uint8Array(r),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;e.length>s;s++)r[s]=e.charCodeAt(s);n=r.buffer}o[i++]=t?0:1;for(var a=""+n.byteLength,s=0;a.length>s;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var r=new Uint8Array(n),s=0;r.length>s;s++)o[i++]=r[s]}),n(o.buffer)})},t.encodePayloadAsBlob=function(e,n){a(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;e.length>o;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}for(var i=""+(e instanceof ArrayBuffer?e.byteLength:e.size),s=new Uint8Array(i.length+1),o=0;i.length>o;o++)s[o]=parseInt(i[o]);if(s[i.length]=255,lt){var a=new lt([t.buffer,s.buffer,e]);n(null,a)}})},function(e,t){return n(new lt(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),a=0===s[0],c="",u=1;255!==s[u];u++){if(c.length>310)return r(d,0,1);c+=s[u]}o=rt(o,2+c.length);var p=rt(o,0,c=parseInt(c));if(a)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(e){var l=new Uint8Array(p);p="";for(u=0;l.length>u;u++)p+=String.fromCharCode(l[u])}i.push(p),o=rt(o,c)}var h=i.length;i.forEach(function(e,o){r(t.decodePacket(e,n,!0),o,h)})}}),ft=x;ze(x.prototype),x.prototype.onError=function(e,t){var n=Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},x.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},x.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},x.prototype.send=function(e){if("open"!==this.readyState)throw Error("Transport not open");this.write(e)},x.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},x.prototype.onData=function(e){var t=ht.decodePacket(e,this.socket.binaryType);this.onPacket(t)},x.prototype.onPacket=function(e){this.emit("packet",e)},x.prototype.onClose=function(){this.readyState="closed",this.emit("close")};for(var dt,yt={encode:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},decode:function(e){for(var t={},n=e.split("&"),r=0,o=n.length;o>r;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},vt=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},mt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),gt=64,bt={},kt=0,wt=0;gt>wt;wt++)bt[mt[wt]]=wt;O.encode=E,O.decode=function(e){var t=0;for(wt=0;e.length>wt;wt++)t=t*gt+bt[e.charAt(wt)];return t};var xt=O,Et=a(function(e,t){function n(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function r(e){function r(){if(r.enabled){var e=r,n=+new Date,i=n-(o||n);e.diff=i,e.prev=o,e.curr=n,o=n;for(var s=Array(arguments.length),a=0;s.length>a;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=s[c];n=o.call(e,i),s.splice(c,1),c--}return n}),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,o=0;r>o;o++)n[o]&&("-"===(e=n[o].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Ie,t.names=[],t.skips=[],t.formatters={};var o}),Ot=a(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=Et).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}),Ct=Ot("engine.io-client:polling"),_t=C,At=null!=new tt({xdomain:!1}).responseType;vt(C,ft),C.prototype.name="polling",C.prototype.doOpen=function(){this.poll()},C.prototype.pause=function(e){function t(){Ct("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(Ct("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){Ct("pre-pause polling complete"),--r||t()})),this.writable||(Ct("we are currently writing - waiting to pause"),r++,this.once("drain",function(){Ct("pre-pause writing complete"),--r||t()}))}else t()},C.prototype.poll=function(){Ct("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},C.prototype.onData=function(e){var t=this;Ct("polling got data %s",e);ht.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():Ct('ignoring poll - transport state "%s"',this.readyState))},C.prototype.doClose=function(){function e(){Ct("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(Ct("transport open - closing"),e()):(Ct("transport not open - deferring close"),this.once("open",e))},C.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};ht.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},C.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=xt()),this.supportsBinary||e.sid||(e.b64=1),e=yt.encode(e),this.port&&("https"===t&&443!=+this.port||"http"===t&&80!=+this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var Pt=Ot("engine.io-client:polling-xhr"),Mt=A,Dt=P;vt(A,_t),A.prototype.supportsBinary=!0,A.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new P(e)},A.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},A.prototype.doPoll=function(){Pt("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},ze(P.prototype),P.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new tt(e),n=this;try{Pt("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var r in this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState){var e;try{e=t.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(t.responseType="arraybuffer")}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},Pt("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}fe.document&&(this.index=P.requestsCount++,P.requests[this.index]=this)},P.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},P.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},P.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},P.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=_:this.xhr.onreadystatechange=_,e)try{this.xhr.abort()}catch(e){}fe.document&&delete P.requests[this.index],this.xhr=null}},P.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},P.prototype.hasXDR=function(){return void 0!==fe.XDomainRequest&&!this.xs&&this.enablesXDR},P.prototype.abort=function(){this.cleanup()},P.requestsCount=0,P.requests={},fe.document&&(fe.attachEvent?fe.attachEvent("onunload",M):fe.addEventListener&&fe.addEventListener("beforeunload",M,!1)),Mt.Request=Dt;var St,It=S,Tt=/\n/g,Bt=/\\n/g;vt(S,_t),S.prototype.supportsBinary=!1,S.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),_t.prototype.doClose.call(this)},S.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},S.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),e=e.replace(Bt,"\\\n"),this.area.value=e.replace(Tt,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n};var Nt,jt={},Rt=Object.freeze({default:jt}),qt=Rt&&jt||Rt,zt=Ot("engine.io-client:websocket"),Lt=fe.WebSocket||fe.MozWebSocket;if("undefined"==typeof window)try{Nt=qt}catch(e){}var Ut=Lt;Ut||"undefined"!=typeof window||(Ut=Nt);var Gt=I;vt(I,ft),I.prototype.name="websocket",I.prototype.supportsBinary=!0,I.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new Ut(e,t):new Ut(e):new Ut(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},I.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},I.prototype.write=function(e){function t(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var r=e.length,o=0,i=r;i>o;o++)!function(e){ht.encodePacket(e,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),n.perMessageDeflate){var s="string"==typeof o?fe.Buffer.byteLength(o):o.length;n.perMessageDeflate.threshold>s&&(i.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,i)}catch(e){zt("websocket closed before onclose event")}--r||t()})}(e[o])},I.prototype.onClose=function(){ft.prototype.onClose.call(this)},I.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},I.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!=+this.port||"ws"===t&&80!=+this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=xt()),this.supportsBinary||(e.b64=1),(e=yt.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},I.prototype.check=function(){return!(!Ut||"__initialize"in Ut&&this.name===I.prototype.name)};var Ht={polling:function(e){var t=!1,n=!1,r=!1!==e.jsonp;if(fe.location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,n=e.secure!==o}if(e.xdomain=t,e.xscheme=n,"open"in new tt(e)&&!e.forceJSONP)return new Mt(e);if(!r)throw Error("JSONP disabled");return new It(e)},websocket:Gt},Ft=[].indexOf,Xt=function(e,t){if(Ft)return e.indexOf(t);for(var n=0;e.length>n;++n)if(e[n]===t)return n;return-1},Kt=Ot("engine.io-client:socket"),Jt=T;T.priorWebsocketSuccess=!1,ze(T.prototype),T.protocol=ht.protocol,T.Socket=T,T.Transport=ft,T.transports=Ht,T.parser=ht,T.prototype.createTransport=function(e){Kt('creating transport "%s"',e);var t=B(this.query);t.EIO=ht.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new Ht[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},T.prototype.open=function(){var e;if(this.rememberUpgrade&&T.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},T.prototype.setTransport=function(e){Kt("setting transport %s",e.name);var t=this;this.transport&&(Kt("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},T.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;u=u||t}u||(Kt('probe transport "%s" opened',e),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){if(!u)if("pong"===t.type&&"probe"===t.data){if(Kt('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",c),!c)return;T.priorWebsocketSuccess="websocket"===c.name,Kt('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){u||"closed"!==p.readyState&&(Kt("changing transport and sending upgrade packet"),a(),p.setTransport(c),c.send([{type:"upgrade"}]),p.emit("upgrade",c),c=null,p.upgrading=!1,p.flush())})}else{Kt('probe transport "%s" failed',e);var n=Error("probe error");n.transport=c.name,p.emit("upgradeError",n)}}))}function n(){u||(u=!0,a(),c.close(),c=null)}function r(t){var r=Error("probe error: "+t);r.transport=c.name,n(),Kt('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function o(){r("transport closed")}function i(){r("socket closed")}function s(e){c&&e.name!==c.name&&(Kt('"%s" works - aborting "%s"',e.name,c.name),n())}function a(){c.removeListener("open",t),c.removeListener("error",r),c.removeListener("close",o),p.removeListener("close",i),p.removeListener("upgrading",s)}Kt('probing transport "%s"',e);var c=this.createTransport(e,{probe:1}),u=!1,p=this;T.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",r),c.once("close",o),this.once("close",i),this.once("upgrading",s),c.open()},T.prototype.onOpen=function(){if(Kt("socket open"),this.readyState="open",T.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){Kt("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},T.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(Kt('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else Kt('packet received with socket readyState "%s"',this.readyState)},T.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},T.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},T.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){Kt("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},T.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},T.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},T.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(Kt("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},T.prototype.write=T.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},T.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},T.prototype.close=function(){function e(){r.onClose("forced close"),Kt("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},T.prototype.onError=function(e){Kt("socket error %j",e),T.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},T.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){Kt('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},T.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;r>n;n++)~Xt(this.transports,e[n])&&t.push(e[n]);return t};var Wt=Jt,Vt=ht;Wt.parser=Vt;var Yt=Wt,$t=function(e,t){for(var n=[],r=(t=t||0)||0;e.length>r;r++)n[r-t]=e[r];return n},Zt=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}},Qt=[].slice,en=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw Error("bind() requires a function");var n=Qt.call(arguments,2);return function(){return t.apply(e,n.concat(Qt.call(arguments)))}},tn=a(function(e,t){function n(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var r=Be("socket.io-client:socket");e.exports=n;var o={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},i=ze.prototype.emit;ze(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[Zt(e,"open",en(this,"onopen")),Zt(e,"packet",en(this,"onpacket")),Zt(e,"close",en(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var e=$t(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(o.hasOwnProperty(e))return i.apply(this,arguments),this;var t=$t(arguments),n={type:Qe.EVENT,data:t};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(r("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if(r("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?yt.encode(this.query):this.query;r("sending connect packet with query %s",e),this.packet({type:Qe.CONNECT,query:e})}else this.packet({type:Qe.CONNECT})},n.prototype.onclose=function(e){r("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case Qe.CONNECT:this.onconnect();break;case Qe.EVENT:case Qe.BINARY_EVENT:this.onevent(e);break;case Qe.ACK:case Qe.BINARY_ACK:this.onack(e);break;case Qe.DISCONNECT:this.ondisconnect();break;case Qe.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];r("emitting event %j",t),null!=e.id&&(r("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?i.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=$t(arguments);r("sending ack %j",o),t.packet({type:Qe.ACK,id:e,data:o})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(r("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):r("bad ack %s",e.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;this.receiveBuffer.length>e;e++)i.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;this.sendBuffer.length>e;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){r("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;this.subs.length>e;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:Qe.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}}),nn=N;N.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},N.prototype.reset=function(){this.attempts=0},N.prototype.setMin=function(e){this.ms=e},N.prototype.setMax=function(e){this.max=e},N.prototype.setJitter=function(e){this.jitter=e};var rn=Be("socket.io-client:manager"),on=Object.prototype.hasOwnProperty,sn=j;j.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)on.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},j.prototype.updateSocketIds=function(){for(var e in this.nsps)on.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},j.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},ze(j.prototype),j.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},j.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},j.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},j.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},j.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},j.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},j.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},j.prototype.open=j.prototype.connect=function(e,t){if(rn("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;rn("opening %s",this.uri),this.engine=Yt(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=Zt(n,"open",function(){r.onopen(),e&&e()}),i=Zt(n,"error",function(t){if(rn("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;rn("connect attempt will timeout after %d",s);var a=setTimeout(function(){rn("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(o),this.subs.push(i),this},j.prototype.onopen=function(){rn("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(Zt(e,"data",en(this,"ondata"))),this.subs.push(Zt(e,"ping",en(this,"onping"))),this.subs.push(Zt(e,"pong",en(this,"onpong"))),this.subs.push(Zt(e,"error",en(this,"onerror"))),this.subs.push(Zt(e,"close",en(this,"onclose"))),this.subs.push(Zt(this.decoder,"decoded",en(this,"ondecoded")))},j.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},j.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},j.prototype.ondata=function(e){this.decoder.add(e)},j.prototype.ondecoded=function(e){this.emit("packet",e)},j.prototype.onerror=function(e){rn("error",e),this.emitAll("error",e)},j.prototype.socket=function(e,t){function n(){~Xt(o.connecting,r)||o.connecting.push(r)}var r=this.nsps[e];if(!r){r=new tn(this,e,t),this.nsps[e]=r;var o=this;r.on("connecting",n),r.on("connect",function(){r.id=o.generateId(e)}),this.autoConnect&&n()}return r},j.prototype.destroy=function(e){var t=Xt(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},j.prototype.packet=function(e){rn("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;n.length>r;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},j.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},j.prototype.cleanup=function(){rn("cleanup");for(var e=this.subs.length,t=0;e>t;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},j.prototype.close=j.prototype.disconnect=function(){rn("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},j.prototype.onclose=function(e){rn("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},j.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts<this._reconnectionAttempts){var t=this.backoff.duration();rn("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(rn("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(rn("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(rn("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}else rn("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1},j.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var an=a(function(e,t){function n(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=je(e),s=i.source,a=i.id,c=i.path,u=o[a]&&c in o[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(r("ignoring socket cache for %s",s),n=sn(s,t)):(o[a]||(r("new io instance for %s",s),o[a]=sn(s,t)),n=o[a]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}var r=Be("socket.io-client");e.exports=t=n;var o=t.managers={};t.protocol=Qe.protocol,t.connect=n,t.Manager=sn,t.Socket=tn}),cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un=(function(){function e(e){this.value=e}function t(t){function n(o,i){try{var s=t[o](i),a=s.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(s.done?"return":"normal",s.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,t){return new Promise(function(r,s){var a={key:e,arg:t,resolve:r,reject:s,next:null};i?i=i.next=a:(o=i=a,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),pn=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ln=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hn=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},fn=function(e,t){var n={};for(var r in e)0>t.indexOf(r)&&Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},dn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},yn=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return Array.from(e)},vn=new Set([ge,be]),mn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.socket,r=t.gameID,o=t.playerID,i=t.gameName,s=t.numPlayers,a=t.server;un(this,e),this.server=a,this.socket=n,this.gameName=i||"default",this.gameID=r||"default",this.playerID=o||null,this.numPlayers=s||2,this.gameID=this.gameName+":"+this.gameID,this.isConnected=!1,this.callback=function(){}}return pn(e,[{key:"createStore",value:function(e,t){var n=this;this.store=null;var r=p(function(e){var t=e.getState;return function(e){return function(r){var o=t(),i=e(r);return vn.has(r.type)&&1!=r._remote&&n.socket.emit("action",r,o._stateID,n.gameID,n.playerID),i}}});return t=t?u(t,r):r,this.store=c(e,t),this.store}},{key:"connect",value:function(){var e=this;this.socket||(this.socket=an(this.server?"http://"+this.server+"/"+this.gameName:"/"+this.gameName)),this.socket.on("sync",function(t,n){if(t==e.gameID&&n._stateID>=e.store.getState()._stateID){var r=Ee(n);r._remote=!0,e.store.dispatch(r)}}),this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers),this.socket.on("connect",function(){e.isConnected=!0,e.callback()}),this.socket.on("disconnect",function(){e.isConnected=!1,e.callback()})}},{key:"subscribe",value:function(e){this.callback=e}},{key:"updateGameID",value:function(e){this.gameID=this.gameName+":"+e,this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}}]),e}(),gn=function(){function e(t){un(this,e),this.state=t._random||{seed:"0"}}return pn(e,[{key:"update",value:function(t){return e.detach(ln({},t,{_random:this.state}))}},{key:"attach",value:function(e){return ln({},e,{random:this._api()})}},{key:"_random",value:function(){var e=this.state,t=void 0,n=(t=void 0===e.prngstate?new L(e.seed,{state:!0}):new L("",{state:e.prngstate}))();return this.state=ln({},e,{prngstate:t.state()}),n}},{key:"_api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={};for(var r in t)!function(r){var o=t[r];n[r]=function(t){return void 0===t?Math.floor(e()*o)+1:[].concat(yn(Array(t).keys())).map(function(){return Math.floor(e()*o)+1})}}(r);return ln({},n,{Die:function(t,n){return void 0===t&&(t=6),void 0===n?Math.floor(e()*t)+1:[].concat(yn(Array(n).keys())).map(function(){return Math.floor(e()*t)+1})},Number:function(){return e()},Shuffle:function(t){for(var n=t.slice(0),r=t.length,o=0,i=Array(r);r;){var s=r*e()|0;i[o++]=n[s],n[s]=n[--r]}return i}})}}]),e}();gn.detach=function(e){return fn(e,["random"])},gn.seed=function(){return(+new Date).toString(36).slice(-10)};var bn=function(){function e(t,n){un(this,e),this.flow=t,this.playerID=n,this.dispatch=[]}return pn(e,[{key:"attach",value:function(e){var t=this,n={},r=!0,o=!1,i=void 0;try{for(var s,a=function(){var e=s.value;n[e]=function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];t.dispatch.push({key:e,args:r})}},c=this.flow.eventNames[Symbol.iterator]();!(r=(s=c.next()).done);r=!0)a()}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return ln({},e,{events:n})}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.dispatch[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value,a=xe(s.key,s.args,this.playerID);e=this.flow.processGameEvent(e,a.payload)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e}}]),e}();bn.detach=function(e){return fn(e,["events"])},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.client {\n  overflow: auto;\n}\n",void 0);var kn=function(){function e(t){var n=t.game,r=t.numPlayers,o=t.multiplayer,i=t.gameID,s=t.playerID,a=t.enhancer;un(this,e),this.game=n,this.playerID=s,this.gameID=i;var u=void 0;o instanceof Object&&"server"in o&&(u=o.server,o=!0),this.multiplayer=o;var p=U({game:n,numPlayers:r,multiplayer:o});this.store=null,o?(this.multiplayerClient=new mn({gameID:i,playerID:s,gameName:n.name,numPlayers:r,server:u}),this.store=this.multiplayerClient.createStore(p,a)):(this.store=c(p,a),null===this.playerID&&(this.playerID=void 0)),this.createDispatchers()}return pn(e,[{key:"subscribe",value:function(e){this.store.subscribe(e),this.multiplayerClient&&this.multiplayerClient.subscribe(e)}},{key:"getState",value:function(){var e=this.store.getState(),t=!0;this.multiplayer&&(null==this.playerID&&(t=!1),this.game.flow.canMakeMove(e.G,e.ctx,{playerID:this.playerID})||(t=!1));var n=this.playerID;this.multiplayer||n||"any"==e.ctx.currentPlayer||(n=e.ctx.currentPlayer);var r=this.game.playerView(e.G,e.ctx,n);void 0!==e.ctx.gameover&&(t=!1);var o=ln({},e,{isActive:t,G:r});return this.multiplayerClient&&(o=ln({},o,{isConnected:this.multiplayerClient.isConnected})),o}},{key:"connect",value:function(){this.multiplayerClient&&this.multiplayerClient.connect()}},{key:"createDispatchers",value:function(){this.moves=H(this.game.moveNames,this.store,this.playerID),this.events=G(this.game.flow.eventNames,this.store,this.playerID)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.createDispatchers(),this.multiplayerClient&&this.multiplayerClient.updatePlayerID(e)}},{key:"updateGameID",value:function(e){this.gameID=e,this.createDispatchers(),this.multiplayerClient&&this.multiplayerClient.updateGameID(e)}}]),e}(),wn=function(){};wn.thatReturns=X,wn.thatReturnsFalse=X(!1),wn.thatReturnsTrue=X(!0),wn.thatReturnsNull=X(null),wn.thatReturnsThis=function(){return this},wn.thatReturnsArgument=function(e){return e};var xn=wn,En=function(e,t,n,r,o,i,s,a){if(!e){var c;if(void 0===t)c=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,i,s,a],p=0;(c=Error(t.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},On="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Cn=function(){function e(e,t,n,r,o,i){i!==On&&En(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return n.checkPropTypes=xn,n.PropTypes=n,n},_n=a(function(e){e.exports=Cn()}),An=a(function(e){!function(t,n,r){function o(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return g[e.which]?g[e.which]:b[e.which]?b[e.which]:String.fromCharCode(e.which).toLowerCase()}function s(e,t){return e.sort().join(",")===t.sort().join(",")}function a(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function c(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function u(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function p(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function l(){if(!m){m={};for(var e in g)e>95&&112>e||g.hasOwnProperty(e)&&(m[g[e]]=e)}return m}function h(e,t,n){return n||(n=l()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function f(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}function d(e,t){var n,r,o,i=[];for(n=f(e),o=0;n.length>o;++o)w[r=n[o]]&&(r=w[r]),t&&"keypress"!=t&&k[r]&&(r=k[r],i.push("shift")),p(r)&&i.push(r);return t=h(r,i,t),{key:r,modifiers:i,action:t}}function y(e,t){return null!==e&&e!==n&&(e===t||y(e.parentNode,t))}function v(e){function t(e){e=e||{};var t,n=!1;for(t in k)e[t]?n=!0:k[t]=0;n||(E=!1)}function r(e,t,n,r,o,i){var a,c,u=[],l=n.type;if(!g._callbacks[e])return[];for("keyup"==l&&p(e)&&(t=[e]),a=0;g._callbacks[e].length>a;++a)if(c=g._callbacks[e][a],(r||!c.seq||k[c.seq]==c.level)&&l==c.action&&("keypress"==l&&!n.metaKey&&!n.ctrlKey||s(t,c.modifiers))){var h=!r&&c.combo==o,f=r&&c.seq==r&&c.level==i;(h||f)&&g._callbacks[e].splice(a,1),u.push(c)}return u}function l(e,t,n,r){g.stopCallback(t,t.target||t.srcElement,n,r)||!1===e(t,n)&&(c(t),u(t))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"!=e.type||w!==t?g.handleKey(t,a(e),e):w=!1)}function f(){clearTimeout(b),b=setTimeout(t,1e3)}function y(e,n,r,o){k[e]=0;for(var s=0;n.length>s;++s){var a=s+1===n.length?function(n){l(r,n,e),"keyup"!==o&&(w=i(n)),setTimeout(t,10)}:function(t){return function(){E=t,++k[e],f()}}(o||d(n[s+1]).action);m(n[s],a,o,e,s)}}function m(e,t,n,o,i){g._directMap[e+":"+n]=t;var s,a=(e=e.replace(/\s+/g," ")).split(" ");a.length>1?y(e,a,t,n):(s=d(e,n),g._callbacks[s.key]=g._callbacks[s.key]||[],r(s.key,s.modifiers,{type:s.action},o,e,i),g._callbacks[s.key][o?"unshift":"push"]({callback:t,modifiers:s.modifiers,action:s.action,seq:o,level:i,combo:e}))}var g=this;if(e=e||n,!(g instanceof v))return new v(e);g.target=e,g._callbacks={},g._directMap={};var b,k={},w=!1,x=!1,E=!1;g._handleKey=function(e,n,o){var i,s=r(e,n,o),a={},c=0,u=!1;for(i=0;s.length>i;++i)s[i].seq&&(c=Math.max(c,s[i].level));for(i=0;s.length>i;++i)if(s[i].seq){if(s[i].level!=c)continue;u=!0,a[s[i].seq]=1,l(s[i].callback,o,s[i].combo,s[i].seq)}else u||l(s[i].callback,o,s[i].combo);var h="keypress"==o.type&&x;o.type!=E||p(e)||h||t(a),x=u&&"keydown"==o.type},g._bindMultiple=function(e,t,n){for(var r=0;e.length>r;++r)m(e[r],t,n)},o(e,"keypress",h),o(e,"keydown",h),o(e,"keyup",h)}if(t){for(var m,g={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},b={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},k={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},w={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},x=1;20>x;++x)g[111+x]="f"+x;for(x=0;9>=x;++x)g[x+96]=""+x;v.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},v.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},v.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},v.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},v.prototype.stopCallback=function(e,t){var n=this;return-1>=(" "+t.className+" ").indexOf(" mousetrap ")&&(!y(t,n.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},v.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},v.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(g[t]=e[t]);m=null},v.init=function(){var e=v(n);for(var t in e)"_"!==t.charAt(0)&&(v[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},v.init(),t.Mousetrap=v,e.exports&&(e.exports=v)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)});t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.gamelog .log-turn {\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  background: #fff;\n  border: 1px solid #ccc;\n  border-left: 5px solid #ccc;\n  padding: 5px;\n  text-align: center;\n  color: #555;\n}\n\n.gamelog .log-turn:hover {\n  border-left: 5px solid #555;\n}\n\n.gamelog .log-turn .id {\n  padding: 5px;\n  font-weight: bold;\n  margin-bottom: 5px;\n}\n\n.gamelog .log-move {\n  border-left: 25px solid;\n  margin-top: 5px;\n  background: #fff;\n  padding: 5px;\n}\n\n.gamelog div.player0 {\n  border-left-color: #001f3f;\n}\n\n.gamelog div.player1 {\n  border-left-color: #0074d9;\n}\n\n.gamelog div.player2 {\n  border-left-color: #7fdbff;\n}\n\n.gamelog div.player3 {\n  border-left-color: #39cccc;\n}\n\n.gamelog div.player4 {\n  border-left-color: #3d9970;\n}\n\n.gamelog div.player5 {\n  border-left-color: #2ecc40;\n}\n\n.gamelog div.player6 {\n  border-left-color: #01ff70;\n}\n\n.gamelog div.player7 {\n  border-left-color: #ffdc00;\n}\n\n.gamelog div.player8 {\n  border-left-color: #ff851b;\n}\n\n.gamelog div.player9 {\n  border-left-color: #ff4136;\n}\n\n.gamelog div.player10 {\n  border-left-color: #85144b;\n}\n\n.gamelog div.player11 {\n  border-left-color: #f012be;\n}\n\n.gamelog div.player12 {\n  border-left-color: #b10dc9;\n}\n\n.gamelog div.player13 {\n  border-left-color: #111111;\n}\n\n.gamelog div.player14 {\n  border-left-color: #aaaaaa;\n}\n\n.gamelog div.player15 {\n  border-left-color: #dddddd;\n}\n",void 0);var Pn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),r.onRewind=function(e){if(null!=e){var t=r.props.store.getState();r._toRestore=t;var n=t._initial;r.props.store.dispatch(Ee(n));for(var o=0;e>=o;o++){var i=t.log[o];i.type!=be&&i.type!=ge||(i.remote=!0,r.props.store.dispatch(i))}}else r.props.store.dispatch(Ee(r._toRestore))},o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"render",value:function(){for(var t=this,n=[],r=[],o=[],i={},s=new Map,a=this.props.store.getState(),c=0;a.log.length>c;c++){var u=a.log[c];if(u.type==be&&"endTurn"==u.payload.type||["endTurn","endPhase"].includes(u.type))i[r.length]=c,r.push(o),o=[];else{var p=u.payload.args||[],l=u.payload.playerID;s.has(l)||s.set(l,s.size);var h="log-move player"+s.get(l);o.push(e.createElement("div",{key:c,className:h},u.payload.type,"(",p.join(","),")"))}}for(var f=0;r.length>f;f++)!function(o){var s=r[o];n.push(e.createElement("div",{key:o,className:"log-turn",onMouseOver:function(){return t.onRewind(i[o])},onMouseOut:function(){return t.onRewind(null)}},e.createElement("div",{className:"id"},"Turn #",o+1),s))}(f);return e.createElement("div",{className:"gamelog"},n)}}]),n}();Pn.propTypes={store:_n.any.isRequired},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.debug-ui {\n  min-width: 300px;\n  max-width: 400px;\n  overflow: hidden;\n  box-sizing: border-box;\n  background: #fefefe;\n  border: 3px solid #ddd;\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  opacity: 0.8;\n  font-family: monospace;\n  font-size: 14px;\n  padding: 20px;\n  box-sizing: content-box;\n}\n\n.debug-ui section {\n  margin-bottom: 20px;\n}\n\n.debug-ui textarea {\n  resize: none;\n}\n\n.debug-ui .move {\n  cursor: pointer;\n  margin-bottom: 10px;\n  color: #666;\n}\n\n.debug-ui .move:hover {\n  color: #333;\n}\n\n.debug-ui .move.active {\n  color: #111;\n  font-weight: bold;\n}\n\n.debug-ui .move-error {\n  color: #a00;\n  font-weight: bold;\n}\n\n.debug-ui .arg-field {\n  outline: none;\n  font-family: monospace;\n}\n\n.debug-ui .key {\n  margin-bottom: 5px;\n}\n\n.debug-ui .key-box {\n  display: inline-block;\n  cursor: pointer;\n  min-width: 10px;\n  padding-left: 5px;\n  padding-right: 5px;\n  height: 20px;\n  line-height: 20px;\n  text-align: center;\n  border: 1px solid #ccc;\n  box-shadow: 1px 1px 1px #888;\n  background: #eee;\n  color: #444;\n}\n\n.debug-ui .key-box:hover {\n  background: #ddd;\n}\n\n.debug-ui .key.active .key-box {\n  background: #ddd;\n  border: 1px solid #999;\n  box-shadow: none;\n}\n\n.debug-ui .key-child {\n  display: inline-block;\n  height: 20px;\n  margin-left: 10px;\n}\n\n.debug-ui .menu {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n.debug-ui .menu .item {\n  cursor: pointer;\n  margin-top: -10px;\n  margin-bottom: 20px;\n  margin-right: 10px;\n  padding: 5px;\n  min-width: 50px;\n  text-align: center;\n}\n\n.debug-ui .menu .item.active {\n  font-weight: bold;\n  border-bottom: 3px solid #ccc;\n}\n\n.debug-ui .player-box {\n  display: flex;\n  flex-direction: row;\n}\n\n.debug-ui .player {\n  cursor: pointer;\n  text-align: center;\n  width: 30px;\n  height: 30px;\n  line-height: 30px;\n  border: 3px solid #eee;\n  box-sizing: content-box;\n}\n\n.debug-ui .player.active {\n  background: #ccc;\n  border: 3px solid #555;\n}\n",void 0);var Mn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),r.state={error:""},r.onSubmit=function(e){var t="";try{var n=Function("return ["+e+"]")();r.props.fn.apply(r,n)}catch(e){t=""+e}r.setState({error:t,focus:!1,enterArg:!1})},o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"render",value:function(){return e.createElement("div",null,e.createElement(Sn,{value:this.props.shortcut},e.createElement(Dn,{name:this.props.name,onSubmit:this.onSubmit})),this.state.error?e.createElement("span",{className:"move-error"},this.state.error):null)}}]),n}();Mn.propTypes={name:_n.string.isRequired,shortcut:_n.string.isRequired,fn:_n.func.isRequired};var Dn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),r.onKeyDown=function(e){if("Enter"==e.key){e.preventDefault();var t=r.span.innerText;r.props.onSubmit(t),r.span.innerText="",r.props.deactivate()}"Escape"==e.key&&(e.preventDefault(),r.props.deactivate())},o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"componentDidUpdate",value:function(){this.props.active?this.span.focus():this.span.blur()}},{key:"render",value:function(){var t=this,n="move";return this.props.active&&(n+=" active"),e.createElement("div",{className:n,onClick:this.props.activate},this.props.name,"(",e.createElement("span",{ref:function(e){t.span=e},className:"arg-field",onBlur:this.props.deactivate,onKeyDown:this.onKeyDown,contentEditable:!0}),")")}}]),n}();Dn.propTypes={name:_n.string.isRequired,onSubmit:_n.func.isRequired,active:_n.bool,activate:_n.func,deactivate:_n.func};var Sn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),r.state={active:!1},r.deactivate=function(){r.setState({active:!1})},r.activate=function(){r.setState({active:!0}),r.props.onPress&&(r.props.onPress(),r.setState({active:!1}))},o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"componentDidMount",value:function(){var e=this;An.bind(this.props.value,function(t){t.preventDefault(),e.activate()})}},{key:"componentWillUnmount",value:function(){An.unbind(this.props.value)}},{key:"render",value:function(){var t=this.props.children;cn(this.props.children)===cn(this)&&(t=e.cloneElement(this.props.children,{active:this.state.active,deactivate:this.deactivate,activate:this.activate}));var n="key";return this.state.active&&(n+=" active"),e.createElement("div",{className:n},e.createElement("div",{className:"key-box",onClick:this.activate},this.props.value),e.createElement("div",{className:"key-child"},t))}}]),n}();Sn.propTypes={value:_n.string.isRequired,children:_n.any,onPress:_n.func};var In=function(t){function n(e){un(this,n);var t=dn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={showDebugUI:!0,showLog:!1,help:!1},t.saveState=function(){var e=JSON.stringify(t.props.gamestate);window.localStorage.setItem("gamestate",e)},t.restoreState=function(){var e=window.localStorage.getItem("gamestate");if(null!==e){var n=JSON.parse(e);t.props.store.dispatch(Ee(n))}},t.onClickMain=function(){t.setState({showLog:!1})},t.onClickLog=function(){t.setState({showLog:!0})},t.toggleHelp=function(){t.setState(function(e){return{help:!e.help}})},t.assignShortcuts(),t}return hn(n,e.Component),pn(n,[{key:"componentDidMount",value:function(){var e=this;An.bind("d",function(t){t.preventDefault(),e.setState(function(e){return{showDebugUI:!e.showDebugUI}})}),An.bind("l",function(t){t.preventDefault(),e.setState(function(e){return{showLog:!e.showLog}})})}},{key:"componentWillUnmount",value:function(){An.unbind("d"),An.unbind("l")}},{key:"assignShortcuts",value:function(){var e={s:!0,r:!0,d:!0,l:!0};this.shortcuts=null;var t={};for(var n in this.props.moves)t[n]=n;for(var r in this.props.events)t[r]=r;var o=e,i={},s=!0;for(var a in t){var c=a[0];if(o[c]){s=!1;break}o[c]=!0,i[a]=c}if(s&&(this.shortcuts=i),null==this.shortcuts){var u=e,p=97,l={};for(var h in t){for(var f=String.fromCharCode(p);u[f];)p++,f=String.fromCharCode(p);u[f]=!0,l[h]=f}this.shortcuts=l}}},{key:"renderHelp",value:function(){var t=this.state.help?"block":"none";return e.createElement("section",null,e.createElement(Sn,{value:"?",onPress:this.toggleHelp},"help"),e.createElement("span",{style:{display:t}},e.createElement("div",{className:"key"},e.createElement("div",{className:"key-box"},"d")," toggle Debug UI"),e.createElement("div",{className:"key"},e.createElement("div",{className:"key-box"},"l")," toggle Log"),e.createElement(Sn,{value:"s",onPress:this.saveState},"save localStorage"),e.createElement(Sn,{value:"r",onPress:this.restoreState},"restore localStorage")))}},{key:"render",value:function(){if(!this.state.showDebugUI)return null;var t=[];for(var n in this.props.moves){var r=this.props.moves[n],o=this.shortcuts[n];t.push(e.createElement(Mn,{key:n,name:n,fn:r,shortcut:o}))}var i=[];for(var s in this.props.events){var a=this.props.events[s],c=this.shortcuts[s];i.push(e.createElement(Mn,{key:s,name:s,fn:a,shortcut:c}))}for(var u=[],p=0;this.props.gamestate.ctx.numPlayers>p;p++){var l="player active";p!=this.props.gamestate.ctx.currentPlayer&&(l="player"),u.push(e.createElement("div",{className:l,key:p},p))}return e.createElement("div",{className:"debug-ui"},e.createElement("div",{className:"menu"},e.createElement("div",{className:this.state.showLog?"item":"item active",onClick:this.onClickMain},"Main"),e.createElement("div",{className:this.state.showLog?"item active":"item",onClick:this.onClickLog},"Log")),this.state.showLog||e.createElement("span",null,e.createElement("section",null,e.createElement("div",null,e.createElement("strong",null,"Game ID:")," ",this.props.gameID)),this.renderHelp(),e.createElement("h3",null,"players"),e.createElement("div",{className:"player-box"},u),e.createElement("h3",null,"moves"),e.createElement("section",null,t),e.createElement("h3",null,"events"),e.createElement("section",null,i),e.createElement("h3",null,"state"),e.createElement("section",null,e.createElement("pre",null,e.createElement("strong",null,"G"),":"," ",JSON.stringify(this.props.gamestate.G,null,2))),e.createElement("section",null,e.createElement("pre",null,e.createElement("strong",null,"ctx"),":"," ",JSON.stringify(this.props.gamestate.ctx,null,2)))),this.state.showLog&&e.createElement("section",null,e.createElement(Pn,{store:this.props.store})))}}]),n}();In.propTypes={gamestate:_n.shape({G:_n.any.isRequired,ctx:_n.any.isRequired,log:_n.array.isRequired,_initial:_n.any.isRequired}),gameID:_n.string.isRequired,playerID:_n.string,moves:_n.any,events:_n.any,restore:_n.func,showLog:_n.bool,store:_n.any};var Tn={DEFAULT:{first:function(e,t){return t.playOrderPos},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},ANY:{first:function(){},next:function(){}},SKIP:{first:function(e,t){return t.playOrderPos},next:function(e,t){if(!e.allPassed)for(var n=t.playOrderPos,r=0;t.playOrder.length>r;r++)if(n=(n+1)%t.playOrder.length,!e.passOrder.includes(t.playOrder[n]+""))return n}}},Bn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),Nn.call(r),o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"_getCellColor",value:function(e,t,n){var r=e+","+t+","+n,o="white";return r in this.props.colorMap&&(o=this.props.colorMap[r]),o}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var t=[],n=this.props.levels,r=-n;n>=r;r++)for(var o=-n;n>=o;o++){var i=-r-o;Math.abs(i)>n||t.push(e.createElement(jn,{key:r+":"+o+":"+i,style:{fill:this._getCellColor(r,o,i)},x:r,y:o,z:i,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}))}return t}},{key:"render",value:function(){var t=this,n=e.Children.map(this.props.children,function(n){return e.cloneElement(n,{_inHexGrid:!0,onClick:t.onClick,onMouseOver:t.onMouseOver,onMouseOut:t.onMouseOut})}),r=this.props.cellSize*this.props.levels*2;return e.createElement("svg",{viewBox:-r+" "+-r+" "+2*r+" "+2*r,style:this.props.style},e.createElement("g",null,this._getGrid()),n)}}]),n}();Bn.propTypes={levels:_n.number.isRequired,outline:_n.bool,style:_n.object,colorMap:_n.object,cellSize:_n.number,onClick:_n.func,onMouseOver:_n.func,onMouseOut:_n.func,children:_n.oneOfType([_n.arrayOf(_n.element),_n.element])},Bn.defaultProps={levels:5,colorMap:{},outline:!0,cellSize:1};var Nn=function(){var e=this;this.onClick=function(t){e.props.onClick&&e.props.onClick(t)},this.onMouseOver=function(t){e.props.onMouseOver&&e.props.onMouseOver(t)},this.onMouseOut=function(t){e.props.onMouseOut&&e.props.onMouseOut(t)}},jn=function(t){function n(e){un(this,n);var t=dn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.onClick=function(){t.props.onClick({x:t.props.x,y:t.props.y,z:t.props.z})},t.onMouseOver=function(){t.props.onMouseOver({x:t.props.x,y:t.props.y,z:t.props.z})},t.onMouseOut=function(){t.props.onMouseOut({x:t.props.x,y:t.props.y,z:t.props.z})},t}return hn(n,e.Component),pn(n,[{key:"render",value:function(){var t=this.center.x,n=this.center.y;return this.props.children?e.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+t+", "+n+")"},this.props.children):e.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+t+", "+n+")"},e.createElement("polygon",{style:this.props.style,points:this.points,stroke:"#aaa",strokeWidth:.01}))}},{key:"width",get:function(){return 2*this.props.size}},{key:"height",get:function(){return(Math.sqrt(3)/2*this.width).toFixed(3)}},{key:"center",get:function(){var e=this.props.x,t=this.props.z;return{x:3*this.props.size*e/2,y:this.props.size*Math.sqrt(3)*(t+e/2)}}},{key:"points",get:function(){var e=this.props.size,t=this.height,n=-e/2,r=+e/2,o=t/2,i=-t/2;return[-e+",0",n+","+o,r+","+o,+e+",0",r+","+i,n+","+i].join(" ")}}]),n}();jn.propTypes={x:_n.number,y:_n.number,z:_n.number,size:_n.number,style:_n.any,onClick:_n.func,onMouseOver:_n.func,onMouseOut:_n.func,children:_n.element},jn.defaultProps={size:1,x:0,y:0,z:0,style:{fill:"#fff"}};var Rn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),qn.call(r),o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"_getCellColor",value:function(e,t){var n=e+","+t,r="white";return n in this.props.colorMap&&(r=this.props.colorMap[n]),r}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var t=[],n=0;this.props.cols>n;n++)for(var r=0;this.props.rows>r;r++)t.push(e.createElement(zn,{key:this.props.cols*r+n,style:{fill:this._getCellColor(n,r)},x:n,y:r,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}));return t}},{key:"render",value:function(){var t=this,n=e.Children.map(this.props.children,function(n){return e.cloneElement(n,{_inGrid:!0,onClick:t.onClick,onMouseOver:t.onMouseOver,onMouseOut:t.onMouseOut})});return e.createElement("svg",{viewBox:"0 0 "+this.props.cols+" "+this.props.rows,style:this.props.style},e.createElement("g",null,this._getGrid()),n)}}]),n}();Rn.propTypes={rows:_n.number.isRequired,cols:_n.number.isRequired,outline:_n.bool,style:_n.object,colorMap:_n.object,cellSize:_n.number,onClick:_n.func,onMouseOver:_n.func,onMouseOut:_n.func,children:_n.oneOfType([_n.arrayOf(_n.element),_n.element])},Rn.defaultProps={colorMap:{},outline:!0,cellSize:1};var qn=function(){var e=this;this.onClick=function(t){e.props.onClick&&e.props.onClick(t)},this.onMouseOver=function(t){e.props.onMouseOver&&e.props.onMouseOver(t)},this.onMouseOut=function(t){e.props.onMouseOut&&e.props.onMouseOut(t)}},zn=function(t){function n(){var e,t,r,o;un(this,n);for(var i=arguments.length,s=Array(i),a=0;i>a;a++)s[a]=arguments[a];return t=r=dn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),r.onClick=function(){r.props.onClick({x:r.props.x,y:r.props.y})},r.onMouseOver=function(){r.props.onMouseOver({x:r.props.x,y:r.props.y})},r.onMouseOut=function(){r.props.onMouseOut({x:r.props.x,y:r.props.y})},o=t,dn(r,o)}return hn(n,e.Component),pn(n,[{key:"render",value:function(){var t=this.props.x*this.props.size,n=this.props.y*this.props.size;return this.props.children?e.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+t+", "+n+")"},this.props.children):e.createElement("g",{onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate("+t+", "+n+")"},e.createElement("rect",{style:this.props.style,width:this.props.size,height:this.props.size,x:0,y:0}))}}]),n}();zn.propTypes={x:_n.number.isRequired,y:_n.number.isRequired,size:_n.number,style:_n.any,onClick:_n.func,onMouseOver:_n.func,onMouseOut:_n.func,children:_n.element},zn.defaultProps={size:1,x:0,y:0,style:{fill:"#fff"}};var Ln=function(t){function n(){return un(this,n),dn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return hn(n,e.Component),pn(n,[{key:"componentWillMount",value:function(){this.setState(this.getCoords())}},{key:"componentWillReceiveProps",value:function(e){var t=this.getCoords(),n=this.getCoords(e);t.x==n.x&&t.y==n.y||(this.setState(ln({},this.state,{originTime:Date.now(),originX:t.x,originY:t.y,originZ:t.z})),requestAnimationFrame(this._animate(Date.now())))}},{key:"_animate",value:function(e){var t=this;return function(){var n=e-t.state.originTime,r=t.getCoords();if(t.props.animationDuration>n&&t.props.animate){var o=t._easeInOutCubic(n,0,1,t.props.animationDuration);t.setState(ln({},t.state,{x:(r.x-t.state.originX)*o+t.state.originX,y:(r.y-t.state.originY)*o+t.state.originY,z:(r.z-t.state.originZ)*o+t.state.originZ})),requestAnimationFrame(t._animate(Date.now()))}else t.setState(ln({},t.state,{x:r.x,y:r.y,z:r.z}))}.bind(this)}},{key:"getCoords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{x:e.x,y:e.y,z:e.z}}},{key:"_easeInOutCubic",value:function(e,t,n,r){return 1>(e/=r/2)?n/2*e*e*e+t:(e-=2,n/2*(e*e*e+2)+t)}},{key:"render",value:function(){var t=this;return this.props._inHexGrid?e.createElement(jn,{x:this.state.x,y:this.state.y,z:this.state.z,style:this.props.style,onClick:this.props.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut},this.props.children):this.props._inGrid?e.createElement(zn,{x:this.state.x,y:this.state.y,style:this.props.style,onClick:this.props.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut},this.props.children):e.Children.map(this.props.children,function(n){return e.cloneElement(n,{onClick:t.props.onClick,onMouseOver:t.props.onMouseOver,onMouseOut:t.props.onMouseOut})})}}]),n}();Ln.propTypes={x:_n.number,y:_n.number,z:_n.number,style:_n.any,animate:_n.bool,onClick:_n.func,onMouseOver:_n.func,onMouseOut:_n.func,children:_n.element,animationDuration:_n.number,_inGrid:_n.bool,_inHexGrid:_n.bool},Ln.defaultProps={animationDuration:750};var Un=function(t){var n=t.width,r=t.height;return e.createElement("svg",{width:n||128,height:r||128,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128"},e.createElement("path",{d:"M64,120.37,15.27,92.28V35.91L64,7.82l48.73,28.09V92.28Z",fill:"#373748"}),e.createElement("path",{fill:"#000",d:"M64,124,12,94V34L64,4l52,30V94ZM18.33,90.37,64,116.74l45.67-26.37V37.63L64,11.26,18.33,37.63Z"}),e.createElement("path",{d:"M81.77,43.17c5.92,0,10.51,1.72,13.57,5.16,3.25,3.44,4.77,8.41,4.77,14.71q0,10.32-5.15,16.06c-3.44,3.82-8.22,5.73-14.53,5.73-5.92,0-10.51-1.72-13.56-5.35-3.25-3.63-4.78-8.6-4.78-15.29s1.72-12,5.16-15.67S75.46,43.17,81.77,43.17Zm-.57,5.16c-4.4,0-7.45,1.15-9.56,3.63s-3,6.31-3,11.66c0,5.73,1,9.74,3,12.42,2.11,2.48,5.16,3.82,9.56,3.82s7.64-1.34,9.74-3.82,3.25-6.5,3.25-11.85c0-5.54-1.15-9.55-3.25-12C88.65,49.48,85.59,48.33,81.2,48.33Z",fill:"#fff"}),e.createElement("path",{d:"M39.35,71.45l.19,12.8H33.43L33.62,72l-.19-28.48h6.11l-.19,27.9Z",fill:"#fff"}))};Un.propTypes={width:_n.string,height:_n.string},t("/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\n.bgio-card {\n  display: flex;\n  user-select: none;\n  font-family: monospace;\n  font-weight: bold;\n  font-size: 18px;\n  color: #ababab;\n  text-align: center;\n  flex-direction: column;\n  justify-content: center;\n  cursor: pointer;\n  background: #fff;\n  border-radius: 6px;\n  border: 1px solid #cdcdcd;\n  width: 100px;\n  height: 140px;\n  transition: all 0.1s;\n  overflow: hidden;\n}\n\n.bgio-card:not(.no-hover):hover {\n  transform: scale(1.2);\n}\n\n.bgio-card__front,\n.bgio-card__back {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n}\n\n.bgio-card__back {\n  background-image: url(\"data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 16c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zm33.414-6l5.95-5.95L45.95.636 40 6.586 34.05.636 32.636 2.05 38.586 8l-5.95 5.95 1.414 1.414L40 9.414l5.95 5.95 1.414-1.414L41.414 8zM40 48c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zM9.414 40l5.95-5.95-1.414-1.414L8 38.586l-5.95-5.95L.636 34.05 6.586 40l-5.95 5.95 1.414 1.414L8 41.414l5.95 5.95 1.414-1.414L9.414 40z' fill='%23ababab' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E\");\n  background-position: 2px 2px;\n  outline: 8px solid #eee;\n  outline-offset: -20px;\n}\n",void 0);var Gn=function(t){var n=t.back,r=t.canHover,o=t.className,i=t.front,s=t.isFaceUp,a=fn(t,["back","canHover","className","front","isFaceUp"]),c=["bgio-card"];return r||c.push("no-hover"),o&&c.push(o),e.createElement("div",ln({className:c.join(" ")},a),s?i:n)};return Gn.propTypes={back:_n.node,canHover:_n.bool,className:_n.string,front:_n.node,isFaceUp:_n.bool},Gn.defaultProps={back:e.createElement("div",{className:"bgio-card__back"},e.createElement(Un,{width:"48"})),canHover:!0,front:e.createElement("div",{className:"bgio-card__front"},"Card"),isFaceUp:!1},{Client:F,ReactClient:function(t){var n,r,o=t.game,i=t.numPlayers,s=t.board,a=t.multiplayer,c=t.debug,u=t.enhancer;return void 0===c&&(c=!0),r=n=function(t){function n(e){un(this,n);var t=dn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.client=F({game:o,numPlayers:i,multiplayer:a,gameID:e.gameID,playerID:e.playerID,enhancer:u}),t.client.subscribe(function(){return t.forceUpdate()}),t}return hn(n,e.Component),pn(n,[{key:"componentWillReceiveProps",value:function(e){e.gameID!=this.props.gameID&&this.client.updateGameID(e.gameID),e.playerID!=this.props.playerID&&this.client.updatePlayerID(e.playerID)}},{key:"componentWillMount",value:function(){"undefined"!=typeof window&&this.client.connect()}},{key:"render",value:function(){var t=null,n=null,r=this.client.getState();return s&&(t=e.createElement(s,ln({},r,{isMultiplayer:!0===a,moves:this.client.moves,events:this.client.events,gameID:this.props.gameID,playerID:this.props.playerID}))),c&&this.props.debug&&(n=e.createElement(In,{gamestate:r,store:this.client.store,isMultiplayer:!0===a,moves:this.client.moves,events:this.client.events,gameID:this.props.gameID,playerID:this.props.playerID})),e.createElement("div",{className:"client"},e.createElement("span",null,n,t))}}]),n}(),n.propTypes={gameID:_n.string,playerID:_n.string,debug:_n.bool},n.defaultProps={gameID:"default",playerID:null,debug:!0},r},Game:function(e){var t=e.name,n=e.setup,r=e.moves,o=e.playerView,i=e.flow,s=e.seed;return void 0===t&&(t="default"),void 0===n&&(n=function(){return{}}),void 0===r&&(r={}),void 0===o&&(o=function(e){return e}),void 0===s&&(s=gn.seed()),i&&void 0!==i.processGameEvent||(i=W(i||{})),{name:t,setup:n,playerView:o,flow:i,seed:s,moveNames:Object.getOwnPropertyNames(r),processMove:function(e,t,n){if(r.hasOwnProperty(t.type)){var o={playerID:t.playerID},i=[e,ln({},n,{playerID:t.playerID})].concat(t.args);return r[t.type].apply(o,i)}return e}}},Flow:J,FlowWithPhases:W,TurnOrder:Tn,Pass:function(e,t){var n=[];void 0!==e.passOrder&&(n=e.passOrder);var r="any"===t.currentPlayer?t.playerID:t.currentPlayer;return n.push(r),e=ln({},e,{passOrder:n}),t.numPlayers>n.length||(e.allPassed=!0),e},Card:Gn,Token:Ln,Grid:Rn,HexGrid:Bn}});
